(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.CodeMirror=a())}(this,(function(){var ex=navigator.userAgent;var eI=navigator.platform;var cN=/gecko\/\d/i.test(ex);var fr=/MSIE \d/.test(ex);var b2=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ex);var c1=/Edge\/(\d+)/.exec(ex);var ed=fr||b2||c1;var m=ed&&(fr?document.documentMode||6:+(c1||b2)[1]);var dr=!c1&&/WebKit\//.test(ex);var eg=dr&&/Qt\/\d+\.\d+/.test(ex);var dH=!c1&&/Chrome\//.test(ex);var ez=/Opera\//.test(ex);var aK=/Apple Computer/.test(navigator.vendor);var dz=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(ex);var gd=/PhantomJS/.test(ex);var fL=!c1&&/AppleWebKit/.test(ex)&&/Mobile\/\w+/.test(ex);var aW=/Android/.test(ex);var eO=fL||aW||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(ex);var cs=fL||/Mac/.test(eI);var gx=/\bCrOS\b/.test(ex);var aZ=/win/i.test(eI);var ba=ez&&ex.match(/Version\/(\d*\.\d*)/);if(ba){ba=Number(ba[1])}if(ba&&ba>=15){ez=false;dr=true}var ca=cs&&(eg||ez&&(ba==null||ba<12.11));var g7=cN||(ed&&m>=9);function Y(i){return new RegExp("(^|\\s)"+i+"(?:$|\\s)\\s*")}var h=function(hj,i){var hk=hj.className;var hi=Y(i).exec(hk);if(hi){var hl=hk.slice(hi.index+hi[0].length);hj.className=hk.slice(0,hi.index)+(hl?hi[1]+hl:"")}};function ey(hi){for(var i=hi.childNodes.length;i>0;--i){hi.removeChild(hi.firstChild)}return hi}function cc(i,hi){return ey(i).appendChild(hi)}function gX(hi,hm,hl,hk){var hn=document.createElement(hi);if(hl){hn.className=hl}if(hk){hn.style.cssText=hk}if(typeof hm=="string"){hn.appendChild(document.createTextNode(hm))}else{if(hm){for(var hj=0;hj<hm.length;++hj){hn.appendChild(hm[hj])}}}return hn}function g4(i,hk,hj,hi){var hl=gX(i,hk,hj,hi);hl.setAttribute("role","presentation");return hl}var cK;if(document.createRange){cK=function(hk,hl,hi,i){var hj=document.createRange();hj.setEnd(i||hk,hi);hj.setStart(hk,hl);return hj}}else{cK=function(hj,hl,i){var hi=document.body.createTextRange();try{hi.moveToElementText(hj.parentNode)}catch(hk){return hi}hi.collapse(true);hi.moveEnd("character",i);hi.moveStart("character",hl);return hi}}function g8(i,hi){if(hi.nodeType==3){hi=hi.parentNode}if(i.contains){return i.contains(hi)}do{if(hi.nodeType==11){hi=hi.host}if(hi==i){return true}}while(hi=hi.parentNode)}function eh(){var i;try{i=document.activeElement}catch(hi){i=document.body||null}while(i&&i.shadowRoot&&i.shadowRoot.activeElement){i=i.shadowRoot.activeElement}return i}function gn(hi,i){var hj=hi.className;if(!Y(i).test(hj)){hi.className+=(hj?" ":"")+i}}function gM(hk,hi){var hj=hk.split(" ");for(var hl=0;hl<hj.length;hl++){if(hj[hl]&&!Y(hj[hl]).test(hi)){hi+=" "+hj[hl]}}return hi}var ee=function(i){i.select()};if(fL){ee=function(i){i.selectionStart=0;i.selectionEnd=i.value.length}}else{if(ed){ee=function(hi){try{hi.select()}catch(i){}}}}function cU(hi){var i=Array.prototype.slice.call(arguments,1);return function(){return hi.apply(null,i)}}function aX(hj,hi,i){if(!hi){hi={}}for(var hk in hj){if(hj.hasOwnProperty(hk)&&(i!==false||!hi.hasOwnProperty(hk))){hi[hk]=hj[hk]}}return hi}function cb(hl,hj,hn,ho,hk){if(hj==null){hj=hl.search(/[^\s\u00a0]/);if(hj==-1){hj=hl.length}}for(var hm=ho||0,hp=hk||0;;){var hi=hl.indexOf("\t",hm);if(hi<0||hi>=hj){return hp+(hj-hm)}hp+=hi-hm;hp+=hn-(hp%hn);hm=hi+1}}var hh=function(){this.id=null};hh.prototype.set=function(i,hi){clearTimeout(this.id);this.id=setTimeout(hi,i)};function dN(hk,hi){for(var hj=0;hj<hk.length;++hj){if(hk[hj]==hi){return hj}}return -1}var ec=30;var cx={toString:function(){return"CodeMirror.Pass"}};var ah={scroll:false};var R={origin:"*mouse"};var dm={origin:"+move"};function e0(hl,hk,hm){for(var hn=0,hj=0;;){var hi=hl.indexOf("\t",hn);if(hi==-1){hi=hl.length}var i=hi-hn;if(hi==hl.length||hj+i>=hk){return hn+Math.min(i,hk-hj)}hj+=hi-hn;hj+=hm-(hj%hm);hn=hi+1;if(hj>=hk){return hn}}}var bb=[""];function cO(i){while(bb.length<=i){bb.push(gt(bb)+" ")}return bb[i]}function gt(i){return i[i.length-1]}function cd(hl,hk){var hi=[];for(var hj=0;hj<hl.length;hj++){hi[hj]=hk(hl[hj],hj)}return hi}function cv(hl,hi,hj){var hk=0,i=hj(hi);while(hk<hl.length&&hj(hl[hk])<=i){hk++}hl.splice(hk,0,hi)}function gN(){}function cI(hj,i){var hi;if(Object.create){hi=Object.create(hj)}else{gN.prototype=hj;hi=new gN()}if(i){aX(i,hi)}return hi}var bn=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function gq(i){return/\w/.test(i)||i>"\x80"&&(i.toUpperCase()!=i.toLowerCase()||bn.test(i))}function cZ(i,hi){if(!hi){return gq(i)}if(hi.source.indexOf("\\w")>-1&&gq(i)){return true}return hi.test(i)}function fD(i){for(var hi in i){if(i.hasOwnProperty(hi)&&i[hi]){return false}}return true}var fq=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function f8(i){return i.charCodeAt(0)>=768&&fq.test(i)}function eS(hi,hj,i){while((i<0?hj>0:hj<hi.length)&&f8(hi.charAt(hj))){hj+=i}return hj}function cL(i,hk,hj){for(;;){if(Math.abs(hk-hj)<=1){return i(hk)?hk:hj}var hi=Math.floor((hk+hj)/2);if(i(hi)){hj=hi}else{hk=hi}}}function fo(hi,hk,hj){var hl=this;this.input=hj;hl.scrollbarFiller=gX("div",null,"CodeMirror-scrollbar-filler");hl.scrollbarFiller.setAttribute("cm-not-content","true");hl.gutterFiller=gX("div",null,"CodeMirror-gutter-filler");hl.gutterFiller.setAttribute("cm-not-content","true");hl.lineDiv=g4("div",null,"CodeMirror-code");hl.selectionDiv=gX("div",null,null,"position: relative; z-index: 1");hl.cursorDiv=gX("div",null,"CodeMirror-cursors");hl.measure=gX("div",null,"CodeMirror-measure");hl.lineMeasure=gX("div",null,"CodeMirror-measure");hl.lineSpace=g4("div",[hl.measure,hl.lineMeasure,hl.selectionDiv,hl.cursorDiv,hl.lineDiv],null,"position: relative; outline: none");var i=g4("div",[hl.lineSpace],"CodeMirror-lines");hl.mover=gX("div",[i],null,"position: relative");hl.sizer=gX("div",[hl.mover],"CodeMirror-sizer");hl.sizerWidth=null;hl.heightForcer=gX("div",null,null,"position: absolute; height: "+ec+"px; width: 1px;");hl.gutters=gX("div",null,"CodeMirror-gutters");hl.lineGutter=null;hl.scroller=gX("div",[hl.sizer,hl.heightForcer,hl.gutters],"CodeMirror-scroll");hl.scroller.setAttribute("tabIndex","-1");hl.wrapper=gX("div",[hl.scrollbarFiller,hl.gutterFiller,hl.scroller],"CodeMirror");if(ed&&m<8){hl.gutters.style.zIndex=-1;hl.scroller.style.paddingRight=0}if(!dr&&!(cN&&eO)){hl.scroller.draggable=true}if(hi){if(hi.appendChild){hi.appendChild(hl.wrapper)}else{hi(hl.wrapper)}}hl.viewFrom=hl.viewTo=hk.first;hl.reportedViewFrom=hl.reportedViewTo=hk.first;hl.view=[];hl.renderedView=null;hl.externalMeasured=null;hl.viewOffset=0;hl.lastWrapHeight=hl.lastWrapWidth=0;hl.updateLineNumbers=null;hl.nativeBarWidth=hl.barHeight=hl.barWidth=0;hl.scrollbarsClipped=false;hl.lineNumWidth=hl.lineNumInnerWidth=hl.lineNumChars=null;hl.alignWidgets=false;hl.cachedCharWidth=hl.cachedTextHeight=hl.cachedPaddingH=null;hl.maxLine=null;hl.maxLineLength=0;hl.maxLineChanged=false;hl.wheelDX=hl.wheelDY=hl.wheelStartX=hl.wheelStartY=null;hl.shift=false;hl.selForContextMenu=null;hl.activeTouch=null;hj.init(hl)}function fZ(hl,hn){hn-=hl.first;if(hn<0||hn>=hl.size){throw new Error("There is no line "+(hn+hl.first)+" in the document.")}var hi=hl;while(!hi.lines){for(var hj=0;;++hj){var hm=hi.children[hj],hk=hm.chunkSize();if(hn<hk){hi=hm;break}hn-=hk}}return hi.lines[hn]}function g0(hj,hl,i){var hi=[],hk=hl.line;hj.iter(hl.line,i.line+1,function(hm){var hn=hm.text;if(hk==i.line){hn=hn.slice(0,i.ch)}if(hk==hl.line){hn=hn.slice(hl.ch)}hi.push(hn);++hk});return hi}function bd(hi,hk,hj){var i=[];hi.iter(hk,hj,function(hl){i.push(hl.text)});return i}function g3(hi,i){var hj=i-hi.height;if(hj){for(var hk=hi;hk;hk=hk.parent){hk.height+=hj}}}function b6(hi){if(hi.parent==null){return null}var hm=hi.parent,hl=dN(hm.lines,hi);for(var hj=hm.parent;hj;hm=hj,hj=hj.parent){for(var hk=0;;++hk){if(hj.children[hk]==hm){break}hl+=hj.children[hk].chunkSize()}}return hl+hm.first}function bZ(ho,hn){var hl=ho.first;outer:do{for(var hk=0;hk<ho.children.length;++hk){var hj=ho.children[hk],hi=hj.height;if(hn<hi){ho=hj;continue outer}hn-=hi;hl+=hj.chunkSize()}return hl}while(!ho.lines);var hm=0;for(;hm<ho.lines.length;++hm){var hq=ho.lines[hm],hp=hq.height;if(hn<hp){break}hn-=hp}return hl+hm}function cu(hi,i){return i>=hi.first&&i<hi.first+hi.size}function e3(hi,hj){return String(hi.lineNumberFormatter(hj+hi.firstLineNumber))}function ac(i,hi,hj){if(hj===void 0){hj=null}if(!(this instanceof ac)){return new ac(i,hi,hj)}this.line=i;this.ch=hi;this.sticky=hj}function cC(hi,i){return hi.line-i.line||hi.ch-i.ch}function ad(hi,i){return hi.sticky==i.sticky&&cC(hi,i)==0}function cF(i){return ac(i.line,i.ch)}function bP(hi,i){return cC(hi,i)<0?i:hi}function az(hi,i){return cC(hi,i)<0?hi:i}function dw(i,hi){return Math.max(i.first,Math.min(hi,i.first+i.size-1))}function gy(hi,hj){if(hj.line<hi.first){return ac(hi.first,0)}var i=hi.first+hi.size-1;if(hj.line>i){return ac(i,fZ(hi,i).text.length)}return gb(hj,fZ(hi,hj.line).text.length)}function gb(hj,hi){var i=hj.ch;if(i==null||i>hi){return ac(hj.line,hi)}else{if(i<0){return ac(hj.line,0)}else{return hj}}}function ew(hk,hl){var hi=[];for(var hj=0;hj<hl.length;hj++){hi[hj]=gy(hk,hl[hj])}return hi}var hc=false;var bi=false;function gl(){hc=true}function bO(){bi=true}function eR(i,hj,hi){this.marker=i;this.from=hj;this.to=hi}function fU(hk,hi){if(hk){for(var hj=0;hj<hk.length;++hj){var hl=hk[hj];if(hl.marker==hi){return hl}}}}function fn(hj,hk){var hl;for(var hi=0;hi<hj.length;++hi){if(hj[hi]!=hk){(hl||(hl=[])).push(hj[hi])}}return hl}function cA(i,hi){i.markedSpans=i.markedSpans?i.markedSpans.concat([hi]):[hi];hi.marker.attachLine(i)}function a1(hj,hk,ho){var hp;if(hj){for(var hm=0;hm<hj.length;++hm){var hq=hj[hm],hn=hq.marker;var hi=hq.from==null||(hn.inclusiveLeft?hq.from<=hk:hq.from<hk);if(hi||hq.from==hk&&hn.type=="bookmark"&&(!ho||!hq.marker.insertLeft)){var hl=hq.to==null||(hn.inclusiveRight?hq.to>=hk:hq.to>hk);(hp||(hp=[])).push(new eR(hn,hq.from,hl?null:hq.to))}}}return hp}function aJ(hj,hl,ho){var hp;if(hj){for(var hm=0;hm<hj.length;++hm){var hq=hj[hm],hn=hq.marker;var hk=hq.to==null||(hn.inclusiveRight?hq.to>=hl:hq.to>hl);if(hk||hq.from==hl&&hn.type=="bookmark"&&(!ho||hq.marker.insertLeft)){var hi=hq.from==null||(hn.inclusiveLeft?hq.from<=hl:hq.from<hl);(hp||(hp=[])).push(new eR(hn,hi?null:hq.from-hl,hq.to==null?null:hq.to-hl))}}}return hp}function eT(hD,ht){if(ht.full){return null}var hk=cu(hD,ht.from.line)&&fZ(hD,ht.from.line).markedSpans;var hr=cu(hD,ht.to.line)&&fZ(hD,ht.to.line).markedSpans;if(!hk&&!hr){return null}var hq=ht.from.ch,hy=ht.to.ch,hv=cC(ht.from,ht.to)==0;var hp=a1(hk,hq,hv);var hs=aJ(hr,hy,hv);var hw=ht.text.length==1,hn=gt(ht.text).length+(hw?hq:0);if(hp){for(var hB=0;hB<hp.length;++hB){var hA=hp[hB];if(hA.to==null){var hu=fU(hs,hA.marker);if(!hu){hA.to=hq}else{if(hw){hA.to=hu.to==null?null:hu.to+hn}}}}}if(hs){for(var ho=0;ho<hs.length;++ho){var hz=hs[ho];if(hz.to!=null){hz.to+=hn}if(hz.from==null){var hj=fU(hp,hz.marker);if(!hj){hz.from=hn;if(hw){(hp||(hp=[])).push(hz)}}}else{hz.from+=hn;if(hw){(hp||(hp=[])).push(hz)}}}}if(hp){hp=s(hp)}if(hs&&hs!=hp){hs=s(hs)}var hC=[hp];if(!hw){var hx=ht.text.length-2,hi;if(hx>0&&hp){for(var hm=0;hm<hp.length;++hm){if(hp[hm].to==null){(hi||(hi=[])).push(new eR(hp[hm].marker,null,null))}}}for(var hl=0;hl<hx;++hl){hC.push(hi)}hC.push(hs)}return hC}function s(hj){for(var hi=0;hi<hj.length;++hi){var hk=hj[hi];if(hk.from!=null&&hk.from==hk.to&&hk.marker.clearWhenEmpty!==false){hj.splice(hi--,1)}}if(!hj.length){return null}return hj}function c8(hu,hs,ht){var hm=null;hu.iter(hs.line,ht.line+1,function(hv){if(hv.markedSpans){for(var hw=0;hw<hv.markedSpans.length;++hw){var hx=hv.markedSpans[hw].marker;if(hx.readOnly&&(!hm||dN(hm,hx)==-1)){(hm||(hm=[])).push(hx)}}}});if(!hm){return null}var hn=[{from:hs,to:ht}];for(var ho=0;ho<hm.length;++ho){var hp=hm[ho],hk=hp.find(0);for(var hl=0;hl<hn.length;++hl){var hj=hn[hl];if(cC(hj.to,hk.from)<0||cC(hj.from,hk.to)>0){continue}var hr=[hl,1],hi=cC(hj.from,hk.from),hq=cC(hj.to,hk.to);if(hi<0||!hp.inclusiveLeft&&!hi){hr.push({from:hj.from,to:hk.from})}if(hq>0||!hp.inclusiveRight&&!hq){hr.push({from:hk.to,to:hj.to})}hn.splice.apply(hn,hr);hl+=hr.length-3}}return hn}function g6(hi){var hk=hi.markedSpans;if(!hk){return}for(var hj=0;hj<hk.length;++hj){hk[hj].marker.detachLine(hi)}hi.markedSpans=null}function du(hi,hk){if(!hk){return}for(var hj=0;hj<hk.length;++hj){hk[hj].marker.attachLine(hi)}hi.markedSpans=hk}function w(i){return i.inclusiveLeft?-1:0}function cg(i){return i.inclusiveRight?1:0}function el(hk,hi){var hm=hk.lines.length-hi.lines.length;if(hm!=0){return hm}var hj=hk.find(),hn=hi.find();var i=cC(hj.from,hn.from)||w(hk)-w(hi);if(i){return -i}var hl=cC(hj.to,hn.to)||cg(hk)-cg(hi);if(hl){return hl}return hi.id-hk.id}function bh(hj,hn){var hi=bi&&hj.markedSpans,hm;if(hi){for(var hl=(void 0),hk=0;hk<hi.length;++hk){hl=hi[hk];if(hl.marker.collapsed&&(hn?hl.from:hl.to)==null&&(!hm||el(hm,hl.marker)<0)){hm=hl.marker}}}return hm}function fx(i){return bh(i,true)}function e8(i){return bh(i,false)}function A(hq,hk,ho,hp,hm){var ht=fZ(hq,hk);var hi=bi&&ht.markedSpans;if(hi){for(var hl=0;hl<hi.length;++hl){var hj=hi[hl];if(!hj.marker.collapsed){continue}var hs=hj.marker.find(0);var hr=cC(hs.from,ho)||w(hj.marker)-w(hm);var hn=cC(hs.to,hp)||cg(hj.marker)-cg(hm);if(hr>=0&&hn<=0||hr<=0&&hn>=0){continue}if(hr<=0&&(hj.marker.inclusiveRight&&hm.inclusiveLeft?cC(hs.to,ho)>=0:cC(hs.to,ho)>0)||hr>=0&&(hj.marker.inclusiveRight&&hm.inclusiveLeft?cC(hs.from,hp)<=0:cC(hs.from,hp)<0)){return true}}}}function z(hi){var i;while(i=fx(hi)){hi=i.find(-1,true).line}return hi}function cH(hi){var i;while(i=e8(hi)){hi=i.find(1,true).line}return hi}function g(hj){var i,hi;while(i=e8(hj)){hj=i.find(1,true).line;(hi||(hi=[])).push(hj)}return hi}function a7(hk,hi){var i=fZ(hk,hi),hj=z(i);if(i==hj){return hi}return b6(hj)}function eA(hk,hj){if(hj>hk.lastLine()){return hj}var hi=fZ(hk,hj),i;if(!gg(hk,hi)){return hj}while(i=e8(hi)){hi=i.find(1,true).line}return b6(hi)+1}function gg(hm,hj){var hi=bi&&hj.markedSpans;if(hi){for(var hl=(void 0),hk=0;hk<hi.length;++hk){hl=hi[hk];if(!hl.marker.collapsed){continue}if(hl.from==null){return true}if(hl.marker.widgetNode){continue}if(hl.from==0&&hl.marker.inclusiveLeft&&Z(hm,hj,hl)){return true}}}}function Z(hn,hj,hl){if(hl.to==null){var hi=hl.marker.find(1,true);return Z(hn,hi.line,fU(hi.line.markedSpans,hl.marker))}if(hl.marker.inclusiveRight&&hl.to==hj.text.length){return true}for(var hm=(void 0),hk=0;hk<hj.markedSpans.length;++hk){hm=hj.markedSpans[hk];if(hm.marker.collapsed&&!hm.marker.widgetNode&&hm.from==hl.to&&(hm.to==null||hm.to!=hl.from)&&(hm.marker.inclusiveLeft||hl.marker.inclusiveRight)&&Z(hn,hj,hm)){return true}}}function b5(hk){hk=z(hk);var hm=0,hj=hk.parent;for(var hl=0;hl<hj.lines.length;++hl){var hi=hj.lines[hl];if(hi==hk){break}else{hm+=hi.height}}for(var hn=hj.parent;hn;hj=hn,hn=hj.parent){for(var hp=0;hp<hn.children.length;++hp){var ho=hn.children[hp];if(ho==hj){break}else{hm+=ho.height}}}return hm}function eW(hj){if(hj.height==0){return 0}var hi=hj.text.length,i,hm=hj;while(i=fx(hm)){var hk=i.find(0,true);hm=hk.from.line;hi+=hk.from.ch-hk.to.ch}hm=hj;while(i=e8(hm)){var hl=i.find(0,true);hi-=hm.text.length-hl.from.ch;hm=hl.to.line;hi+=hm.text.length-hl.to.ch}return hi}function f(i){var hj=i.display,hi=i.doc;hj.maxLine=fZ(hi,hi.first);hj.maxLineLength=eW(hj.maxLine);hj.maxLineChanged=true;hi.iter(function(hl){var hk=eW(hl);if(hk>hj.maxLineLength){hj.maxLineLength=hk;hj.maxLine=hl}})}function eB(hi,ho,hn,hm){if(!hi){return hm(ho,hn,"ltr")}var hl=false;for(var hk=0;hk<hi.length;++hk){var hj=hi[hk];if(hj.from<hn&&hj.to>ho||ho==hn&&hj.to==ho){hm(Math.max(hj.from,ho),Math.min(hj.to,hn),hj.level==1?"rtl":"ltr");hl=true}}if(!hl){hm(ho,hn,"ltr")}}var fN=null;function aQ(hi,hk,hm){var hl;fN=null;for(var hj=0;hj<hi.length;++hj){var hn=hi[hj];if(hn.from<hk&&hn.to>hk){return hj}if(hn.to==hk){if(hn.from!=hn.to&&hm=="before"){hl=hj}else{fN=hj}}if(hn.from==hk){if(hn.from!=hn.to&&hm!="before"){hl=hj}else{fN=hj}}}return hl!=null?hl:fN}var bt=(function(){var hn="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var hl="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function hk(hq){if(hq<=247){return hn.charAt(hq)}else{if(1424<=hq&&hq<=1524){return"R"}else{if(1536<=hq&&hq<=1785){return hl.charAt(hq-1536)}else{if(1774<=hq&&hq<=2220){return"r"}else{if(8192<=hq&&hq<=8203){return"w"}else{if(hq==8204){return"b"}else{return"L"}}}}}}}var i=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var hp=/[stwN]/,hj=/[LRr]/,hi=/[Lb1n]/,hm=/[1n]/;function ho(hs,hr,hq){this.level=hs;this.from=hr;this.to=hq}return function(hN,ht){var hC=ht=="ltr"?"L":"R";if(hN.length==0||ht=="ltr"&&!i.test(hN)){return false}var hw=hN.length,hW=[];for(var hZ=0;hZ<hw;++hZ){hW.push(hk(hN.charCodeAt(hZ)))}for(var hK=0,hJ=hC;hK<hw;++hK){var h0=hW[hK];if(h0=="m"){hW[hK]=hJ}else{hJ=h0}}for(var hI=0,hs=hC;hI<hw;++hI){var hV=hW[hI];if(hV=="1"&&hs=="r"){hW[hI]="n"}else{if(hj.test(hV)){hs=hV;if(hV=="r"){hW[hI]="R"}}}}for(var hH=1,hr=hW[0];hH<hw-1;++hH){var hU=hW[hH];if(hU=="+"&&hr=="1"&&hW[hH+1]=="1"){hW[hH]="1"}else{if(hU==","&&hr==hW[hH+1]&&(hr=="1"||hr=="n")){hW[hH]=hr}}hr=hU}for(var hG=0;hG<hw;++hG){var hT=hW[hG];if(hT==","){hW[hG]="N"}else{if(hT=="%"){var hv=(void 0);for(hv=hG+1;hv<hw&&hW[hv]=="%";++hv){}var hA=(hG&&hW[hG-1]=="!")||(hv<hw&&hW[hv]=="1")?"1":"N";for(var hY=hG;hY<hv;++hY){hW[hY]=hA}hG=hv-1}}}for(var hF=0,hz=hC;hF<hw;++hF){var hR=hW[hF];if(hz=="L"&&hR=="1"){hW[hF]="L"}else{if(hj.test(hR)){hz=hR}}}for(var hE=0;hE<hw;++hE){if(hp.test(hW[hE])){var hO=(void 0);for(hO=hE+1;hO<hw&&hp.test(hW[hO]);++hO){}var hQ=(hE?hW[hE-1]:hC)=="L";var hS=(hO<hw?hW[hO]:hC)=="L";var hM=hQ==hS?(hQ?"L":"R"):hC;for(var hy=hE;hy<hO;++hy){hW[hy]=hM}hE=hO-1}}var hP=[],hX;for(var hD=0;hD<hw;){if(hi.test(hW[hD])){var hB=hD;for(++hD;hD<hw&&hi.test(hW[hD]);++hD){}hP.push(new ho(0,hB,hD))}else{var hL=hD,hq=hP.length;for(++hD;hD<hw&&hW[hD]!="L";++hD){}for(var hx=hL;hx<hD;){if(hm.test(hW[hx])){if(hL<hx){hP.splice(hq,0,new ho(1,hL,hx))}var hu=hx;for(++hx;hx<hD&&hm.test(hW[hx]);++hx){}hP.splice(hq,0,new ho(2,hu,hx));hL=hx}else{++hx}}if(hL<hD){hP.splice(hq,0,new ho(1,hL,hD))}}}if(hP[0].level==1&&(hX=hN.match(/^\s+/))){hP[0].from=hX[0].length;hP.unshift(new ho(0,0,hX[0].length))}if(gt(hP).level==1&&(hX=hN.match(/\s+$/))){gt(hP).to-=hX[0].length;hP.push(new ho(0,hw-hX[0].length,hw))}return ht=="rtl"?hP.reverse():hP}})();function a(hi,hj){var i=hi.order;if(i==null){i=hi.order=bt(hi.text,hj)}return i}function bG(i,hj,hi){var hk=eS(i.text,hj+hi,hi);return hk<0||hk>i.text.length?null:hk}function aq(i,hk,hi){var hj=bG(i,hk.ch,hi);return hj==null?null:new ac(hk.line,hj,hi<0?"after":"before")}function fd(hi,hq,hn,hm,hk){if(hi){var hl=a(hn,hq.doc.direction);if(hl){var hj=hk<0?gt(hl):hl[0];var hs=(hk<0)==(hj.level==1);var hp=hs?"after":"before";var i;if(hj.level>0){var ho=bg(hq,hn);i=hk<0?hn.text.length-1:0;var hr=F(hq,ho,i).top;i=cL(function(ht){return F(hq,ho,ht).top==hr},(hk<0)==(hj.level==1)?hj.from:hj.to-1,i);if(hp=="before"){i=bG(hn,i,1)}}else{i=hk<0?hj.to:hj.from}return new ac(hm,i,hp)}}return new ac(hm,hk<0?hn.text.length:0,hk<0?"before":"after")}function v(hs,hx,hl,ho){var hu=a(hx,hs.doc.direction);if(!hu){return aq(hx,hl,ho)}if(hl.ch>=hx.text.length){hl.ch=hx.text.length;hl.sticky="before"}else{if(hl.ch<=0){hl.ch=0;hl.sticky="after"}}var hk=aQ(hu,hl.ch,hl.sticky),hm=hu[hk];if(hs.doc.direction=="ltr"&&hm.level%2==0&&(ho>0?hm.to>hl.ch:hm.from<hl.ch)){return aq(hx,hl,ho)}var hv=function(hz,hy){return bG(hx,hz instanceof ac?hz.ch:hz,hy)};var hp;var ht=function(hy){if(!hs.options.lineWrapping){return{begin:0,end:hx.text.length}}hp=hp||bg(hs,hx);return bz(hs,hx,hp,hy)};var hn=ht(hl.sticky=="before"?hv(hl,-1):hl.ch);if(hs.doc.direction=="rtl"||hm.level==1){var hw=(hm.level==1)==(ho<0);var hi=hv(hl,hw?1:-1);if(hi!=null&&(!hw?hi>=hm.from&&hi>=hn.begin:hi<=hm.to&&hi<=hn.end)){var hr=hw?"before":"after";return new ac(hl.line,hi,hr)}}var hj=function(hy,hB,hE){var hA=function(hG,hF){return hF?new ac(hl.line,hv(hG,1),"before"):new ac(hl.line,hG,"after")};for(;hy>=0&&hy<hu.length;hy+=hB){var hz=hu[hy];var hC=(hB>0)==(hz.level!=1);var hD=hC?hE.begin:hv(hE.end,-1);if(hz.from<=hD&&hD<hz.to){return hA(hD,hC)}hD=hC?hz.from:hv(hz.to,-1);if(hE.begin<=hD&&hD<hE.end){return hA(hD,hC)}}};var hq=hj(hk+ho,ho,hn);if(hq){return hq}var i=ho>0?hn.end:hv(hn.begin,-1);if(i!=null&&!(ho>0&&i==hx.text.length)){hq=hj(ho>0?0:hu.length-1,ho,ht(i));if(hq){return hq}}return null}var fQ=[];var ch=function(hj,i,hi){if(hj.addEventListener){hj.addEventListener(i,hi,false)}else{if(hj.attachEvent){hj.attachEvent("on"+i,hi)}else{var hk=hj._handlers||(hj._handlers={});hk[i]=(hk[i]||fQ).concat(hi)}}};function eU(hi,i){return hi._handlers&&hi._handlers[i]||fQ}function eN(hl,hj,hk){if(hl.removeEventListener){hl.removeEventListener(hj,hk,false)}else{if(hl.detachEvent){hl.detachEvent("on"+hj,hk)}else{var hm=hl._handlers,i=hm&&hm[hj];if(i){var hi=dN(i,hk);if(hi>-1){hm[hj]=i.slice(0,hi).concat(i.slice(hi+1))}}}}}function aM(hm,hl){var hi=eU(hm,hl);if(!hi.length){return}var hj=Array.prototype.slice.call(arguments,2);for(var hk=0;hk<hi.length;++hk){hi[hk].apply(null,hj)}}function a2(i,hj,hi){if(typeof hj=="string"){hj={type:hj,preventDefault:function(){this.defaultPrevented=true}}}aM(i,hi||hj.type,i,hj);return b4(hj)||hj.codemirrorIgnore}function ab(hj){var hi=hj._handlers&&hj._handlers.cursorActivity;if(!hi){return}var hl=hj.curOp.cursorActivityHandlers||(hj.curOp.cursorActivityHandlers=[]);for(var hk=0;hk<hi.length;++hk){if(dN(hl,hi[hk])==-1){hl.push(hi[hk])}}}function f4(hi,i){return eU(hi,i).length>0}function bR(i){i.prototype.on=function(hi,hj){ch(this,hi,hj)};i.prototype.off=function(hi,hj){eN(this,hi,hj)}}function c5(i){if(i.preventDefault){i.preventDefault()}else{i.returnValue=false}}function dV(i){if(i.stopPropagation){i.stopPropagation()}else{i.cancelBubble=true}}function b4(i){return i.defaultPrevented!=null?i.defaultPrevented:i.returnValue==false}function e1(i){c5(i);dV(i)}function Q(i){return i.target||i.srcElement}function gD(hi){var i=hi.which;if(i==null){if(hi.button&1){i=1}else{if(hi.button&2){i=3}else{if(hi.button&4){i=2}}}}if(cs&&hi.ctrlKey&&i==1){i=3}return i}var fs=function(){if(ed&&m<9){return false}var i=gX("div");return"draggable" in i||"dragDrop" in i}();var gB;function bD(i){if(gB==null){var hj=gX("span","\u200b");cc(i,gX("span",[hj,document.createTextNode("x")]));if(i.firstChild.offsetHeight!=0){gB=hj.offsetWidth<=1&&hj.offsetHeight>2&&!(ed&&m<8)}}var hi=gB?gX("span","\u200b"):gX("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");hi.setAttribute("cm-text","");return hi}var gC;function b7(hk){if(gC!=null){return gC}var i=cc(hk,document.createTextNode("A\u062eA"));var hj=cK(i,0,1).getBoundingClientRect();var hi=cK(i,1,2).getBoundingClientRect();ey(hk);if(!hj||hj.left==hj.right){return false}return gC=(hi.right-hj.right<3)}var gI="\n\nb".split(/\n/).length!=3?function(hm){var hn=0,i=[],hl=hm.length;while(hn<=hl){var hk=hm.indexOf("\n",hn);if(hk==-1){hk=hm.length}var hj=hm.slice(hn,hm.charAt(hk-1)=="\r"?hk-1:hk);var hi=hj.indexOf("\r");if(hi!=-1){i.push(hj.slice(0,hi));hn+=hi+1}else{i.push(hj);hn=hk+1}}return i}:function(i){return i.split(/\r\n?|\n/)};var bJ=window.getSelection?function(hi){try{return hi.selectionStart!=hi.selectionEnd}catch(i){return false}}:function(hj){var i;try{i=hj.ownerDocument.selection.createRange()}catch(hi){}if(!i||i.parentElement()!=hj){return false}return i.compareEndPoints("StartToEnd",i)!=0};var dE=(function(){var i=gX("div");if("oncopy" in i){return true}i.setAttribute("oncopy","return;");return typeof i.oncopy=="function"})();var fR=null;function aU(hi){if(fR!=null){return fR}var hj=cc(hi,gX("span","x"));var hk=hj.getBoundingClientRect();var i=cK(hj,0,1).getBoundingClientRect();return fR=Math.abs(hk.left-i.left)>1}var dX={};var a3={};function e5(i,hi){if(arguments.length>2){hi.dependencies=Array.prototype.slice.call(arguments,2)}dX[i]=hi}function bC(hi,i){a3[hi]=i}function g9(i){if(typeof i=="string"&&a3.hasOwnProperty(i)){i=a3[i]}else{if(i&&typeof i.name=="string"&&a3.hasOwnProperty(i.name)){var hi=a3[i.name];if(typeof hi=="string"){hi={name:hi}}i=cI(hi,i);i.name=hi.name}else{if(typeof i=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(i)){return g9("application/xml")}else{if(typeof i=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(i)){return g9("application/json")}}}}if(typeof i=="string"){return{name:i}}else{return i||{name:"null"}}}function gm(hj,hi){hi=g9(hi);var hl=dX[hi.name];if(!hl){return gm(hj,"text/plain")}var hm=hl(hj,hi);if(dU.hasOwnProperty(hi.name)){var hk=dU[hi.name];for(var hn in hk){if(!hk.hasOwnProperty(hn)){continue}if(hm.hasOwnProperty(hn)){hm["_"+hn]=hm[hn]}hm[hn]=hk[hn]}}hm.name=hi.name;if(hi.helperType){hm.helperType=hi.helperType}if(hi.modeProps){for(var i in hi.modeProps){hm[i]=hi.modeProps[i]}}return hm}var dU={};function fi(hj,hi){var i=dU.hasOwnProperty(hj)?dU[hj]:(dU[hj]={});aX(hi,i)}function co(hk,i){if(i===true){return i}if(hk.copyState){return hk.copyState(i)}var hj={};for(var hl in i){var hi=i[hl];if(hi instanceof Array){hi=hi.concat([])}hj[hl]=hi}return hj}function g5(hj,i){var hi;while(hj.innerMode){hi=hj.innerMode(i);if(!hi||hi.mode==hj){break}i=hi.state;hj=hi.mode}return hi||{mode:hj,state:i}}function cl(hj,hi,i){return hj.startState?hj.startState(hi,i):true}var fC=function(i,hj,hi){this.pos=this.start=0;this.string=i;this.tabSize=hj||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0;this.lineOracle=hi};fC.prototype.eol=function(){return this.pos>=this.string.length};fC.prototype.sol=function(){return this.pos==this.lineStart};fC.prototype.peek=function(){return this.string.charAt(this.pos)||undefined};fC.prototype.next=function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}};fC.prototype.eat=function(i){var hj=this.string.charAt(this.pos);var hi;if(typeof i=="string"){hi=hj==i}else{hi=hj&&(i.test?i.test(hj):i(hj))}if(hi){++this.pos;return hj}};fC.prototype.eatWhile=function(i){var hi=this.pos;while(this.eat(i)){}return this.pos>hi};fC.prototype.eatSpace=function(){var hi=this;var i=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++hi.pos}return this.pos>i};fC.prototype.skipToEnd=function(){this.pos=this.string.length};fC.prototype.skipTo=function(i){var hi=this.string.indexOf(i,this.pos);if(hi>-1){this.pos=hi;return true}};fC.prototype.backUp=function(i){this.pos-=i};fC.prototype.column=function(){if(this.lastColumnPos<this.start){this.lastColumnValue=cb(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?cb(this.string,this.lineStart,this.tabSize):0)};fC.prototype.indentation=function(){return cb(this.string,null,this.tabSize)-(this.lineStart?cb(this.string,this.lineStart,this.tabSize):0)};fC.prototype.match=function(hl,hi,i){if(typeof hl=="string"){var hm=function(hn){return i?hn.toLowerCase():hn};var hk=this.string.substr(this.pos,hl.length);if(hm(hk)==hm(hl)){if(hi!==false){this.pos+=hl.length}return true}}else{var hj=this.string.slice(this.pos).match(hl);if(hj&&hj.index>0){return null}if(hj&&hi!==false){this.pos+=hj[0].length}return hj}};fC.prototype.current=function(){return this.string.slice(this.start,this.pos)};fC.prototype.hideFirstChars=function(hi,i){this.lineStart+=hi;try{return i()}finally{this.lineStart-=hi}};fC.prototype.lookAhead=function(hi){var i=this.lineOracle;return i&&i.lookAhead(hi)};var aO=function(hi,i){this.state=hi;this.lookAhead=i};var ag=function(hk,hj,i,hi){this.state=hj;this.doc=hk;this.line=i;this.maxLookAhead=hi||0};ag.prototype.lookAhead=function(hi){var i=this.doc.getLine(this.line+hi);if(i!=null&&hi>this.maxLookAhead){this.maxLookAhead=hi}return i};ag.prototype.nextLine=function(){this.line++;if(this.maxLookAhead>0){this.maxLookAhead--}};ag.fromSaved=function(hj,hi,i){if(hi instanceof aO){return new ag(hj,co(hj.mode,hi.saved),i,hi.lookAhead)}else{return new ag(hj,co(hj.mode,hi),i)}};ag.prototype.save=function(hi){var i=hi!==false?co(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new aO(i,this.maxLookAhead):i};function gk(hn,hp,hi,hl){var ho=[hn.state.modeGen],hk={};x(hn,hp.text,hn.doc.mode,hi,function(hq,hr){return ho.push(hq,hr)},hk,hl);var i=hi.state;var hm=function(ht){var hr=hn.state.overlays[ht],hs=1,hq=0;hi.state=true;x(hn,hp.text,hr.mode,hi,function(hu,hw){var hy=hs;while(hq<hu){var hv=ho[hs];if(hv>hu){ho.splice(hs,1,hu,ho[hs+1],hv)}hs+=2;hq=Math.min(hu,hv)}if(!hw){return}if(hr.opaque){ho.splice(hy,hs-hy,hu,"overlay "+hw);hs=hy+2}else{for(;hy<hs;hy+=2){var hx=ho[hy+1];ho[hy+1]=(hx?hx+" ":"")+"overlay "+hw}}},hk)};for(var hj=0;hj<hn.state.overlays.length;++hj){hm(hj)}hi.state=i;return{styles:ho,classes:hk.bgClass||hk.textClass?hk:null}}function dA(hi,hk,hm){if(!hk.styles||hk.styles[0]!=hi.state.modeGen){var hl=fG(hi,b6(hk));var hj=hk.text.length>hi.options.maxHighlightLength&&co(hi.doc.mode,hl.state);var i=gk(hi,hk,hl);if(hj){hl.state=hj}hk.stateAfter=hl.save(!hj);hk.styles=i.styles;if(i.classes){hk.styleClasses=i.classes}else{if(hk.styleClasses){hk.styleClasses=null}}if(hm===hi.doc.highlightFrontier){hi.doc.modeFrontier=Math.max(hi.doc.modeFrontier,++hi.doc.highlightFrontier)}}return hk.styles}function fG(i,ho,hi){var hm=i.doc,hl=i.display;if(!hm.mode.startState){return new ag(hm,true,ho)}var hn=cX(i,ho,hi);var hk=hn>hm.first&&fZ(hm,hn-1).stateAfter;var hj=hk?ag.fromSaved(hm,hk,hn):new ag(hm,cl(hm.mode),hn);hm.iter(hn,ho,function(hp){d2(i,hp.text,hj);var hq=hj.line;hp.stateAfter=hq==ho-1||hq%5==0||hq>=hl.viewFrom&&hq<hl.viewTo?hj.save():null;hj.nextLine()});if(hi){hm.modeFrontier=hj.line}return hj}function d2(i,hm,hj,hi){var hl=i.doc.mode;var hk=new fC(hm,i.options.tabSize,hj);hk.start=hk.pos=hi||0;if(hm==""){f9(hl,hj.state)}while(!hk.eol()){fg(hl,hk,hj.state);hk.start=hk.pos}}function f9(hj,hi){if(hj.blankLine){return hj.blankLine(hi)}if(!hj.innerMode){return}var i=g5(hj,hi);if(i.mode.blankLine){return i.mode.blankLine(i.state)}}function fg(hn,hm,hl,hi){for(var hj=0;hj<10;hj++){if(hi){hi[0]=g5(hn,hl).mode}var hk=hn.token(hm,hl);if(hm.pos>hm.start){return hk}}throw new Error("Mode "+hn.name+" failed to advance stream.")}var dD=function(hj,i,hi){this.start=hj.start;this.end=hj.pos;this.string=hj.current();this.type=i||null;this.state=hi};function cP(hp,hn,hk,hj){var ho=hp.doc,hl=ho.mode,i;hn=gy(ho,hn);var hr=fZ(ho,hn.line),hi=fG(hp,hn.line,hk);var hq=new fC(hr.text,hp.options.tabSize,hi),hm;if(hj){hm=[]}while((hj||hq.pos<hn.ch)&&!hq.eol()){hq.start=hq.pos;i=fg(hl,hq,hi.state);if(hj){hm.push(new dD(hq,i,co(ho.mode,hi.state)))}}return hj?hm:new dD(hq,i,hi.state)}function dO(hj,hi){if(hj){for(;;){var i=hj.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i){break}hj=hj.slice(0,i.index)+hj.slice(i.index+i[0].length);var hk=i[1]?"bgClass":"textClass";if(hi[hk]==null){hi[hk]=i[2]}else{if(!(new RegExp("(?:^|s)"+i[2]+"(?:$|s)")).test(hi[hk])){hi[hk]+=" "+i[2]}}}}return hj}function x(hr,ht,hm,hj,hn,hk,hl){var hi=hm.flattenSpans;if(hi==null){hi=hr.options.flattenSpans}var hp=0,ho=null;var hs=new fC(ht,hr.options.tabSize,hj),i;var hv=hr.options.addModeClass&&[null];if(ht==""){dO(f9(hm,hj.state),hk)}while(!hs.eol()){if(hs.pos>hr.options.maxHighlightLength){hi=false;if(hl){d2(hr,ht,hj,hs.pos)}hs.pos=ht.length;i=null}else{i=dO(fg(hm,hs,hj.state,hv),hk)}if(hv){var hu=hv[0].name;if(hu){i="m-"+(i?hu+" "+i:hu)}}if(!hi||ho!=i){while(hp<hs.start){hp=Math.min(hs.start,hp+5000);hn(hp,ho)}ho=i}hs.start=hs.pos}while(hp<hs.pos){var hq=Math.min(hs.pos,hp+5000);hn(hq,ho);hp=hq}}function cX(ho,hi,hl){var hj,hm,hn=ho.doc;var hk=hl?-1:hi-(ho.doc.mode.innerMode?1000:100);for(var hr=hi;hr>hk;--hr){if(hr<=hn.first){return hn.first}var hq=fZ(hn,hr-1),i=hq.stateAfter;if(i&&(!hl||hr+(i instanceof aO?i.lookAhead:0)<=hn.modeFrontier)){return hr}var hp=cb(hq.text,null,ho.options.tabSize);if(hm==null||hj>hp){hm=hr-1;hj=hp}}return hm}function hb(hj,hl){hj.modeFrontier=Math.min(hj.modeFrontier,hl);if(hj.highlightFrontier<hl-10){return}var hk=hj.first;for(var i=hl-1;i>hk;i--){var hi=fZ(hj,i).stateAfter;if(hi&&(!(hi instanceof aO)||i+hi.lookAhead<hl)){hk=i+1;break}}hj.highlightFrontier=Math.min(hj.highlightFrontier,hk)}var g2=function(hj,hi,i){this.text=hj;du(this,hi);this.height=i?i(this):1};g2.prototype.lineNo=function(){return b6(this)};bR(g2);function eX(hi,hl,hj,i){hi.text=hl;if(hi.stateAfter){hi.stateAfter=null}if(hi.styles){hi.styles=null}if(hi.order!=null){hi.order=null}g6(hi);du(hi,hj);var hk=i?i(hi):1;if(hk!=hi.height){g3(hi,hk)}}function bT(i){i.parent=null;g6(i)}var er={};var cn={};function fF(hj,hi){if(!hj||/^\s*$/.test(hj)){return null}var i=hi.addModeClass?cn:er;return i[hj]||(i[hj]=hj.replace(/\S+/g,"cm-$&"))}function fA(ho,hn){var hm=g4("span",null,null,dr?"padding-right: .1px":null);var hl={pre:g4("pre",[hm],"CodeMirror-line"),content:hm,col:0,pos:0,cm:ho,trailingSpace:false,splitSpaces:(ed||dr)&&ho.getOption("lineWrapping")};hn.measure={};for(var hk=0;hk<=(hn.rest?hn.rest.length:0);hk++){var hq=hk?hn.rest[hk-1]:hn.line,hj=(void 0);hl.pos=0;hl.addToken=u;if(b7(ho.display.measure)&&(hj=a(hq,ho.doc.direction))){hl.addToken=aa(hl.addToken,hj)}hl.map=[];var hi=hn!=ho.display.externalMeasured&&b6(hq);bE(hq,hl,dA(ho,hq,hi));if(hq.styleClasses){if(hq.styleClasses.bgClass){hl.bgClass=gM(hq.styleClasses.bgClass,hl.bgClass||"")}if(hq.styleClasses.textClass){hl.textClass=gM(hq.styleClasses.textClass,hl.textClass||"")}}if(hl.map.length==0){hl.map.push(0,0,hl.content.appendChild(bD(ho.display.measure)))}if(hk==0){hn.measure.map=hl.map;hn.measure.cache={}}else{(hn.measure.maps||(hn.measure.maps=[])).push(hl.map);(hn.measure.caches||(hn.measure.caches=[])).push({})}}if(dr){var hp=hl.content.lastChild;if(/\bcm-tab\b/.test(hp.className)||(hp.querySelector&&hp.querySelector(".cm-tab"))){hl.content.className="cm-tab-wrap-hack"}}aM(ho,"renderLine",ho,hn.line,hl.pre);if(hl.pre.className){hl.textClass=gM(hl.pre.className,hl.textClass||"")}return hl}function fY(hi){var i=gX("span","\u2022","cm-invalidchar");i.title="\\u"+hi.charCodeAt(0).toString(16);i.setAttribute("aria-label",i.title);return i}function u(hs,hn,hx,hu,hq,hA,hm){if(!hn){return}var hw=hs.splitSpaces?c4(hn,hs.trailingSpace):hn;var i=hs.cm.state.specialChars,hi=false;var hv;if(!i.test(hn)){hs.col+=hn.length;hv=document.createTextNode(hw);hs.map.push(hs.pos,hs.pos+hn.length,hv);if(ed&&m<9){hi=true}hs.pos+=hn.length}else{hv=document.createDocumentFragment();var hk=0;while(true){i.lastIndex=hk;var ht=i.exec(hn);var hz=ht?ht.index-hk:hn.length-hk;if(hz){var hp=document.createTextNode(hw.slice(hk,hk+hz));if(ed&&m<9){hv.appendChild(gX("span",[hp]))}else{hv.appendChild(hp)}hs.map.push(hs.pos,hs.pos+hz,hp);hs.col+=hz;hs.pos+=hz}if(!ht){break}hk+=hz+1;var hy=(void 0);if(ht[0]=="\t"){var hr=hs.cm.options.tabSize,ho=hr-hs.col%hr;hy=hv.appendChild(gX("span",cO(ho),"cm-tab"));hy.setAttribute("role","presentation");hy.setAttribute("cm-text","\t");hs.col+=ho}else{if(ht[0]=="\r"||ht[0]=="\n"){hy=hv.appendChild(gX("span",ht[0]=="\r"?"\u240d":"\u2424","cm-invalidchar"));hy.setAttribute("cm-text",ht[0]);hs.col+=1}else{hy=hs.cm.options.specialCharPlaceholder(ht[0]);hy.setAttribute("cm-text",ht[0]);if(ed&&m<9){hv.appendChild(gX("span",[hy]))}else{hv.appendChild(hy)}hs.col+=1}}hs.map.push(hs.pos,hs.pos+1,hy);hs.pos++}}hs.trailingSpace=hw.charCodeAt(hn.length-1)==32;if(hx||hu||hq||hi||hm){var hj=hx||"";if(hu){hj+=hu}if(hq){hj+=hq}var hl=gX("span",[hv],hj,hm);if(hA){hl.title=hA}return hs.content.appendChild(hl)}hs.content.appendChild(hv)}function c4(hn,hm){if(hn.length>1&&!/  /.test(hn)){return hn}var hj=hm,hi="";for(var hk=0;hk<hn.length;hk++){var hl=hn.charAt(hk);if(hl==" "&&hj&&(hk==hn.length-1||hn.charCodeAt(hk+1)==32)){hl="\u00a0"}hi+=hl;hj=hl==" "}return hi}function aa(hi,i){return function(hq,hs,hj,hn,ht,hr,hp){hj=hj?hj+" cm-force-border":"cm-force-border";var hk=hq.pos,hm=hk+hs.length;for(;;){var hl=(void 0);for(var ho=0;ho<i.length;ho++){hl=i[ho];if(hl.to>hk&&hl.from<=hk){break}}if(hl.to>=hm){return hi(hq,hs,hj,hn,ht,hr,hp)}hi(hq,hs.slice(0,hl.to-hk),hj,hn,null,hr,hp);hn=null;hs=hs.slice(hl.to-hk);hk=hl.to}}}function al(hi,hk,i,hj){var hl=!hj&&i.widgetNode;if(hl){hi.map.push(hi.pos,hi.pos+hk,hl)}if(!hj&&hi.cm.display.input.needsContentAttribute){if(!hl){hl=hi.content.appendChild(document.createElement("span"))}hl.setAttribute("cm-marker",i.id)}if(hl){hi.cm.display.input.setUneditable(hl);hi.content.appendChild(hl)}hi.pos+=hk;hi.trailingSpace=false}function bE(ht,hA,hs){var hn=ht.markedSpans,hq=ht.text,hy=0;if(!hn){for(var ho=1;ho<hs.length;ho+=2){hA.addToken(hA,hq.slice(hy,hy=hs[ho]),fF(hs[ho+1],hA.cm.options))}return}var hE=hq.length,hm=0,hD=1,hw="",hF,hu;var hJ=0,hi,hI,hx,hK,hk;for(;;){if(hJ==hm){hi=hI=hx=hK=hu="";hk=null;hJ=Infinity;var hp=[],hr=(void 0);for(var hB=0;hB<hn.length;++hB){var hC=hn[hB],hz=hC.marker;if(hz.type=="bookmark"&&hC.from==hm&&hz.widgetNode){hp.push(hz)}else{if(hC.from<=hm&&(hC.to==null||hC.to>hm||hz.collapsed&&hC.to==hm&&hC.from==hm)){if(hC.to!=null&&hC.to!=hm&&hJ>hC.to){hJ=hC.to;hI=""}if(hz.className){hi+=" "+hz.className}if(hz.css){hu=(hu?hu+";":"")+hz.css}if(hz.startStyle&&hC.from==hm){hx+=" "+hz.startStyle}if(hz.endStyle&&hC.to==hJ){(hr||(hr=[])).push(hz.endStyle,hC.to)}if(hz.title&&!hK){hK=hz.title}if(hz.collapsed&&(!hk||el(hk.marker,hz)<0)){hk=hC}}else{if(hC.from>hm&&hJ>hC.from){hJ=hC.from}}}}if(hr){for(var hH=0;hH<hr.length;hH+=2){if(hr[hH+1]==hJ){hI+=" "+hr[hH]}}}if(!hk||hk.from==hm){for(var hG=0;hG<hp.length;++hG){al(hA,0,hp[hG])}}if(hk&&(hk.from||0)==hm){al(hA,(hk.to==null?hE+1:hk.to)-hm,hk.marker,hk.from==null);if(hk.to==null){return}if(hk.to==hm){hk=false}}}if(hm>=hE){break}var hv=Math.min(hE,hJ);while(true){if(hw){var hj=hm+hw.length;if(!hk){var hl=hj>hv?hw.slice(0,hv-hm):hw;hA.addToken(hA,hl,hF?hF+hi:hi,hx,hm+hl.length==hJ?hI:"",hK,hu)}if(hj>=hv){hw=hw.slice(hv-hm);hm=hv;break}hm=hj;hx=""}hw=hq.slice(hy,hy=hs[hD++]);hF=fF(hs[hD++],hA.cm.options)}}}function bM(hj,i,hi){this.line=i;this.rest=g(i);this.size=this.rest?b6(gt(this.rest))-hi+1:1;this.node=this.text=null;this.hidden=gg(hj,i)}function fE(i,hn,hm){var hl=[],hj;for(var hk=hn;hk<hm;hk=hj){var hi=new bM(i.doc,fZ(i.doc,hk),hk);hj=hk+hi.size;hl.push(hi)}return hl}var bF=null;function fb(i){if(bF){bF.ops.push(i)}else{i.ownsGroup=bF={ops:[i],delayedCallbacks:[]}}}function dk(hl){var hk=hl.delayedCallbacks,hj=0;do{for(;hj<hk.length;hj++){hk[hj].call(null)}for(var hi=0;hi<hl.ops.length;hi++){var hm=hl.ops[hi];if(hm.cursorActivityHandlers){while(hm.cursorActivityCalled<hm.cursorActivityHandlers.length){hm.cursorActivityHandlers[hm.cursorActivityCalled++].call(null,hm.cm)}}}}while(hj<hk.length)}function ci(hj,hi){var i=hj.ownsGroup;if(!i){return}try{dk(i)}finally{bF=null;hi(i)}}var bQ=null;function am(ho,hm){var hi=eU(ho,hm);if(!hi.length){return}var hk=Array.prototype.slice.call(arguments,2),hn;if(bF){hn=bF.delayedCallbacks}else{if(bQ){hn=bQ}else{hn=bQ=[];setTimeout(aV,0)}}var hj=function(hp){hn.push(function(){return hi[hp].apply(null,hk)})};for(var hl=0;hl<hi.length;++hl){hj(hl)}}function aV(){var hi=bQ;bQ=null;for(var hj=0;hj<hi.length;++hj){hi[hj]()}}function aj(i,hj,hl,hm){for(var hi=0;hi<hj.changes.length;hi++){var hk=hj.changes[hi];if(hk=="text"){f5(i,hj)}else{if(hk=="gutter"){dK(i,hj,hl,hm)}else{if(hk=="class"){d9(i,hj)}else{if(hk=="widget"){aw(i,hj,hm)}}}}}hj.changes=null}function gv(i){if(i.node==i.text){i.node=gX("div",null,null,"position: relative");if(i.text.parentNode){i.text.parentNode.replaceChild(i.node,i.text)}i.node.appendChild(i.text);if(ed&&m<8){i.node.style.zIndex=2}}return i.node}function e7(i,hj){var hi=hj.bgClass?hj.bgClass+" "+(hj.line.bgClass||""):hj.line.bgClass;if(hi){hi+=" CodeMirror-linebackground"}if(hj.background){if(hi){hj.background.className=hi}else{hj.background.parentNode.removeChild(hj.background);hj.background=null}}else{if(hi){var hk=gv(hj);hj.background=hk.insertBefore(gX("div",null,hi),hk.firstChild);i.display.input.setUneditable(hj.background)}}}function eq(i,hi){var hj=i.display.externalMeasured;if(hj&&hj.line==hi.line){i.display.externalMeasured=null;hi.measure=hj.measure;return hj.built}return fA(i,hi)}function f5(i,hk){var hi=hk.text.className;var hj=eq(i,hk);if(hk.text==hk.node){hk.node=hj.pre}hk.text.parentNode.replaceChild(hj.pre,hk.text);hk.text=hj.pre;if(hj.bgClass!=hk.bgClass||hj.textClass!=hk.textClass){hk.bgClass=hj.bgClass;hk.textClass=hj.textClass;d9(i,hk)}else{if(hi){hk.text.className=hi}}}function d9(hi,hj){e7(hi,hj);if(hj.line.wrapClass){gv(hj).className=hj.line.wrapClass}else{if(hj.node!=hj.text){hj.node.className=""}}var i=hj.textClass?hj.textClass+" "+(hj.line.textClass||""):hj.line.textClass;hj.text.className=i||""}function dK(hp,hn,hm,ho){if(hn.gutter){hn.node.removeChild(hn.gutter);hn.gutter=null}if(hn.gutterBackground){hn.node.removeChild(hn.gutterBackground);hn.gutterBackground=null}if(hn.line.gutterClass){var hi=gv(hn);hn.gutterBackground=gX("div",null,"CodeMirror-gutter-background "+hn.line.gutterClass,("left: "+(hp.options.fixedGutter?ho.fixedPos:-ho.gutterTotalWidth)+"px; width: "+(ho.gutterTotalWidth)+"px"));hp.display.input.setUneditable(hn.gutterBackground);hi.insertBefore(hn.gutterBackground,hn.text)}var hk=hn.line.gutterMarkers;if(hp.options.lineNumbers||hk){var hq=gv(hn);var hl=hn.gutter=gX("div",null,"CodeMirror-gutter-wrapper",("left: "+(hp.options.fixedGutter?ho.fixedPos:-ho.gutterTotalWidth)+"px"));hp.display.input.setUneditable(hl);hq.insertBefore(hl,hn.text);if(hn.line.gutterClass){hl.className+=" "+hn.line.gutterClass}if(hp.options.lineNumbers&&(!hk||!hk["CodeMirror-linenumbers"])){hn.lineNumber=hl.appendChild(gX("div",e3(hp.options,hm),"CodeMirror-linenumber CodeMirror-gutter-elt",("left: "+(ho.gutterLeft["CodeMirror-linenumbers"])+"px; width: "+(hp.display.lineNumInnerWidth)+"px")))}if(hk){for(var hj=0;hj<hp.options.gutters.length;++hj){var i=hp.options.gutters[hj],hr=hk.hasOwnProperty(i)&&hk[i];if(hr){hl.appendChild(gX("div",[hr],"CodeMirror-gutter-elt",("left: "+(ho.gutterLeft[i])+"px; width: "+(ho.gutterWidth[i])+"px")))}}}}}function aw(i,hi,hl){if(hi.alignable){hi.alignable=null}for(var hk=hi.node.firstChild,hj=(void 0);hk;hk=hj){hj=hk.nextSibling;if(hk.className=="CodeMirror-linewidget"){hi.node.removeChild(hk)}}gc(i,hi,hl)}function aN(i,hj,hk,hl){var hi=eq(i,hj);hj.text=hj.node=hi.pre;if(hi.bgClass){hj.bgClass=hi.bgClass}if(hi.textClass){hj.textClass=hi.textClass}d9(i,hj);dK(i,hj,hk,hl);gc(i,hj,hl);return hj.node}function gc(hi,hk,hl){g1(hi,hk.line,hk,hl,true);if(hk.rest){for(var hj=0;hj<hk.rest.length;hj++){g1(hi,hk.rest[hj],hk,hl,false)}}}function g1(hq,hr,hn,hp,hl){if(!hr.widgets){return}var hi=gv(hn);for(var hk=0,ho=hr.widgets;hk<ho.length;++hk){var hm=ho[hk],hj=gX("div",[hm.node],"CodeMirror-linewidget");if(!hm.handleMouseEvents){hj.setAttribute("cm-ignore-events","true")}bX(hm,hj,hn,hp);hq.display.input.setUneditable(hj);if(hl&&hm.above){hi.insertBefore(hj,hn.gutter||hn.text)}else{hi.appendChild(hj)}am(hm,"redraw")}}function bX(hk,hj,i,hl){if(hk.noHScroll){(i.alignable||(i.alignable=[])).push(hj);var hi=hl.wrapperWidth;hj.style.left=hl.fixedPos+"px";if(!hk.coverGutter){hi-=hl.gutterTotalWidth;hj.style.paddingLeft=hl.gutterTotalWidth+"px"}hj.style.width=hi+"px"}if(hk.coverGutter){hj.style.zIndex=5;hj.style.position="relative";if(!hk.noHScroll){hj.style.marginLeft=-hl.gutterTotalWidth+"px"}}}function dp(hj){if(hj.height!=null){return hj.height}var i=hj.doc.cm;if(!i){return 0}if(!g8(document.body,hj.node)){var hi="position: relative;";if(hj.coverGutter){hi+="margin-left: -"+i.display.gutters.offsetWidth+"px;"}if(hj.noHScroll){hi+="width: "+i.display.wrapper.clientWidth+"px;"}cc(i.display.measure,gX("div",[hj.node],null,hi))}return hj.height=hj.node.parentNode.offsetHeight}function bm(hi,i){for(var hj=Q(i);hj!=hi.wrapper;hj=hj.parentNode){if(!hj||(hj.nodeType==1&&hj.getAttribute("cm-ignore-events")=="true")||(hj.parentNode==hi.sizer&&hj!=hi.mover)){return true}}}function fT(i){return i.lineSpace.offsetTop}function b0(i){return i.mover.offsetHeight-i.lineSpace.offsetHeight}function fP(hk){if(hk.cachedPaddingH){return hk.cachedPaddingH}var hj=cc(hk.measure,gX("pre","x"));var i=window.getComputedStyle?window.getComputedStyle(hj):hj.currentStyle;var hi={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};if(!isNaN(hi.left)&&!isNaN(hi.right)){hk.cachedPaddingH=hi}return hi}function dj(i){return ec-i.display.nativeBarWidth}function dQ(i){return i.display.scroller.clientWidth-dj(i)-i.display.barWidth}function dl(i){return i.display.scroller.clientHeight-dj(i)-i.display.barHeight}function cE(hp,hl,ho){var hk=hp.options.lineWrapping;var hm=hk&&dQ(hp);if(!hl.measure.heights||hk&&hl.measure.width!=hm){var hn=hl.measure.heights=[];if(hk){hl.measure.width=hm;var hr=hl.text.firstChild.getClientRects();for(var hi=0;hi<hr.length-1;hi++){var hq=hr[hi],hj=hr[hi+1];if(Math.abs(hq.bottom-hj.bottom)>2){hn.push((hq.bottom+hj.top)/2-ho.top)}}}hn.push(ho.bottom-ho.top)}}function cS(hk,hi,hl){if(hk.line==hi){return{map:hk.measure.map,cache:hk.measure.cache}}for(var hj=0;hj<hk.rest.length;hj++){if(hk.rest[hj]==hi){return{map:hk.measure.maps[hj],cache:hk.measure.caches[hj]}}}for(var hm=0;hm<hk.rest.length;hm++){if(b6(hk.rest[hm])>hl){return{map:hk.measure.maps[hm],cache:hk.measure.caches[hm],before:true}}}}function dt(i,hj){hj=z(hj);var hl=b6(hj);var hi=i.display.externalMeasured=new bM(i.doc,hj,hl);hi.lineN=hl;var hk=hi.built=fA(i,hi);hi.text=hk.pre;cc(i.display.lineMeasure,hk.pre);return hi}function eP(i,hi,hk,hj){return F(i,bg(i,hi),hk,hj)}function fW(i,hj){if(hj>=i.display.viewFrom&&hj<i.display.viewTo){return i.display.view[dW(i,hj)]}var hi=i.display.externalMeasured;if(hi&&hj>=hi.lineN&&hj<hi.lineN+hi.size){return hi}}function bg(i,hj){var hk=b6(hj);var hi=fW(i,hk);if(hi&&!hi.text){hi=null}else{if(hi&&hi.changes){aj(i,hi,hk,fX(i));i.curOp.forceUpdate=true}}if(!hi){hi=dt(i,hj)}var hl=cS(hi,hj,hk);return{line:hj,view:hi,rect:null,map:hl.map,cache:hl.cache,before:hl.before,hasHeights:false}}function F(i,hn,hl,hi,hk){if(hn.before){hl=-1}var hj=hl+(hi||""),hm;if(hn.cache.hasOwnProperty(hj)){hm=hn.cache[hj]}else{if(!hn.rect){hn.rect=hn.view.text.getBoundingClientRect()}if(!hn.hasHeights){cE(i,hn.view,hn.rect);hn.hasHeights=true}hm=l(i,hn,hl,hi);if(!hm.bogus){hn.cache[hj]=hm}}return{left:hm.left,right:hm.right,top:hk?hm.rtop:hm.top,bottom:hk?hm.rbottom:hm.bottom}}var ff={left:0,right:0,top:0,bottom:0};function aT(hj,hi,hp){var hl,hk,hn,hq,hm,hr;for(var ho=0;ho<hj.length;ho+=3){hm=hj[ho];hr=hj[ho+1];if(hi<hm){hk=0;hn=1;hq="left"}else{if(hi<hr){hk=hi-hm;hn=hk+1}else{if(ho==hj.length-3||hi==hr&&hj[ho+3]>hi){hn=hr-hm;hk=hn-1;if(hi>=hr){hq="right"}}}}if(hk!=null){hl=hj[ho+2];if(hm==hr&&hp==(hl.insertLeft?"left":"right")){hq=hp}if(hp=="left"&&hk==0){while(ho&&hj[ho-2]==hj[ho-3]&&hj[ho-1].insertLeft){hl=hj[(ho-=3)+2];hq="left"}}if(hp=="right"&&hk==hr-hm){while(ho<hj.length-3&&hj[ho+3]==hj[ho+4]&&!hj[ho+5].insertLeft){hl=hj[(ho+=3)+2];hq="right"}}break}}return{node:hl,start:hk,end:hn,collapse:hq,coverStart:hm,coverEnd:hr}}function fB(hj,hi){var hl=ff;if(hi=="left"){for(var hk=0;hk<hj.length;hk++){if((hl=hj[hk]).left!=hl.right){break}}}else{for(var hm=hj.length-1;hm>=0;hm--){if((hl=hj[hm]).left!=hl.right){break}}}return hl}function l(hq,hA,ht,hn){var hr=aT(hA.map,ht,hn);var hy=hr.node,hm=hr.start,hl=hr.end,hi=hr.collapse;var hj;if(hy.nodeType==3){for(var ho=0;ho<4;ho++){while(hm&&f8(hA.line.text.charAt(hr.coverStart+hm))){--hm}while(hr.coverStart+hl<hr.coverEnd&&f8(hA.line.text.charAt(hr.coverStart+hl))){++hl}if(ed&&m<9&&hm==0&&hl==hr.coverEnd-hr.coverStart){hj=hy.parentNode.getBoundingClientRect()}else{hj=fB(cK(hy,hm,hl).getClientRects(),hn)}if(hj.left||hj.right||hm==0){break}hl=hm;hm=hm-1;hi="right"}if(ed&&m<11){hj=fv(hq.display.measure,hj)}}else{if(hm>0){hi=hn="right"}var hk;if(hq.options.lineWrapping&&(hk=hy.getClientRects()).length>1){hj=hk[hn=="right"?hk.length-1:0]}else{hj=hy.getBoundingClientRect()}}if(ed&&m<9&&!hm&&(!hj||!hj.left&&!hj.right)){var hp=hy.parentNode.getClientRects()[0];if(hp){hj={left:hp.left,right:hp.left+d6(hq.display),top:hp.top,bottom:hp.bottom}}else{hj=ff}}var hw=hj.top-hA.rect.top,hu=hj.bottom-hA.rect.top;var hC=(hw+hu)/2;var hB=hA.view.measure.heights;var hz=0;for(;hz<hB.length-1;hz++){if(hC<hB[hz]){break}}var hx=hz?hB[hz-1]:0,hv=hB[hz];var hs={left:(hi=="right"?hj.right:hj.left)-hA.rect.left,right:(hi=="left"?hj.left:hj.right)-hA.rect.left,top:hx,bottom:hv};if(!hj.left&&!hj.right){hs.bogus=true}if(!hq.options.singleCursorHeightPerLine){hs.rtop=hw;hs.rbottom=hu}return hs}function fv(hj,hk){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!aU(hj)){return hk}var hi=screen.logicalXDPI/screen.deviceXDPI;var i=screen.logicalYDPI/screen.deviceYDPI;return{left:hk.left*hi,right:hk.right*hi,top:hk.top*i,bottom:hk.bottom*i}}function aC(hj){if(hj.measure){hj.measure.cache={};hj.measure.heights=null;if(hj.rest){for(var hi=0;hi<hj.rest.length;hi++){hj.measure.caches[hi]={}}}}}function aY(hi){hi.display.externalMeasure=null;ey(hi.display.lineMeasure);for(var hj=0;hj<hi.display.view.length;hj++){aC(hi.display.view[hj])}}function ar(i){aY(i);i.display.cachedCharWidth=i.display.cachedTextHeight=i.display.cachedPaddingH=null;if(!i.options.lineWrapping){i.display.maxLineChanged=true}i.display.lineNumChars=null}function cT(){if(dH&&aW){return -(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft))}return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function cR(){if(dH&&aW){return -(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop))}return window.pageYOffset||(document.documentElement||document.body).scrollTop}function fy(hp,hm,ho,hj,hl){if(!hl&&hm.widgets){for(var hk=0;hk<hm.widgets.length;++hk){if(hm.widgets[hk].above){var hr=dp(hm.widgets[hk]);ho.top+=hr;ho.bottom+=hr}}}if(hj=="line"){return ho}if(!hj){hj="local"}var hn=b5(hm);if(hj=="local"){hn+=fT(hp.display)}else{hn-=hp.display.viewOffset}if(hj=="page"||hj=="window"){var hi=hp.display.lineSpace.getBoundingClientRect();hn+=hi.top+(hj=="window"?0:cR());var hq=hi.left+(hj=="window"?0:cT());ho.left+=hq;ho.right+=hq}ho.top+=hn;ho.bottom+=hn;return ho}function hd(hi,hl,hj){if(hj=="div"){return hl}var hn=hl.left,hm=hl.top;if(hj=="page"){hn-=cT();hm-=cR()}else{if(hj=="local"||!hj){var hk=hi.display.sizer.getBoundingClientRect();hn+=hk.left;hm+=hk.top}}var i=hi.display.lineSpace.getBoundingClientRect();return{left:hn-i.left,top:hm-i.top}}function da(i,hl,hk,hj,hi){if(!hj){hj=fZ(i.doc,hl.line)}return fy(i,hj,eP(i,hj,hl.ch,hi),hk)}function ep(hs,hq,hj,hn,hu,ho){hn=hn||fZ(hs.doc,hq.line);if(!hu){hu=bg(hs,hn)}function hl(hx,hw){var hv=F(hs,hu,hx,hw?"right":"left",ho);if(hw){hv.left=hv.right}else{hv.right=hv.left}return fy(hs,hn,hv,hj)}var hm=a(hn,hs.doc.direction),i=hq.ch,hr=hq.sticky;if(i>=hn.text.length){i=hn.text.length;hr="before"}else{if(i<=0){i=0;hr="after"}}if(!hm){return hl(hr=="before"?i-1:i,hr=="before")}function ht(hy,hv,hz){var hw=hm[hv],hx=(hw.level%2)!=0;return hl(hz?hy-1:hy,hx!=hz)}var hi=aQ(hm,i,hr);var hp=fN;var hk=ht(i,hi,hr=="before");if(hp!=null){hk.other=ht(i,hp,hr!="before")}return hk}function ea(i,hl){var hk=0;hl=gy(i.doc,hl);if(!i.options.lineWrapping){hk=d6(i.display)*hl.ch}var hi=fZ(i.doc,hl.line);var hj=b5(hi)+fT(i.display);return{left:hk,right:hk,top:hj,bottom:hj+hi.height}}function gV(i,hi,hk,hj,hm){var hl=ac(i,hi,hk);hl.xRel=hm;if(hj){hl.outside=true}return hl}function gF(ho,hl,hk){var hn=ho.doc;hk+=ho.display.viewOffset;if(hk<0){return gV(hn.first,0,null,true,-1)}var hj=bZ(hn,hk),hp=hn.first+hn.size-1;if(hj>hp){return gV(hn.first+hn.size-1,fZ(hn,hp).text.length,null,true,1)}if(hl<0){hl=0}var hi=fZ(hn,hj);for(;;){var hq=dq(ho,hi,hj,hl,hk);var hm=e8(hi);var i=hm&&hm.find(0,true);if(hm&&(hq.ch>i.from.ch||hq.ch==i.from.ch&&hq.xRel>0)){hj=b6(hi=i.to.line)}else{return hq}}}function bB(i,hj,hm,hn){var hl=function(ho){return fy(i,hj,F(i,hm,ho),"line")};var hi=hj.text.length;var hk=cL(function(ho){return hl(ho-1).bottom<=hn},hi,0);hi=cL(function(ho){return hl(ho).top>hn},hk,hi);return{begin:hk,end:hi}}function bz(i,hi,hk,hl){var hj=fy(i,hi,F(i,hk,hl),"line").top;return bB(i,hi,hk,hj)}function dq(hm,hi,hp,ho,hn){hn-=b5(hi);var hD=0,hj=hi.text.length;var ht=bg(hm,hi);var hl;var hz=a(hi,hm.doc.direction);if(hz){if(hm.options.lineWrapping){var hx;((hx=bB(hm,hi,ht,hn),hD=hx.begin,hj=hx.end,hx))}hl=new ac(hp,Math.floor(hD+(hj-hD)/2));var hv=ep(hm,hl,"line",hi,ht).left;var hw=hv<ho?1:-1;var hr,hu=hv-ho,hk;var hC=Math.ceil((hj-hD)/4);outer:do{hr=hu;hk=hl;var hB=0;for(;hB<hC;++hB){var hs=hl;hl=v(hm,hi,hl,hw);if(hl==null||hl.ch<hD||hj<=(hl.sticky=="before"?hl.ch-1:hl.ch)){hl=hs;break outer}}hu=ep(hm,hl,"line",hi,ht).left-ho;if(hC>1){var hy=Math.abs(hu-hr)/hC;hC=Math.min(hC,Math.ceil(Math.abs(hu)/hy));hw=hu<0?1:-1}}while(hu!=0&&(hC>1||((hw<0)!=(hu<0)&&(Math.abs(hu)<=Math.abs(hr)))));if(Math.abs(hu)>Math.abs(hr)){if((hu<0)==(hr<0)){throw new Error("Broke out of infinite loop in coordsCharInner")}hl=hk}}else{var hq=cL(function(i){var hE=fy(hm,hi,F(hm,ht,i),"line");if(hE.top>hn){hj=Math.min(i,hj);return true}else{if(hE.bottom<=hn){return false}else{if(hE.left>ho){return true}else{if(hE.right<ho){return false}else{return(ho-hE.left<hE.right-ho)}}}}},hD,hj);hq=eS(hi.text,hq,1);hl=new ac(hp,hq,hq==hj?"before":"after")}var hA=ep(hm,hl,"line",hi,ht);if(hn<hA.top||hA.bottom<hn){hl.outside=true}hl.xRel=ho<hA.left?-1:(ho>hA.right?1:0);return hl}var aP;function a9(hk){if(hk.cachedTextHeight!=null){return hk.cachedTextHeight}if(aP==null){aP=gX("pre");for(var hj=0;hj<49;++hj){aP.appendChild(document.createTextNode("x"));aP.appendChild(gX("br"))}aP.appendChild(document.createTextNode("x"))}cc(hk.measure,aP);var hi=aP.offsetHeight/50;if(hi>3){hk.cachedTextHeight=hi}ey(hk.measure);return hi||1}function d6(hl){if(hl.cachedCharWidth!=null){return hl.cachedCharWidth}var i=gX("span","xxxxxxxxxx");var hk=gX("pre",[i]);cc(hl.measure,hk);var hj=i.getBoundingClientRect(),hi=(hj.right-hj.left)/10;if(hi>2){hl.cachedCharWidth=hi}return hi||10}function fX(hi){var hn=hi.display,hl={},hk={};var hm=hn.gutters.clientLeft;for(var ho=hn.gutters.firstChild,hj=0;ho;ho=ho.nextSibling,++hj){hl[hi.options.gutters[hj]]=ho.offsetLeft+ho.clientLeft+hm;hk[hi.options.gutters[hj]]=ho.clientWidth}return{fixedPos:et(hn),gutterTotalWidth:hn.gutters.offsetWidth,gutterLeft:hl,gutterWidth:hk,wrapperWidth:hn.wrapper.clientWidth}}function et(i){return i.scroller.getBoundingClientRect().left-i.sizer.getBoundingClientRect().left}function bp(i){var hj=a9(i.display),hi=i.options.lineWrapping;var hk=hi&&Math.max(5,i.display.scroller.clientWidth/d6(i.display)-3);return function(hm){if(gg(i.doc,hm)){return 0}var hl=0;if(hm.widgets){for(var hn=0;hn<hm.widgets.length;hn++){if(hm.widgets[hn].height){hl+=hm.widgets[hn].height}}}if(hi){return hl+(Math.ceil(hm.text.length/hk)||1)*hj}else{return hl+hj}}}function af(i){var hj=i.doc,hi=bp(i);hj.iter(function(hk){var hl=hi(hk);if(hl!=hk.height){g3(hk,hl)}})}function cM(hq,hl,hi,hj){var hm=hq.display;if(!hi&&Q(hl).getAttribute("cm-not-content")=="true"){return null}var hp,hn,i=hm.lineSpace.getBoundingClientRect();try{hp=hl.clientX-i.left;hn=hl.clientY-i.top}catch(hl){return null}var ho=gF(hq,hp,hn),hr;if(hj&&ho.xRel==1&&(hr=fZ(hq.doc,ho.line).text).length==ho.ch){var hk=cb(hr,hr.length,hq.options.tabSize)-hr.length;ho=ac(ho.line,Math.max(0,Math.round((hp-fP(hq.display).left)/d6(hq.display))-hk))}return ho}function dW(hi,hl){if(hl>=hi.display.viewTo){return null}hl-=hi.display.viewFrom;if(hl<0){return null}var hj=hi.display.view;for(var hk=0;hk<hj.length;hk++){hl-=hj[hk].size;if(hl<0){return hk}}}function bU(i){i.display.input.showSelection(i.display.input.prepareSelection())}function gw(hp,hi){var ho=hp.doc,hq={};var hn=hq.cursors=document.createDocumentFragment();var hj=hq.selection=document.createDocumentFragment();for(var hl=0;hl<ho.sel.ranges.length;hl++){if(hi===false&&hl==ho.sel.primIndex){continue}var hm=ho.sel.ranges[hl];if(hm.from().line>=hp.display.viewTo||hm.to().line<hp.display.viewFrom){continue}var hk=hm.empty();if(hk||hp.options.showCursorWhenSelecting){C(hp,hm.head,hn)}if(!hk){bV(hp,hm,hj)}}return hq}function C(i,hk,hj){var hm=ep(i,hk,"div",null,null,!i.options.singleCursorHeightPerLine);var hl=hj.appendChild(gX("div","\u00a0","CodeMirror-cursor"));hl.style.left=hm.left+"px";hl.style.top=hm.top+"px";hl.style.height=Math.max(0,hm.bottom-hm.top)*i.options.cursorHeight+"px";if(hm.other){var hi=hj.appendChild(gX("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));hi.style.display="";hi.style.left=hm.other.left+"px";hi.style.top=hm.other.top+"px";hi.style.height=(hm.other.bottom-hm.other.top)*0.85+"px"}}function bV(hl,hr,hm){var hu=hl.display,hy=hl.doc;var i=document.createDocumentFragment();var hq=fP(hl.display),hk=hq.left;var hv=Math.max(hu.sizerWidth,dQ(hl)-hu.sizer.offsetLeft)-hq.right;function hs(hC,hB,hA,hz){if(hB<0){hB=0}hB=Math.round(hB);hz=Math.round(hz);i.appendChild(gX("div",null,"CodeMirror-selected",("position: absolute; left: "+hC+"px;\n                             top: "+hB+"px; width: "+(hA==null?hv-hC:hA)+"px;\n                             height: "+(hz-hB)+"px")))}function hi(hA,hC,hF){var hB=fZ(hy,hA);var hD=hB.text.length;var hG,hz;function hE(hI,hH){return da(hl,ac(hA,hI),"div",hB,hH)}eB(a(hB,hy.direction),hC||0,hF==null?hD:hF,function(hO,hN,hH){var hK=hE(hO,"left"),hL,hM,hJ;if(hO==hN){hL=hK;hM=hJ=hK.left}else{hL=hE(hN-1,"right");if(hH=="rtl"){var hI=hK;hK=hL;hL=hI}hM=hK.left;hJ=hL.right}if(hC==null&&hO==0){hM=hk}if(hL.top-hK.top>3){hs(hM,hK.top,null,hK.bottom);hM=hk;if(hK.bottom<hL.top){hs(hM,hK.bottom,null,hL.top)}}if(hF==null&&hN==hD){hJ=hv}if(!hG||hK.top<hG.top||hK.top==hG.top&&hK.left<hG.left){hG=hK}if(!hz||hL.bottom>hz.bottom||hL.bottom==hz.bottom&&hL.right>hz.right){hz=hL}if(hM<hk+1){hM=hk}hs(hM,hL.top,hJ-hM,hL.bottom)});return{start:hG,end:hz}}var hx=hr.from(),hw=hr.to();if(hx.line==hw.line){hi(hx.line,hx.ch,hw.ch)}else{var hj=fZ(hy,hx.line),ho=fZ(hy,hw.line);var hn=z(hj)==z(ho);var hp=hi(hx.line,hx.ch,hn?hj.text.length+1:null).end;var ht=hi(hw.line,hn?0:null,hw.ch).start;if(hn){if(hp.top<ht.top-2){hs(hp.right,hp.top,null,hp.bottom);hs(hk,ht.top,ht.left,ht.bottom)}else{hs(hp.right,hp.top,ht.left-hp.right,hp.bottom)}}if(hp.bottom<ht.top){hs(hk,hp.bottom,null,ht.top)}}hm.appendChild(i)}function q(i){if(!i.state.focused){return}var hj=i.display;clearInterval(hj.blinker);var hi=true;hj.cursorDiv.style.visibility="";if(i.options.cursorBlinkRate>0){hj.blinker=setInterval(function(){return hj.cursorDiv.style.visibility=(hi=!hi)?"":"hidden"},i.options.cursorBlinkRate)}else{if(i.options.cursorBlinkRate<0){hj.cursorDiv.style.visibility="hidden"}}}function t(i){if(!i.state.focused){i.display.input.focus();c0(i)}}function at(i){i.state.delayingBlurEvent=true;setTimeout(function(){if(i.state.delayingBlurEvent){i.state.delayingBlurEvent=false;a6(i)}},100)}function c0(i,hi){if(i.state.delayingBlurEvent){i.state.delayingBlurEvent=false}if(i.options.readOnly=="nocursor"){return}if(!i.state.focused){aM(i,"focus",i,hi);i.state.focused=true;gn(i.display.wrapper,"CodeMirror-focused");if(!i.curOp&&i.display.selForContextMenu!=i.doc.sel){i.display.input.reset();if(dr){setTimeout(function(){return i.display.input.reset(true)},20)}}i.display.input.receivedFocus()}q(i)}function a6(i,hi){if(i.state.delayingBlurEvent){return}if(i.state.focused){aM(i,"blur",i,hi);i.state.focused=false;h(i.display.wrapper,"CodeMirror-focused")}clearInterval(i.display.blinker);setTimeout(function(){if(!i.state.focused){i.display.shift=false}},150)}function bk(hp){var hn=hp.display;var hj=hn.lineDiv.offsetTop;for(var hk=0;hk<hn.view.length;hk++){var hq=hn.view[hk],hr=(void 0);if(hq.hidden){continue}if(ed&&m<8){var hm=hq.node.offsetTop+hq.node.offsetHeight;hr=hm-hj;hj=hm}else{var hl=hq.node.getBoundingClientRect();hr=hl.bottom-hl.top}var ho=hq.line.height-hr;if(hr<2){hr=a9(hn)}if(ho>0.001||ho<-0.001){g3(hq.line,hr);cw(hq.line);if(hq.rest){for(var hi=0;hi<hq.rest.length;hi++){cw(hq.rest[hi])}}}}}function cw(hi){if(hi.widgets){for(var hj=0;hj<hi.widgets.length;++hj){hi.widgets[hj].height=hi.widgets[hj].node.parentNode.offsetHeight}}}function cr(hk,ho,hj){var hl=hj&&hj.top!=null?Math.max(0,hj.top):hk.scroller.scrollTop;hl=Math.floor(hl-fT(hk));var i=hj&&hj.bottom!=null?hj.bottom:hl+hk.wrapper.clientHeight;var hm=bZ(ho,hl),hn=bZ(ho,i);if(hj&&hj.ensure){var hi=hj.ensure.from.line,hp=hj.ensure.to.line;if(hi<hm){hm=hi;hn=bZ(ho,b5(fZ(ho,hi))+hk.wrapper.clientHeight)}else{if(Math.min(hp,ho.lastLine())>=hn){hm=bZ(ho,b5(fZ(ho,hp))-hk.wrapper.clientHeight);hn=hp}}}return{from:hm,to:Math.max(hn,hm+1)}}function fj(hq){var ho=hq.display,hp=ho.view;if(!ho.alignWidgets&&(!ho.gutters.firstChild||!hq.options.fixedGutter)){return}var hm=et(ho)-ho.scroller.scrollLeft+hq.doc.scrollLeft;var hi=ho.gutters.offsetWidth,hj=hm+"px";for(var hl=0;hl<hp.length;hl++){if(!hp[hl].hidden){if(hq.options.fixedGutter){if(hp[hl].gutter){hp[hl].gutter.style.left=hj}if(hp[hl].gutterBackground){hp[hl].gutterBackground.style.left=hj}}var hn=hp[hl].alignable;if(hn){for(var hk=0;hk<hn.length;hk++){hn[hk].style.left=hj}}}}if(hq.options.fixedGutter){ho.gutters.style.left=(hm+hi)+"px"}}function eC(i){if(!i.options.lineNumbers){return false}var hm=i.doc,hi=e3(i.options,hm.first+hm.size-1),hl=i.display;if(hi.length!=hl.lineNumChars){var hn=hl.measure.appendChild(gX("div",[gX("div",hi)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var hj=hn.firstChild.offsetWidth,hk=hn.offsetWidth-hj;hl.lineGutter.style.width="";hl.lineNumInnerWidth=Math.max(hj,hl.lineGutter.offsetWidth-hk)+1;hl.lineNumWidth=hl.lineNumInnerWidth+hk;hl.lineNumChars=hl.lineNumInnerWidth?hi.length:-1;hl.lineGutter.style.width=hl.lineNumWidth+"px";dv(i);return true}return false}function eD(hi,hk){if(a2(hi,"scrollCursorIntoView")){return}var hm=hi.display,hj=hm.sizer.getBoundingClientRect(),i=null;if(hk.top+hj.top<0){i=true}else{if(hk.bottom+hj.top>(window.innerHeight||document.documentElement.clientHeight)){i=false}}if(i!=null&&!gd){var hl=gX("div","\u200b",null,("position: absolute;\n                         top: "+(hk.top-hm.viewOffset-fT(hi.display))+"px;\n                         height: "+(hk.bottom-hk.top+dj(hi)+hm.barHeight)+"px;\n                         left: "+(hk.left)+"px; width: "+(Math.max(2,hk.right-hk.left))+"px;"));hi.display.lineSpace.appendChild(hl);hl.scrollIntoView(i);hi.display.lineSpace.removeChild(hl)}}function G(hs,hp,hl,hk){if(hk==null){hk=0}var hq;for(var hm=0;hm<5;hm++){var hn=false;var hr=ep(hs,hp);var i=!hl||hl==hp?hr:ep(hs,hl);hq={left:Math.min(hr.left,i.left),top:Math.min(hr.top,i.top)-hk,right:Math.max(hr.left,i.left),bottom:Math.max(hr.bottom,i.bottom)+hk};var hj=L(hs,hq);var ho=hs.doc.scrollTop,hi=hs.doc.scrollLeft;if(hj.scrollTop!=null){B(hs,hj.scrollTop);if(Math.abs(hs.doc.scrollTop-ho)>1){hn=true}}if(hj.scrollLeft!=null){bW(hs,hj.scrollLeft);if(Math.abs(hs.doc.scrollLeft-hi)>1){hn=true}}if(!hn){break}}return hq}function H(i,hi){var hj=L(i,hi);if(hj.scrollTop!=null){B(i,hj.scrollTop)}if(hj.scrollLeft!=null){bW(i,hj.scrollLeft)}}function L(hq,hp){var hn=hq.display,hl=a9(hq.display);if(hp.top<0){hp.top=0}var hj=hq.curOp&&hq.curOp.scrollTop!=null?hq.curOp.scrollTop:hn.scroller.scrollTop;var hs=dl(hq),hu={};if(hp.bottom-hp.top>hs){hp.bottom=hp.top+hs}var hi=hq.doc.height+b0(hn);var i=hp.top<hl,hm=hp.bottom>hi-hl;if(hp.top<hj){hu.scrollTop=i?0:hp.top}else{if(hp.bottom>hj+hs){var ho=Math.min(hp.top,(hm?hi:hp.bottom)-hs);if(ho!=hj){hu.scrollTop=ho}}}var ht=hq.curOp&&hq.curOp.scrollLeft!=null?hq.curOp.scrollLeft:hn.scroller.scrollLeft;var hr=dQ(hq)-(hq.options.fixedGutter?hn.gutters.offsetWidth:0);var hk=hp.right-hp.left>hr;if(hk){hp.right=hp.left+hr}if(hp.left<10){hu.scrollLeft=0}else{if(hp.left<ht){hu.scrollLeft=Math.max(0,hp.left-(hk?0:10))}else{if(hp.right>hr+ht-3){hu.scrollLeft=hp.right+(hk?0:10)-hr}}}return hu}function c7(i,hi){if(hi==null){return}gp(i);i.curOp.scrollTop=(i.curOp.scrollTop==null?i.doc.scrollTop:i.curOp.scrollTop)+hi}function gs(i){gp(i);var hi=i.getCursor(),hk=hi,hj=hi;if(!i.options.lineWrapping){hk=hi.ch?ac(hi.line,hi.ch-1):hi;hj=ac(hi.line,hi.ch+1)}i.curOp.scrollToPos={from:hk,to:hj,margin:i.options.cursorScrollMargin}}function ft(hi,i,hj){if(i!=null||hj!=null){gp(hi)}if(i!=null){hi.curOp.scrollLeft=i}if(hj!=null){hi.curOp.scrollTop=hj}}function cz(i,hi){gp(i);i.curOp.scrollToPos=hi}function gp(i){var hi=i.curOp.scrollToPos;if(hi){i.curOp.scrollToPos=null;var hk=ea(i,hi.from),hj=ea(i,hi.to);b9(i,hk,hj,hi.margin)}}function b9(i,hl,hk,hj){var hi=L(i,{left:Math.min(hl.left,hk.left),top:Math.min(hl.top,hk.top)-hj,right:Math.max(hl.right,hk.right),bottom:Math.max(hl.bottom,hk.bottom)+hj});ft(i,hi.scrollLeft,hi.scrollTop)}function B(i,hi){if(Math.abs(i.doc.scrollTop-hi)<2){return}if(!cN){eo(i,{top:hi})}T(i,hi,true);if(cN){eo(i)}eM(i,100)}function T(i,hj,hi){hj=Math.min(i.display.scroller.scrollHeight-i.display.scroller.clientHeight,hj);if(i.display.scroller.scrollTop==hj&&!hi){return}i.doc.scrollTop=hj;i.display.scrollbars.setScrollTop(hj);if(i.display.scroller.scrollTop!=hj){i.display.scroller.scrollTop=hj}}function bW(i,hk,hj,hi){hk=Math.min(hk,i.display.scroller.scrollWidth-i.display.scroller.clientWidth);if((hj?hk==i.doc.scrollLeft:Math.abs(i.doc.scrollLeft-hk)<2)&&!hi){return}i.doc.scrollLeft=hk;fj(i);if(i.display.scroller.scrollLeft!=hk){i.display.scroller.scrollLeft=hk}i.display.scrollbars.setScrollLeft(hk)}function d4(i){var hk=i.display,hj=hk.gutters.offsetWidth;var hi=Math.round(i.doc.height+b0(i.display));return{clientHeight:hk.scroller.clientHeight,viewHeight:hk.wrapper.clientHeight,scrollWidth:hk.scroller.scrollWidth,clientWidth:hk.scroller.clientWidth,viewWidth:hk.wrapper.clientWidth,barLeft:i.options.fixedGutter?hj:0,docHeight:hi,scrollHeight:hi+dj(i)+hk.barHeight,nativeBarWidth:hk.nativeBarWidth,gutterWidth:hj}}var dP=function(hj,hi,i){this.cm=i;var hk=this.vert=gX("div",[gX("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var hl=this.horiz=gX("div",[gX("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");hj(hk);hj(hl);ch(hk,"scroll",function(){if(hk.clientHeight){hi(hk.scrollTop,"vertical")}});ch(hl,"scroll",function(){if(hl.clientWidth){hi(hl.scrollLeft,"horizontal")}});this.checkedZeroWidth=false;if(ed&&m<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px"}};dP.prototype.update=function(hk){var hl=hk.scrollWidth>hk.clientWidth+1;var hj=hk.scrollHeight>hk.clientHeight+1;var hm=hk.nativeBarWidth;if(hj){this.vert.style.display="block";this.vert.style.bottom=hl?hm+"px":"0";var hi=hk.viewHeight-(hl?hm:0);this.vert.firstChild.style.height=Math.max(0,hk.scrollHeight-hk.clientHeight+hi)+"px"}else{this.vert.style.display="";this.vert.firstChild.style.height="0"}if(hl){this.horiz.style.display="block";this.horiz.style.right=hj?hm+"px":"0";this.horiz.style.left=hk.barLeft+"px";var i=hk.viewWidth-hk.barLeft-(hj?hm:0);this.horiz.firstChild.style.width=Math.max(0,hk.scrollWidth-hk.clientWidth+i)+"px"}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0"}if(!this.checkedZeroWidth&&hk.clientHeight>0){if(hm==0){this.zeroWidthHack()}this.checkedZeroWidth=true}return{right:hj?hm:0,bottom:hl?hm:0}};dP.prototype.setScrollLeft=function(i){if(this.horiz.scrollLeft!=i){this.horiz.scrollLeft=i}if(this.disableHoriz){this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")}};dP.prototype.setScrollTop=function(i){if(this.vert.scrollTop!=i){this.vert.scrollTop=i}if(this.disableVert){this.enableZeroWidthBar(this.vert,this.disableVert,"vert")}};dP.prototype.zeroWidthHack=function(){var i=cs&&!dz?"12px":"18px";this.horiz.style.height=this.vert.style.width=i;this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none";this.disableHoriz=new hh;this.disableVert=new hh};dP.prototype.enableZeroWidthBar=function(hj,i,hi){hj.style.pointerEvents="auto";function hk(){var hm=hj.getBoundingClientRect();var hl=hi=="vert"?document.elementFromPoint(hm.right-1,(hm.top+hm.bottom)/2):document.elementFromPoint((hm.right+hm.left)/2,hm.bottom-1);if(hl!=hj){hj.style.pointerEvents="none"}else{i.set(1000,hk)}}i.set(1000,hk)};dP.prototype.clear=function(){var i=this.horiz.parentNode;i.removeChild(this.horiz);i.removeChild(this.vert)};var fO=function(){};fO.prototype.update=function(){return{bottom:0,right:0}};fO.prototype.setScrollLeft=function(){};fO.prototype.setScrollTop=function(){};fO.prototype.clear=function(){};function fI(hk,hm){if(!hm){hm=d4(hk)}var hj=hk.display.barWidth,hi=hk.display.barHeight;a5(hk,hm);for(var hl=0;hl<4&&hj!=hk.display.barWidth||hi!=hk.display.barHeight;hl++){if(hj!=hk.display.barWidth&&hk.options.lineWrapping){bk(hk)}a5(hk,d4(hk));hj=hk.display.barWidth;hi=hk.display.barHeight}}function a5(i,hi){var hk=i.display;var hj=hk.scrollbars.update(hi);hk.sizer.style.paddingRight=(hk.barWidth=hj.right)+"px";hk.sizer.style.paddingBottom=(hk.barHeight=hj.bottom)+"px";hk.heightForcer.style.borderBottom=hj.bottom+"px solid transparent";if(hj.right&&hj.bottom){hk.scrollbarFiller.style.display="block";hk.scrollbarFiller.style.height=hj.bottom+"px";hk.scrollbarFiller.style.width=hj.right+"px"}else{hk.scrollbarFiller.style.display=""}if(hj.bottom&&i.options.coverGutterNextToScrollbar&&i.options.fixedGutter){hk.gutterFiller.style.display="block";hk.gutterFiller.style.height=hj.bottom+"px";hk.gutterFiller.style.width=hi.gutterWidth+"px"}else{hk.gutterFiller.style.display=""}}var by={"native":dP,"null":fO};function aL(i){if(i.display.scrollbars){i.display.scrollbars.clear();if(i.display.scrollbars.addClass){h(i.display.wrapper,i.display.scrollbars.addClass)}}i.display.scrollbars=new by[i.options.scrollbarStyle](function(hi){i.display.wrapper.insertBefore(hi,i.display.scrollbarFiller);ch(hi,"mousedown",function(){if(i.state.focused){setTimeout(function(){return i.display.input.focus()},0)}});hi.setAttribute("cm-not-content","true")},function(hj,hi){if(hi=="horizontal"){bW(i,hj)}else{B(i,hj)}},i);if(i.display.scrollbars.addClass){gn(i.display.wrapper,i.display.scrollbars.addClass)}}var eH=0;function c9(i){i.curOp={cm:i,viewChanged:false,startHeight:i.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:false,id:++eH};fb(i.curOp)}function av(i){var hi=i.curOp;ci(hi,function(hk){for(var hj=0;hj<hk.ops.length;hj++){hk.ops[hj].cm.curOp=null}dc(hk)})}function dc(hn){var hj=hn.ops;for(var hi=0;hi<hj.length;hi++){cq(hj[hi])}for(var ho=0;ho<hj.length;ho++){ay(hj[ho])}for(var hm=0;hm<hj.length;hm++){cm(hj[hm])}for(var hl=0;hl<hj.length;hl++){ax(hj[hl])}for(var hk=0;hk<hj.length;hk++){fK(hj[hk])}}function cq(hj){var i=hj.cm,hi=i.display;N(i);if(hj.updateMaxLine){f(i)}hj.mustUpdate=hj.viewChanged||hj.forceUpdate||hj.scrollTop!=null||hj.scrollToPos&&(hj.scrollToPos.from.line<hi.viewFrom||hj.scrollToPos.to.line>=hi.viewTo)||hi.maxLineChanged&&i.options.lineWrapping;hj.update=hj.mustUpdate&&new aS(i,hj.mustUpdate&&{top:hj.scrollTop,ensure:hj.scrollToPos},hj.forceUpdate)}function ay(i){i.updatedDisplay=i.mustUpdate&&E(i.cm,i.update)}function cm(hj){var i=hj.cm,hi=i.display;if(hj.updatedDisplay){bk(i)}hj.barMeasure=d4(i);if(hi.maxLineChanged&&!i.options.lineWrapping){hj.adjustWidthTo=eP(i,hi.maxLine,hi.maxLine.text.length).left+3;i.display.sizerWidth=hj.adjustWidthTo;hj.barMeasure.scrollWidth=Math.max(hi.scroller.clientWidth,hi.sizer.offsetLeft+hj.adjustWidthTo+dj(i)+i.display.barWidth);hj.maxScrollLeft=Math.max(0,hi.sizer.offsetLeft+hj.adjustWidthTo-dQ(i))}if(hj.updatedDisplay||hj.selectionChanged){hj.preparedSelection=hi.input.prepareSelection(hj.focus)}}function ax(hj){var i=hj.cm;if(hj.adjustWidthTo!=null){i.display.sizer.style.minWidth=hj.adjustWidthTo+"px";if(hj.maxScrollLeft<i.doc.scrollLeft){bW(i,Math.min(i.display.scroller.scrollLeft,hj.maxScrollLeft),true)}i.display.maxLineChanged=false}var hi=hj.focus&&hj.focus==eh()&&(!document.hasFocus||document.hasFocus());if(hj.preparedSelection){i.display.input.showSelection(hj.preparedSelection,hi)}if(hj.updatedDisplay||hj.startHeight!=i.doc.height){fI(i,hj.barMeasure)}if(hj.updatedDisplay){d3(i,hj.barMeasure)}if(hj.selectionChanged){q(i)}if(i.state.focused&&hj.updateInput){i.display.input.reset(hj.typing)}if(hi){t(hj.cm)}}function fK(hl){var hq=hl.cm,hn=hq.display,hp=hq.doc;if(hl.updatedDisplay){cG(hq,hl.update)}if(hn.wheelStartX!=null&&(hl.scrollTop!=null||hl.scrollLeft!=null||hl.scrollToPos)){hn.wheelStartX=hn.wheelStartY=null}if(hl.scrollTop!=null){T(hq,hl.scrollTop,hl.forceScroll)}if(hl.scrollLeft!=null){bW(hq,hl.scrollLeft,true,true)}if(hl.scrollToPos){var ho=G(hq,gy(hp,hl.scrollToPos.from),gy(hp,hl.scrollToPos.to),hl.scrollToPos.margin);eD(hq,ho)}var hm=hl.maybeHiddenMarkers,hi=hl.maybeUnhiddenMarkers;if(hm){for(var hk=0;hk<hm.length;++hk){if(!hm[hk].lines.length){aM(hm[hk],"hide")}}}if(hi){for(var hj=0;hj<hi.length;++hj){if(hi[hj].lines.length){aM(hi[hj],"unhide")}}}if(hn.wrapper.offsetHeight){hp.scrollTop=hq.display.scroller.scrollTop}if(hl.changeObjs){aM(hq,"changes",hq,hl.changeObjs)}if(hl.update){hl.update.finish()}}function dd(i,hi){if(i.curOp){return hi()}c9(i);try{return hi()}finally{av(i)}}function ds(i,hi){return function(){if(i.curOp){return hi.apply(i,arguments)}c9(i);try{return hi.apply(i,arguments)}finally{av(i)}}}function dC(i){return function(){if(this.curOp){return i.apply(this,arguments)}c9(this);try{return i.apply(this,arguments)}finally{av(this)}}}function c3(i){return function(){var hi=this.cm;if(!hi||hi.curOp){return i.apply(this,arguments)}c9(hi);try{return i.apply(this,arguments)}finally{av(hi)}}}function ap(hp,hn,ho,hq){if(hn==null){hn=hp.doc.first}if(ho==null){ho=hp.doc.first+hp.doc.size}if(!hq){hq=0}var hk=hp.display;if(hq&&ho<hk.viewTo&&(hk.updateLineNumbers==null||hk.updateLineNumbers>hn)){hk.updateLineNumbers=hn}hp.curOp.viewChanged=true;if(hn>=hk.viewTo){if(bi&&a7(hp.doc,hn)<hk.viewTo){e9(hp)}}else{if(ho<=hk.viewFrom){if(bi&&eA(hp.doc,ho+hq)>hk.viewFrom){e9(hp)}else{hk.viewFrom+=hq;hk.viewTo+=hq}}else{if(hn<=hk.viewFrom&&ho>=hk.viewTo){e9(hp)}else{if(hn<=hk.viewFrom){var hm=dJ(hp,ho,ho+hq,1);if(hm){hk.view=hk.view.slice(hm.index);hk.viewFrom=hm.lineN;hk.viewTo+=hq}else{e9(hp)}}else{if(ho>=hk.viewTo){var hi=dJ(hp,hn,hn,-1);if(hi){hk.view=hk.view.slice(0,hi.index);hk.viewTo=hi.lineN}else{e9(hp)}}else{var hl=dJ(hp,hn,hn,-1);var hj=dJ(hp,ho,ho+hq,1);if(hl&&hj){hk.view=hk.view.slice(0,hl.index).concat(fE(hp,hl.lineN,hj.lineN)).concat(hk.view.slice(hj.index));hk.viewTo+=hq}else{e9(hp)}}}}}}var i=hk.externalMeasured;if(i){if(ho<i.lineN){i.lineN+=hq}else{if(hn<i.lineN+i.size){hk.externalMeasured=null}}}}function W(hi,hj,hm){hi.curOp.viewChanged=true;var hn=hi.display,hl=hi.display.externalMeasured;if(hl&&hj>=hl.lineN&&hj<hl.lineN+hl.size){hn.externalMeasured=null}if(hj<hn.viewFrom||hj>=hn.viewTo){return}var hk=hn.view[dW(hi,hj)];if(hk.node==null){return}var i=hk.changes||(hk.changes=[]);if(dN(i,hm)==-1){i.push(hm)}}function e9(i){i.display.viewFrom=i.display.viewTo=i.doc.first;i.display.view=[];i.display.viewOffset=0}function dJ(hq,hk,hm,hj){var hn=dW(hq,hk),hp,ho=hq.display.view;if(!bi||hm==hq.doc.first+hq.doc.size){return{index:hn,lineN:hm}}var hi=hq.display.viewFrom;for(var hl=0;hl<hn;hl++){hi+=ho[hl].size}if(hi!=hk){if(hj>0){if(hn==ho.length-1){return null}hp=(hi+ho[hn].size)-hk;hn++}else{hp=hi-hk}hk+=hp;hm+=hp}while(a7(hq.doc,hm)!=hm){if(hn==(hj<0?0:ho.length-1)){return null}hm+=hj*ho[hn-(hj<0?1:0)].size;hn+=hj}return{index:hn,lineN:hm}}function di(i,hl,hk){var hj=i.display,hi=hj.view;if(hi.length==0||hl>=hj.viewTo||hk<=hj.viewFrom){hj.view=fE(i,hl,hk);hj.viewFrom=hl}else{if(hj.viewFrom>hl){hj.view=fE(i,hl,hj.viewFrom).concat(hj.view)}else{if(hj.viewFrom<hl){hj.view=hj.view.slice(dW(i,hl))}}hj.viewFrom=hl;if(hj.viewTo<hk){hj.view=hj.view.concat(fE(i,hj.viewTo,hk))}else{if(hj.viewTo>hk){hj.view=hj.view.slice(0,dW(i,hk))}}}hj.viewTo=hk}function dG(hi){var hj=hi.display.view,hm=0;for(var hl=0;hl<hj.length;hl++){var hk=hj[hl];if(!hk.hidden&&(!hk.node||hk.changes)){++hm}}return hm}function eM(i,hi){if(i.doc.highlightFrontier<i.display.viewTo){i.state.highlight.set(hi,cU(dh,i))}}function dh(i){var hl=i.doc;if(hl.highlightFrontier>=i.display.viewTo){return}var hj=+new Date+i.options.workTime;var hk=fG(i,hl.highlightFrontier);var hi=[];hl.iter(hk.line,Math.min(hl.first+hl.size,i.display.viewTo+500),function(hn){if(hk.line>=i.display.viewFrom){var hq=hn.styles;var hm=hn.text.length>i.options.maxHighlightLength?co(hl.mode,hk.state):null;var hs=gk(i,hn,hk,true);if(hm){hk.state=hm}hn.styles=hs.styles;var hp=hn.styleClasses,hr=hs.classes;if(hr){hn.styleClasses=hr}else{if(hp){hn.styleClasses=null}}var ht=!hq||hq.length!=hn.styles.length||hp!=hr&&(!hp||!hr||hp.bgClass!=hr.bgClass||hp.textClass!=hr.textClass);for(var ho=0;!ht&&ho<hq.length;++ho){ht=hq[ho]!=hn.styles[ho]}if(ht){hi.push(hk.line)}hn.stateAfter=hk.save();hk.nextLine()}else{if(hn.text.length<=i.options.maxHighlightLength){d2(i,hn.text,hk)}hn.stateAfter=hk.line%5==0?hk.save():null;hk.nextLine()}if(+new Date>hj){eM(i,i.options.workDelay);return true}});hl.highlightFrontier=hk.line;hl.modeFrontier=Math.max(hl.modeFrontier,hk.line);if(hi.length){dd(i,function(){for(var hm=0;hm<hi.length;hm++){W(i,hi[hm],"text")}})}}var aS=function(hi,i,hj){var hk=hi.display;this.viewport=i;this.visible=cr(hk,hi.doc,i);this.editorIsHidden=!hk.wrapper.offsetWidth;this.wrapperHeight=hk.wrapper.clientHeight;this.wrapperWidth=hk.wrapper.clientWidth;this.oldDisplayWidth=dQ(hi);this.force=hj;this.dims=fX(hi);this.events=[]};aS.prototype.signal=function(hi,i){if(f4(hi,i)){this.events.push(arguments)}};aS.prototype.finish=function(){var hj=this;for(var hi=0;hi<this.events.length;hi++){aM.apply(null,hj.events[hi])}};function N(i){var hi=i.display;if(!hi.scrollbarsClipped&&hi.scroller.offsetWidth){hi.nativeBarWidth=hi.scroller.offsetWidth-hi.scroller.clientWidth;hi.heightForcer.style.height=dj(i)+"px";hi.sizer.style.marginBottom=-hi.nativeBarWidth+"px";hi.sizer.style.borderRightWidth=dj(i)+"px";hi.scrollbarsClipped=true}}function bA(hi){if(hi.hasFocus()){return null}var hk=eh();if(!hk||!g8(hi.display.lineDiv,hk)){return null}var i={activeElt:hk};if(window.getSelection){var hj=window.getSelection();if(hj.anchorNode&&hj.extend&&g8(hi.display.lineDiv,hj.anchorNode)){i.anchorNode=hj.anchorNode;i.anchorOffset=hj.anchorOffset;i.focusNode=hj.focusNode;i.focusOffset=hj.focusOffset}}return i}function j(hi){if(!hi||!hi.activeElt||hi.activeElt==eh()){return}hi.activeElt.focus();if(hi.anchorNode&&g8(document.body,hi.anchorNode)&&g8(document.body,hi.focusNode)){var hj=window.getSelection(),i=document.createRange();i.setEnd(hi.anchorNode,hi.anchorOffset);i.collapse(false);hj.removeAllRanges();hj.addRange(i);hj.extend(hi.focusNode,hi.focusOffset)}}function E(hq,hk){var hl=hq.display,hp=hq.doc;if(hk.editorIsHidden){e9(hq);return false}if(!hk.force&&hk.visible.from>=hl.viewFrom&&hk.visible.to<=hl.viewTo&&(hl.updateLineNumbers==null||hl.updateLineNumbers>=hl.viewTo)&&hl.renderedView==hl.view&&dG(hq)==0){return false}if(eC(hq)){e9(hq);hk.dims=fX(hq)}var hj=hp.first+hp.size;var hn=Math.max(hk.visible.from-hq.options.viewportMargin,hp.first);var ho=Math.min(hj,hk.visible.to+hq.options.viewportMargin);if(hl.viewFrom<hn&&hn-hl.viewFrom<20){hn=Math.max(hp.first,hl.viewFrom)}if(hl.viewTo>ho&&hl.viewTo-ho<20){ho=Math.min(hj,hl.viewTo)}if(bi){hn=a7(hq.doc,hn);ho=eA(hq.doc,ho)}var hi=hn!=hl.viewFrom||ho!=hl.viewTo||hl.lastWrapHeight!=hk.wrapperHeight||hl.lastWrapWidth!=hk.wrapperWidth;di(hq,hn,ho);hl.viewOffset=b5(fZ(hq.doc,hl.viewFrom));hq.display.mover.style.top=hl.viewOffset+"px";var i=dG(hq);if(!hi&&i==0&&!hk.force&&hl.renderedView==hl.view&&(hl.updateLineNumbers==null||hl.updateLineNumbers>=hl.viewTo)){return false}var hm=bA(hq);if(i>4){hl.lineDiv.style.display="none"}cJ(hq,hl.updateLineNumbers,hk.dims);if(i>4){hl.lineDiv.style.display=""}hl.renderedView=hl.view;j(hm);ey(hl.cursorDiv);ey(hl.selectionDiv);hl.gutters.style.height=hl.sizer.style.minHeight=0;if(hi){hl.lastWrapHeight=hk.wrapperHeight;hl.lastWrapWidth=hk.wrapperWidth;eM(hq,400)}hl.updateLineNumbers=null;return true}function cG(hi,hl){var i=hl.viewport;for(var hk=true;;hk=false){if(!hk||!hi.options.lineWrapping||hl.oldDisplayWidth==dQ(hi)){if(i&&i.top!=null){i={top:Math.min(hi.doc.height+b0(hi.display)-dl(hi),i.top)}}hl.visible=cr(hi.display,hi.doc,i);if(hl.visible.from>=hi.display.viewFrom&&hl.visible.to<=hi.display.viewTo){break}}if(!E(hi,hl)){break}bk(hi);var hj=d4(hi);bU(hi);fI(hi,hj);d3(hi,hj);hl.force=false}hl.signal(hi,"update",hi);if(hi.display.viewFrom!=hi.display.reportedViewFrom||hi.display.viewTo!=hi.display.reportedViewTo){hl.signal(hi,"viewportChange",hi,hi.display.viewFrom,hi.display.viewTo);hi.display.reportedViewFrom=hi.display.viewFrom;hi.display.reportedViewTo=hi.display.viewTo}}function eo(hi,i){var hk=new aS(hi,i);if(E(hi,hk)){bk(hi);cG(hi,hk);var hj=d4(hi);bU(hi);fI(hi,hj);d3(hi,hj);hk.finish()}}function cJ(ht,hk,hs){var hp=ht.display,hv=ht.options.lineNumbers;var hi=hp.lineDiv,hu=hi.firstChild;function ho(hw){var i=hw.nextSibling;if(dr&&cs&&ht.display.currentWheelTarget==hw){hw.style.display="none"}else{hw.parentNode.removeChild(hw)}return i}var hq=hp.view,hn=hp.viewFrom;for(var hl=0;hl<hq.length;hl++){var hm=hq[hl];if(hm.hidden){}else{if(!hm.node||hm.node.parentNode!=hi){var hj=aN(ht,hm,hn,hs);hi.insertBefore(hj,hu)}else{while(hu!=hm.node){hu=ho(hu)}var hr=hv&&hk!=null&&hk<=hn&&hm.lineNumber;if(hm.changes){if(dN(hm.changes,"gutter")>-1){hr=false}aj(ht,hm,hn,hs)}if(hr){ey(hm.lineNumber);hm.lineNumber.appendChild(document.createTextNode(e3(ht.options,hn)))}hu=hm.node.nextSibling}}hn+=hm.size}while(hu){hu=ho(hu)}}function dv(i){var hi=i.display.gutters.offsetWidth;i.display.sizer.style.marginLeft=hi+"px"}function d3(i,hi){i.display.sizer.style.minHeight=hi.docHeight+"px";i.display.heightForcer.style.top=hi.docHeight+"px";i.display.gutters.style.height=(hi.docHeight+i.display.barHeight+dj(i))+"px"}function eK(hi){var hj=hi.display.gutters,hn=hi.options.gutters;ey(hj);var hk=0;for(;hk<hn.length;++hk){var hl=hn[hk];var hm=hj.appendChild(gX("div",null,"CodeMirror-gutter "+hl));if(hl=="CodeMirror-linenumbers"){hi.display.lineGutter=hm;hm.style.width=(hi.display.lineNumWidth||1)+"px"}}hj.style.display=hk?"":"none";dv(hi)}function cB(i){var hi=dN(i.gutters,"CodeMirror-linenumbers");if(hi==-1&&i.lineNumbers){i.gutters=i.gutters.concat(["CodeMirror-linenumbers"])}else{if(hi>-1&&!i.lineNumbers){i.gutters=i.gutters.slice(0);i.gutters.splice(hi,1)}}}var f6=0;var cD=null;if(ed){cD=-0.53}else{if(cN){cD=15}else{if(dH){cD=-0.7}else{if(aK){cD=-1/3}}}}function dg(hj){var hi=hj.wheelDeltaX,i=hj.wheelDeltaY;if(hi==null&&hj.detail&&hj.axis==hj.HORIZONTAL_AXIS){hi=hj.detail}if(i==null&&hj.detail&&hj.axis==hj.VERTICAL_AXIS){i=hj.detail}else{if(i==null){i=hj.wheelDelta}}return{x:hi,y:i}}function aH(i){var hi=dg(i);hi.x*=cD;hi.y*=cD;return hi}function c(hs,hm){var hu=dg(hm),hw=hu.x,hv=hu.y;var ho=hs.display,hr=ho.scroller;var hl=hr.scrollWidth>hr.clientWidth;var hk=hr.scrollHeight>hr.clientHeight;if(!(hw&&hl||hv&&hk)){return}if(hv&&cs&&dr){outer:for(var ht=hm.target,hq=ho.view;ht!=hr;ht=ht.parentNode){for(var hj=0;hj<hq.length;hj++){if(hq[hj].node==ht){hs.display.currentWheelTarget=ht;break outer}}}}if(hw&&!cN&&!ez&&cD!=null){if(hv&&hk){B(hs,Math.max(0,hr.scrollTop+hv*cD))}bW(hs,Math.max(0,hr.scrollLeft+hw*cD));if(!hv||(hv&&hk)){c5(hm)}ho.wheelStartX=null;return}if(hv&&cD!=null){var hi=hv*cD;var hp=hs.doc.scrollTop,hn=hp+ho.wrapper.clientHeight;if(hi<0){hp=Math.max(0,hp+hi-50)}else{hn=Math.min(hs.doc.height,hn+hi+50)}eo(hs,{top:hp,bottom:hn})}if(f6<20){if(ho.wheelStartX==null){ho.wheelStartX=hr.scrollLeft;ho.wheelStartY=hr.scrollTop;ho.wheelDX=hw;ho.wheelDY=hv;setTimeout(function(){if(ho.wheelStartX==null){return}var i=hr.scrollLeft-ho.wheelStartX;var hy=hr.scrollTop-ho.wheelStartY;var hx=(hy&&ho.wheelDY&&hy/ho.wheelDY)||(i&&ho.wheelDX&&i/ho.wheelDX);ho.wheelStartX=ho.wheelStartY=null;if(!hx){return}cD=(cD*f6+hx)/(f6+1);++f6},200)}else{ho.wheelDX+=hw;ho.wheelDY+=hv}}}var gW=function(i,hi){this.ranges=i;this.primIndex=hi};gW.prototype.primary=function(){return this.ranges[this.primIndex]};gW.prototype.equals=function(hi){var hm=this;if(hi==this){return true}if(hi.primIndex!=this.primIndex||hi.ranges.length!=this.ranges.length){return false}for(var hk=0;hk<this.ranges.length;hk++){var hj=hm.ranges[hk],hl=hi.ranges[hk];if(!ad(hj.anchor,hl.anchor)||!ad(hj.head,hl.head)){return false}}return true};gW.prototype.deepCopy=function(){var hk=this;var hi=[];for(var hj=0;hj<this.ranges.length;hj++){hi[hj]=new es(cF(hk.ranges[hj].anchor),cF(hk.ranges[hj].head))}return new gW(hi,this.primIndex)};gW.prototype.somethingSelected=function(){var hj=this;for(var hi=0;hi<this.ranges.length;hi++){if(!hj.ranges[hi].empty()){return true}}return false};gW.prototype.contains=function(hm,hi){var hl=this;if(!hi){hi=hm}for(var hk=0;hk<this.ranges.length;hk++){var hj=hl.ranges[hk];if(cC(hi,hj.from())>=0&&cC(hm,hj.to())<=0){return hk}}return -1};var es=function(i,hi){this.anchor=i;this.head=hi};es.prototype.from=function(){return az(this.anchor,this.head)};es.prototype.to=function(){return bP(this.anchor,this.head)};es.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function cV(hi,hp){var hk=hi[hp];hi.sort(function(hr,i){return cC(hr.from(),i.from())});hp=dN(hi,hk);for(var hm=1;hm<hi.length;hm++){var hq=hi[hm],hj=hi[hm-1];if(cC(hj.to(),hq.from())>=0){var hn=az(hj.from(),hq.from()),ho=bP(hj.to(),hq.to());var hl=hj.empty()?hq.from()==hq.head:hj.from()==hj.head;if(hm<=hp){--hp}hi.splice(--hm,2,new es(hl?ho:hn,hl?hn:ho))}}return new gW(hi,hp)}function fz(i,hi){return new gW([new es(i,hi||i)],0)}function dn(i){if(!i.text){return i.to}return ac(i.from.line+i.text.length-1,gt(i.text).length+(i.text.length==1?i.from.ch:0))}function ck(hk,hj){if(cC(hk,hj.from)<0){return hk}if(cC(hk,hj.to)<=0){return dn(hj)}var i=hk.line+hj.text.length-(hj.to.line-hj.from.line)-1,hi=hk.ch;if(hk.line==hj.to.line){hi+=dn(hj).ch-hj.to.ch}return ac(i,hi)}function f3(hl,hm){var hj=[];for(var hk=0;hk<hl.sel.ranges.length;hk++){var hi=hl.sel.ranges[hk];hj.push(new es(ck(hi.anchor,hm),ck(hi.head,hm)))}return cV(hj,hl.sel.primIndex)}function bL(hj,hi,i){if(hj.line==hi.line){return ac(i.line,hj.ch-hi.ch+i.ch)}else{return ac(i.line+(hj.line-hi.line),hj.ch)}}function an(hs,hp,hj){var hk=[];var hi=ac(hs.first,0),ht=hi;for(var hm=0;hm<hp.length;hm++){var ho=hp[hm];var hr=bL(ho.from,hi,ht);var hq=bL(dn(ho),hi,ht);hi=ho.to;ht=hq;if(hj=="around"){var hn=hs.sel.ranges[hm],hl=cC(hn.head,hn.anchor)<0;hk[hm]=new es(hl?hq:hr,hl?hr:hq)}else{hk[hm]=new es(hr,hr)}}return new gW(hk,hs.sel.primIndex)}function bI(i){i.doc.mode=gm(i.options,i.doc.modeOption);eV(i)}function eV(i){i.doc.iter(function(hi){if(hi.stateAfter){hi.stateAfter=null}if(hi.styles){hi.styles=null}});i.doc.modeFrontier=i.doc.highlightFrontier=i.doc.first;eM(i,100);i.state.modeGen++;if(i.curOp){ap(i)}}function em(i,hi){return hi.from.ch==0&&hi.to.ch==0&&gt(hi.text)==""&&(!i.cm||i.cm.options.wholeLineUpdateBefore)}function gj(hy,hr,hl,hp){function hk(hz){return hl?hl[hz]:null}function hq(hz,hB,hA){eX(hz,hB,hA,hp);am(hz,"change",hz,hr)}function hv(hC,hA){var hz=[];for(var hB=hC;hB<hA;++hB){hz.push(new g2(ht[hB],hk(hB),hp))}return hz}var hw=hr.from,hi=hr.to,ht=hr.text;var hs=fZ(hy,hw.line),i=fZ(hy,hi.line);var hj=gt(ht),hx=hk(ht.length-1),hu=hi.line-hw.line;if(hr.full){hy.insert(0,hv(0,ht.length));hy.remove(ht.length,hy.size-ht.length)}else{if(em(hy,hr)){var ho=hv(0,ht.length-1);hq(i,i.text,hx);if(hu){hy.remove(hw.line,hu)}if(ho.length){hy.insert(hw.line,ho)}}else{if(hs==i){if(ht.length==1){hq(hs,hs.text.slice(0,hw.ch)+hj+hs.text.slice(hi.ch),hx)}else{var hn=hv(1,ht.length-1);hn.push(new g2(hj+hs.text.slice(hi.ch),hx,hp));hq(hs,hs.text.slice(0,hw.ch)+ht[0],hk(0));hy.insert(hw.line+1,hn)}}else{if(ht.length==1){hq(hs,hs.text.slice(0,hw.ch)+ht[0]+i.text.slice(hi.ch),hk(0));hy.remove(hw.line+1,hu)}else{hq(hs,hs.text.slice(0,hw.ch)+ht[0],hk(0));hq(i,hj+i.text.slice(hi.ch),hx);var hm=hv(1,ht.length-1);if(hu>1){hy.remove(hw.line+1,hu-1)}hy.insert(hw.line+1,hm)}}}}am(hy,"change",hy,hr)}function eE(hk,hj,hi){function i(hq,ho,hm){if(hq.linked){for(var hn=0;hn<hq.linked.length;++hn){var hl=hq.linked[hn];if(hl.doc==ho){continue}var hp=hm&&hl.sharedHist;if(hi&&!hp){continue}hj(hl.doc,hp);i(hl.doc,hq,hp)}}}i(hk,null,true)}function eJ(i,hi){if(hi.cm){throw new Error("This document is already in use.")}i.doc=hi;hi.cm=i;af(i);bI(i);D(i);if(!i.options.lineWrapping){f(i)}i.options.mode=hi.modeOption;ap(i)}function D(i){(i.doc.direction=="rtl"?gn:h)(i.display.lineDiv,"CodeMirror-rtl")}function ev(i){dd(i,function(){D(i);ap(i)})}function gL(i){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=i||1}function d0(i,hj){var hi={from:cF(hj.from),to:dn(hj),text:g0(i,hj.from,hj.to)};cj(i,hi,hj.from.line,hj.to.line+1);eE(i,function(hk){return cj(hk,hi,hj.from.line,hj.to.line+1)},true);return hi}function go(hi){while(hi.length){var i=gt(hi);if(i.ranges){hi.pop()}else{break}}}function fu(hi,i){if(i){go(hi.done);return gt(hi.done)}else{if(hi.done.length&&!gt(hi.done).ranges){return gt(hi.done)}else{if(hi.done.length>1&&!hi.done[hi.done.length-2].ranges){hi.done.pop();return gt(hi.done)}}}}function gA(hn,hl,i,hk){var hj=hn.history;hj.undone.length=0;var hi=+new Date,ho;var hp;if((hj.lastOp==hk||hj.lastOrigin==hl.origin&&hl.origin&&((hl.origin.charAt(0)=="+"&&hn.cm&&hj.lastModTime>hi-hn.cm.options.historyEventDelay)||hl.origin.charAt(0)=="*"))&&(ho=fu(hj,hj.lastOp==hk))){hp=gt(ho.changes);if(cC(hl.from,hl.to)==0&&cC(hl.from,hp.to)==0){hp.to=dn(hl)}else{ho.changes.push(d0(hn,hl))}}else{var hm=gt(hj.done);if(!hm||!hm.ranges){df(hn.sel,hj.done)}ho={changes:[d0(hn,hl)],generation:hj.generation};hj.done.push(ho);while(hj.done.length>hj.undoDepth){hj.done.shift();if(!hj.done[0].ranges){hj.done.shift()}}}hj.done.push(i);hj.generation=++hj.maxGeneration;hj.lastModTime=hj.lastSelTime=hi;hj.lastOp=hj.lastSelOp=hk;hj.lastOrigin=hj.lastSelOrigin=hl.origin;if(!hp){aM(hn,"historyAdded")}}function bS(hl,i,hj,hk){var hi=i.charAt(0);return hi=="*"||hi=="+"&&hj.ranges.length==hk.ranges.length&&hj.somethingSelected()==hk.somethingSelected()&&new Date-hl.history.lastSelTime<=(hl.cm?hl.cm.options.historyEventDelay:500)}function ha(hm,hk,i,hj){var hl=hm.history,hi=hj&&hj.origin;if(i==hl.lastSelOp||(hi&&hl.lastSelOrigin==hi&&(hl.lastModTime==hl.lastSelTime&&hl.lastOrigin==hi||bS(hm,hi,gt(hl.done),hk)))){hl.done[hl.done.length-1]=hk}else{df(hk,hl.done)}hl.lastSelTime=+new Date;hl.lastSelOrigin=hi;hl.lastSelOp=i;if(hj&&hj.clearRedo!==false){go(hl.undone)}}function df(hi,i){var hj=gt(i);if(!(hj&&hj.ranges&&hj.equals(hi))){i.push(hi)}}function cj(hi,hm,hl,hk){var i=hm["spans_"+hi.id],hj=0;hi.iter(Math.max(hi.first,hl),Math.min(hi.first+hi.size,hk),function(hn){if(hn.markedSpans){(i||(i=hm["spans_"+hi.id]={}))[hj]=hn.markedSpans}++hj})}function bw(hk){if(!hk){return null}var hi;for(var hj=0;hj<hk.length;++hj){if(hk[hj].marker.explicitlyCleared){if(!hi){hi=hk.slice(0,hj)}}else{if(hi){hi.push(hk[hj])}}}return !hi?hk:hi.length?hi:null}function cp(hl,hm){var hk=hm["spans_"+hl.id];if(!hk){return null}var hi=[];for(var hj=0;hj<hm.text.length;++hj){hi.push(bw(hk[hj]))}return hi}function eG(hq,ho){var hi=cp(hq,ho);var hr=eT(hq,ho);if(!hi){return hr}if(!hr){return hi}for(var hl=0;hl<hi.length;++hl){var hm=hi[hl],hn=hr[hl];if(hm&&hn){spans:for(var hk=0;hk<hn.length;++hk){var hp=hn[hk];for(var hj=0;hj<hm.length;++hj){if(hm[hj].marker==hp.marker){continue spans}}hm.push(hp)}}else{if(hn){hi[hl]=hn}}}return hi}function b8(ht,hl,hs){var hj=[];for(var ho=0;ho<ht.length;++ho){var hk=ht[ho];if(hk.ranges){hj.push(hs?gW.prototype.deepCopy.call(hk):hk);continue}var hq=hk.changes,hr=[];hj.push({changes:hr});for(var hn=0;hn<hq.length;++hn){var hp=hq[hn],hm=(void 0);hr.push({from:hp.from,to:hp.to,text:hp.text});if(hl){for(var hi in hp){if(hm=hi.match(/^spans_(\d+)$/)){if(dN(hl,Number(hm[1]))>-1){gt(hr)[hi]=hp[hi];delete hp[hi]}}}}}}return hj}function ge(hi,hl,i,hm){if(hm){var hk=hi.anchor;if(i){var hj=cC(hl,hk)<0;if(hj!=(cC(i,hk)<0)){hk=hl;hl=i}else{if(hj!=(cC(hl,i)<0)){hl=i}}}return new es(hk,hl)}else{return new es(i||hl,hl)}}function gQ(hk,hj,i,hi,hl){if(hl==null){hl=hk.cm&&(hk.cm.display.shift||hk.extend)}ce(hk,new gW([ge(hk.sel.primary(),hj,i,hl)],0),hi)}function aD(hn,hm,hk){var hj=[];var ho=hn.cm&&(hn.cm.display.shift||hn.extend);for(var hl=0;hl<hn.sel.ranges.length;hl++){hj[hl]=ge(hn.sel.ranges[hl],hm[hl],null,ho)}var hi=cV(hj,hn.sel.primIndex);ce(hn,hi,hk)}function e(hm,hl,hj,hk){var hi=hm.sel.ranges.slice(0);hi[hl]=hj;ce(hm,cV(hi,hm.sel.primIndex),hk)}function J(hk,hi,hj,i){ce(hk,fz(hi,hj),i)}function b(hk,hi,i){var hj={ranges:hi.ranges,update:function(hl){var hn=this;this.ranges=[];for(var hm=0;hm<hl.length;hm++){hn.ranges[hm]=new es(gy(hk,hl[hm].anchor),gy(hk,hl[hm].head))}},origin:i&&i.origin};aM(hk,"beforeSelectionChange",hk,hj);if(hk.cm){aM(hk.cm,"beforeSelectionChange",hk.cm,hj)}if(hj.ranges!=hi.ranges){return cV(hj.ranges,hj.ranges.length-1)}else{return hi}}function fS(hl,hk,hi){var i=hl.history.done,hj=gt(i);if(hj&&hj.ranges){i[i.length-1]=hk;eZ(hl,hk,hi)}else{ce(hl,hk,hi)}}function ce(hj,hi,i){eZ(hj,hi,i);ha(hj,hj.sel,hj.cm?hj.cm.curOp.id:NaN,i)}function eZ(hk,hj,hi){if(f4(hk,"beforeSelectionChange")||hk.cm&&f4(hk.cm,"beforeSelectionChange")){hj=b(hk,hj,hi)}var i=hi&&hi.bias||(cC(hj.primary().head,hk.sel.primary().head)<0?-1:1);dB(hk,p(hk,hj,i,true));if(!(hi&&hi.scroll===false)&&hk.cm){gs(hk.cm)}}function dB(hi,i){if(i.equals(hi.sel)){return}hi.sel=i;if(hi.cm){hi.cm.curOp.updateInput=hi.cm.curOp.selectionChanged=true;ab(hi.cm)}am(hi,"cursorActivity",hi)}function fa(i){dB(i,p(i,i.sel,null,false))}function p(hr,hi,ho,hp){var hl;for(var hm=0;hm<hi.ranges.length;hm++){var hn=hi.ranges[hm];var hj=hi.ranges.length==hr.sel.ranges.length&&hr.sel.ranges[hm];var hq=cf(hr,hn.anchor,hj&&hj.anchor,ho,hp);var hk=cf(hr,hn.head,hj&&hj.head,ho,hp);if(hl||hq!=hn.anchor||hk!=hn.head){if(!hl){hl=hi.ranges.slice(0,hm)}hl[hm]=new es(hq,hk)}}return hl?cV(hl,hi.primIndex):hi}function fp(hs,hq,hl,hk,ho){var ht=fZ(hs,hq.line);if(ht.markedSpans){for(var hm=0;hm<ht.markedSpans.length;++hm){var hi=ht.markedSpans[hm],hj=hi.marker;if((hi.from==null||(hj.inclusiveLeft?hi.from<=hq.ch:hi.from<hq.ch))&&(hi.to==null||(hj.inclusiveRight?hi.to>=hq.ch:hi.to>hq.ch))){if(ho){aM(hj,"beforeCursorEnter");if(hj.explicitlyCleared){if(!ht.markedSpans){break}else{--hm;continue}}}if(!hj.atomic){continue}if(hl){var hp=hj.find(hk<0?1:-1),hr=(void 0);if(hk<0?hj.inclusiveRight:hj.inclusiveLeft){hp=he(hs,hp,-hk,hp&&hp.line==hq.line?ht:null)}if(hp&&hp.line==hq.line&&(hr=cC(hp,hl))&&(hk<0?hr<0:hr>0)){return fp(hs,hp,hq,hk,ho)}}var hn=hj.find(hk<0?-1:1);if(hk<0?hj.inclusiveLeft:hj.inclusiveRight){hn=he(hs,hn,hk,hn.line==hq.line?ht:null)}return hn?fp(hs,hn,hq,hk,ho):null}}}return hq}function cf(hm,hn,hk,hi,i){var hj=hi||1;var hl=fp(hm,hn,hk,hj,i)||(!i&&fp(hm,hn,hk,hj,true))||fp(hm,hn,hk,-hj,i)||(!i&&fp(hm,hn,hk,-hj,true));if(!hl){hm.cantEdit=true;return ac(hm.first,0)}return hl}function he(hj,hk,hi,i){if(hi<0&&hk.ch==0){if(hk.line>hj.first){return gy(hj,ac(hk.line-1))}else{return null}}else{if(hi>0&&hk.ch==(i||fZ(hj,hk.line)).text.length){if(hk.line<hj.first+hj.size-1){return ac(hk.line+1,0)}else{return null}}else{return new ac(hk.line,hk.ch+hi)}}}function au(i){i.setSelection(ac(i.firstLine(),0),ac(i.lastLine()),ah)}function ek(hi,hk,hj){var i={canceled:false,from:hk.from,to:hk.to,text:hk.text,origin:hk.origin,cancel:function(){return i.canceled=true}};if(hj){i.update=function(ho,hn,hm,hl){if(ho){i.from=gy(hi,ho)}if(hn){i.to=gy(hi,hn)}if(hm){i.text=hm}if(hl!==undefined){i.origin=hl}}}aM(hi,"beforeChange",hi,i);if(hi.cm){aM(hi.cm,"beforeChange",hi.cm,i)}if(i.canceled){return null}return{from:i.from,to:i.to,text:i.text,origin:i.origin}}function br(hl,hm,hk){if(hl.cm){if(!hl.cm.curOp){return ds(hl.cm,br)(hl,hm,hk)}if(hl.cm.state.suppressEdits){return}}if(f4(hl,"beforeChange")||hl.cm&&f4(hl.cm,"beforeChange")){hm=ek(hl,hm,true);if(!hm){return}}var hj=hc&&!hk&&c8(hl,hm.from,hm.to);if(hj){for(var hi=hj.length-1;hi>=0;--hi){P(hl,{from:hj[hi].from,to:hj[hi].to,text:hi?[""]:hm.text})}}else{P(hl,hm)}}function P(hj,hk){if(hk.text.length==1&&hk.text[0]==""&&cC(hk.from,hk.to)==0){return}var hi=f3(hj,hk);gA(hj,hk,hi,hj.cm?hj.cm.curOp.id:NaN);eL(hj,hk,hi,eT(hj,hk));var i=[];eE(hj,function(hm,hl){if(!hl&&dN(i,hm.history)==-1){d7(hm.history,hk);i.push(hm.history)}eL(hm,hk,null,eT(hm,hk))})}function ct(ht,hs,hv){if(ht.cm&&ht.cm.state.suppressEdits&&!hv){return}var hr=ht.history,hj,hl=ht.sel;var hi=hs=="undo"?hr.done:hr.undone,hu=hs=="undo"?hr.undone:hr.done;var ho=0;for(;ho<hi.length;ho++){hj=hi[ho];if(hv?hj.ranges&&!hj.equals(ht.sel):!hj.ranges){break}}if(ho==hi.length){return}hr.lastOrigin=hr.lastSelOrigin=null;for(;;){hj=hi.pop();if(hj.ranges){df(hj,hu);if(hv&&!hj.equals(ht.sel)){ce(ht,hj,{clearRedo:false});return}hl=hj}else{break}}var hq=[];df(hl,hu);hu.push({changes:hq,generation:hr.generation});hr.generation=hj.generation||++hr.maxGeneration;var hk=f4(ht,"beforeChange")||ht.cm&&f4(ht.cm,"beforeChange");var hp=function(hw){var hz=hj.changes[hw];hz.origin=hs;if(hk&&!ek(ht,hz,false)){hi.length=0;return{}}hq.push(d0(ht,hz));var hy=hw?f3(ht,hz):gt(hi);eL(ht,hz,hy,eG(ht,hz));if(!hw&&ht.cm){ht.cm.scrollIntoView({from:hz.from,to:dn(hz)})}var hx=[];eE(ht,function(hA,i){if(!i&&dN(hx,hA.history)==-1){d7(hA.history,hz);hx.push(hA.history)}eL(hA,hz,null,eG(hA,hz))})};for(var hm=hj.changes.length-1;hm>=0;--hm){var hn=hp(hm);if(hn){return hn.v}}}function f7(hi,hk){if(hk==0){return}hi.first+=hk;hi.sel=new gW(cd(hi.sel.ranges,function(hl){return new es(ac(hl.anchor.line+hk,hl.anchor.ch),ac(hl.head.line+hk,hl.head.ch))}),hi.sel.primIndex);if(hi.cm){ap(hi.cm,hi.first,hi.first-hk,hk);for(var hj=hi.cm.display,i=hj.viewFrom;i<hj.viewTo;i++){W(hi.cm,i,"gutter")}}}function eL(hl,hm,hk,hi){if(hl.cm&&!hl.cm.curOp){return ds(hl.cm,eL)(hl,hm,hk,hi)}if(hm.to.line<hl.first){f7(hl,hm.text.length-1-(hm.to.line-hm.from.line));return}if(hm.from.line>hl.lastLine()){return}if(hm.from.line<hl.first){var i=hm.text.length-1-(hl.first-hm.from.line);f7(hl,i);hm={from:ac(hl.first,0),to:ac(hm.to.line+i,hm.to.ch),text:[gt(hm.text)],origin:hm.origin}}var hj=hl.lastLine();if(hm.to.line>hj){hm={from:hm.from,to:ac(hj,fZ(hl,hj).text.length),text:[hm.text[0]],origin:hm.origin}}hm.removed=g0(hl,hm.from,hm.to);if(!hk){hk=f3(hl,hm)}if(hl.cm){aR(hl.cm,hm,hi)}else{gj(hl,hm,hi)}eZ(hl,hk,ah)}function aR(hs,ho,hm){var hr=hs.doc,hn=hs.display,hp=ho.from,hq=ho.to;var i=false,hl=hp.line;if(!hs.options.lineWrapping){hl=b6(z(fZ(hr,hp.line)));hr.iter(hl,hq.line+1,function(hu){if(hu==hn.maxLine){i=true;return true}})}if(hr.sel.contains(ho.from,ho.to)>-1){ab(hs)}gj(hr,ho,hm,bp(hs));if(!hs.options.lineWrapping){hr.iter(hl,hp.line+ho.text.length,function(hv){var hu=eW(hv);if(hu>hn.maxLineLength){hn.maxLine=hv;hn.maxLineLength=hu;hn.maxLineChanged=true;i=false}});if(i){hs.curOp.updateMaxLine=true}}hb(hr,hp.line);eM(hs,400);var ht=ho.text.length-(hq.line-hp.line)-1;if(ho.full){ap(hs)}else{if(hp.line==hq.line&&ho.text.length==1&&!em(hs.doc,ho)){W(hs,hp.line,"text")}else{ap(hs,hp.line,hq.line+1,ht)}}var hj=f4(hs,"changes"),hk=f4(hs,"change");if(hk||hj){var hi={from:hp,to:hq,text:ho.text,removed:ho.removed,origin:ho.origin};if(hk){am(hs,"change",hs,hi)}if(hj){(hs.curOp.changeObjs||(hs.curOp.changeObjs=[])).push(hi)}}hs.display.selForContextMenu=null}function bc(hk,hj,hm,hl,i){if(!hl){hl=hm}if(cC(hl,hm)<0){var hi=hl;hl=hm;hm=hi}if(typeof hj=="string"){hj=hk.splitLines(hj)}br(hk,{from:hm,to:hl,text:hj,origin:i})}function M(hk,hj,hi,i){if(hi<hk.line){hk.line+=i}else{if(hj<hk.line){hk.line=hj;hk.ch=0}}}function f1(hm,ho,hp,hq){for(var hl=0;hl<hm.length;++hl){var hi=hm[hl],hn=true;if(hi.ranges){if(!hi.copied){hi=hm[hl]=hi.deepCopy();hi.copied=true}for(var hk=0;hk<hi.ranges.length;hk++){M(hi.ranges[hk].anchor,ho,hp,hq);M(hi.ranges[hk].head,ho,hp,hq)}continue}for(var hj=0;hj<hi.changes.length;++hj){var hr=hi.changes[hj];if(hp<hr.from.line){hr.from=ac(hr.from.line+hq,hr.from.ch);hr.to=ac(hr.to.line+hq,hr.to.ch)}else{if(ho<=hr.to.line){hn=false;break}}}if(!hn){hm.splice(0,hl+1);hl=0}}}function d7(hi,hl){var hk=hl.from.line,hj=hl.to.line,i=hl.text.length-(hj-hk)-1;f1(hi.done,hk,hj,i);f1(hi.undone,hk,hj,i)}function fc(hk,hj,i,hm){var hl=hj,hi=hj;if(typeof hj=="number"){hi=fZ(hk,dw(hk,hj))}else{hl=b6(hj)}if(hl==null){return null}if(hm(hi,hl)&&hk.cm){W(hk.cm,hl,i)}return hi}function fJ(hj){var hl=this;this.lines=hj;this.parent=null;var hi=0;for(var hk=0;hk<hj.length;++hk){hj[hk].parent=hl;hi+=hj[hk].height}this.height=hi}fJ.prototype={chunkSize:function X(){return this.lines.length},removeInner:function O(hi,hn){var hm=this;for(var hk=hi,hl=hi+hn;hk<hl;++hk){var hj=hm.lines[hk];hm.height-=hj.height;bT(hj);am(hj,"delete")}this.lines.splice(hi,hn)},collapse:function gf(i){i.push.apply(i,this.lines)},insertInner:function a0(hj,hk,hi){var hm=this;this.height+=hi;this.lines=this.lines.slice(0,hj).concat(hk).concat(this.lines.slice(hj));for(var hl=0;hl<hk.length;++hl){hk[hl].parent=hm}},iterN:function gY(i,hl,hk){var hj=this;for(var hi=i+hl;i<hi;++i){if(hk(hj.lines[i])){return true}}}};function gi(hl){var hn=this;this.children=hl;var hk=0,hi=0;for(var hj=0;hj<hl.length;++hj){var hm=hl[hj];hk+=hm.chunkSize();hi+=hm.height;hm.parent=hn}this.size=hk;this.height=hi;this.parent=null}gi.prototype={chunkSize:function X(){return this.size},removeInner:function O(hk,hj){var hm=this;this.size-=hj;for(var hl=0;hl<this.children.length;++hl){var hi=hm.children[hl],ho=hi.chunkSize();if(hk<ho){var hn=Math.min(hj,ho-hk),hp=hi.height;hi.removeInner(hk,hn);hm.height-=hp-hi.height;if(ho==hn){hm.children.splice(hl--,1);hi.parent=null}if((hj-=hn)==0){break}hk=0}else{hk-=ho}}if(this.size-hj<25&&(this.children.length>1||!(this.children[0] instanceof fJ))){var hq=[];this.collapse(hq);this.children=[new fJ(hq)];this.children[0].parent=this}},collapse:function gf(hi){var hk=this;for(var hj=0;hj<this.children.length;++hj){hk.children[hj].collapse(hi)}},insertInner:function a0(hj,hr,hq){var hm=this;this.size+=hr.length;this.height+=hq;for(var hl=0;hl<this.children.length;++hl){var hi=hm.children[hl],ho=hi.chunkSize();if(hj<=ho){hi.insertInner(hj,hr,hq);if(hi.lines&&hi.lines.length>50){var hk=hi.lines.length%25+25;for(var hp=hk;hp<hi.lines.length;){var hn=new fJ(hi.lines.slice(hp,hp+=25));hi.height-=hn.height;hm.children.splice(++hl,0,hn);hn.parent=hm}hi.lines=hi.lines.slice(0,hk);hm.maybeSpill()}break}hj-=ho}},maybeSpill:function e4(){if(this.children.length<=10){return}var hk=this;do{var hi=hk.children.splice(hk.children.length-5,5);var hj=new gi(hi);if(!hk.parent){var hl=new gi(hk.children);hl.parent=hk;hk.children=[hl,hj];hk=hl}else{hk.size-=hj.size;hk.height-=hj.height;var i=dN(hk.parent.children,hk);hk.parent.children.splice(i+1,0,hj)}hj.parent=hk.parent}while(hk.children.length>10);hk.parent.maybeSpill()},iterN:function gY(hi,hp,ho){var hn=this;for(var hj=0;hj<this.children.length;++hj){var hm=hn.children[hj],hl=hm.chunkSize();if(hi<hl){var hk=Math.min(hp,hl-hi);if(hm.iterN(hi,hk,ho)){return true}if((hp-=hk)==0){break}hi=0}else{hi-=hl}}}};var d5=function(hk,hj,i){var hl=this;if(i){for(var hi in i){if(i.hasOwnProperty(hi)){hl[hi]=i[hi]}}}this.doc=hk;this.node=hj};d5.prototype.clear=function(){var ho=this;var hj=this.doc.cm,hl=this.line.widgets,hk=this.line,hn=b6(hk);if(hn==null||!hl){return}for(var hm=0;hm<hl.length;++hm){if(hl[hm]==ho){hl.splice(hm--,1)}}if(!hl.length){hk.widgets=null}var hi=dp(this);g3(hk,Math.max(0,hk.height-hi));if(hj){dd(hj,function(){eu(hj,hk,-hi);W(hj,hn,"widget")});am(hj,"lineWidgetCleared",hj,this,hn)}};d5.prototype.changed=function(){var hl=this;var hi=this.height,i=this.doc.cm,hj=this.line;this.height=null;var hk=dp(this)-hi;if(!hk){return}g3(hj,hj.height+hk);if(i){dd(i,function(){i.curOp.forceUpdate=true;eu(i,hj,hk);am(i,"lineWidgetChanged",i,hl,b6(hj))})}};bR(d5);function eu(i,hi,hj){if(b5(hi)<((i.curOp&&i.curOp.scrollTop)||i.doc.scrollTop)){c7(i,hj)}}function bY(hm,hl,hj,hi){var hk=new d5(hm,hj,hi);var i=hm.cm;if(i&&hk.noHScroll){i.display.alignWidgets=true}fc(hm,hl,"widget",function(ho){var hp=ho.widgets||(ho.widgets=[]);if(hk.insertAt==null){hp.push(hk)}else{hp.splice(Math.min(hp.length-1,Math.max(0,hk.insertAt)),0,hk)}hk.line=ho;if(i&&!gg(hm,ho)){var hn=b5(ho)<hm.scrollTop;g3(ho,ho.height+dp(hk));if(hn){c7(i,hk.height)}i.curOp.forceUpdate=true}return true});am(i,"lineWidgetAdded",i,hk,typeof hl=="number"?hl:b6(hl));return hk}var bf=0;var V=function(hi,i){this.lines=[];this.type=i;this.doc=hi;this.id=++bf};V.prototype.clear=function(){var hn=this;if(this.explicitlyCleared){return}var hr=this.doc.cm,hk=hr&&!hr.curOp;if(hk){c9(hr)}if(f4(this,"clear")){var hs=this.find();if(hs){am(this,"clear",hs.from,hs.to)}}var hl=null,hp=null;for(var hm=0;hm<this.lines.length;++hm){var ht=hn.lines[hm];var hq=fU(ht.markedSpans,hn);if(hr&&!hn.collapsed){W(hr,b6(ht),"text")}else{if(hr){if(hq.to!=null){hp=b6(ht)}if(hq.from!=null){hl=b6(ht)}}}ht.markedSpans=fn(ht.markedSpans,hq);if(hq.from==null&&hn.collapsed&&!gg(hn.doc,ht)&&hr){g3(ht,a9(hr.display))}}if(hr&&this.collapsed&&!hr.options.lineWrapping){for(var hj=0;hj<this.lines.length;++hj){var hi=z(hn.lines[hj]),ho=eW(hi);if(ho>hr.display.maxLineLength){hr.display.maxLine=hi;hr.display.maxLineLength=ho;hr.display.maxLineChanged=true}}}if(hl!=null&&hr&&this.collapsed){ap(hr,hl,hp+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(hr){fa(hr.doc)}}if(hr){am(hr,"markerCleared",hr,this,hl,hp)}if(hk){av(hr)}if(this.parent){this.parent.clear()}};V.prototype.find=function(hl,hj){var hp=this;if(hl==null&&this.type=="bookmark"){hl=1}var ho,hn;for(var hk=0;hk<this.lines.length;++hk){var hi=hp.lines[hk];var hm=fU(hi.markedSpans,hp);if(hm.from!=null){ho=ac(hj?hi:b6(hi),hm.from);if(hl==-1){return ho}}if(hm.to!=null){hn=ac(hj?hi:b6(hi),hm.to);if(hl==1){return hn}}}return ho&&{from:ho,to:hn}};V.prototype.changed=function(){var hk=this;var hj=this.find(-1,true),hi=this,i=this.doc.cm;if(!hj||!i){return}dd(i,function(){var hm=hj.line,hn=b6(hj.line);var hl=fW(i,hn);if(hl){aC(hl);i.curOp.selectionChanged=i.curOp.forceUpdate=true}i.curOp.updateMaxLine=true;if(!gg(hi.doc,hm)&&hi.height!=null){var hp=hi.height;hi.height=null;var ho=dp(hi)-hp;if(ho){g3(hm,hm.height+ho)}}am(i,"markerChanged",i,hk)})};V.prototype.attachLine=function(i){if(!this.lines.length&&this.doc.cm){var hi=this.doc.cm.curOp;if(!hi.maybeHiddenMarkers||dN(hi.maybeHiddenMarkers,this)==-1){(hi.maybeUnhiddenMarkers||(hi.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(i)};V.prototype.detachLine=function(i){this.lines.splice(dN(this.lines,i),1);if(!this.lines.length&&this.doc.cm){var hi=this.doc.cm.curOp;(hi.maybeHiddenMarkers||(hi.maybeHiddenMarkers=[])).push(this)}};bR(V);function fk(hq,ho,hp,hs,hm){if(hs&&hs.shared){return S(hq,ho,hp,hs,hm)}if(hq.cm&&!hq.cm.curOp){return ds(hq.cm,fk)(hq,ho,hp,hs,hm)}var hl=new V(hq,hm),hr=cC(ho,hp);if(hs){aX(hs,hl,false)}if(hr>0||hr==0&&hl.clearWhenEmpty!==false){return hl}if(hl.replacedWith){hl.collapsed=true;hl.widgetNode=g4("span",[hl.replacedWith],"CodeMirror-widget");if(!hs.handleMouseEvents){hl.widgetNode.setAttribute("cm-ignore-events","true")}if(hs.insertLeft){hl.widgetNode.insertLeft=true}}if(hl.collapsed){if(A(hq,ho.line,ho,hp,hl)||ho.line!=hp.line&&A(hq,hp.line,ho,hp,hl)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}bO()}if(hl.addToHistory){gA(hq,{from:ho,to:hp,origin:"markText"},hq.sel,NaN)}var hj=ho.line,hn=hq.cm,hi;hq.iter(hj,hp.line+1,function(i){if(hn&&hl.collapsed&&!hn.options.lineWrapping&&z(i)==hn.display.maxLine){hi=true}if(hl.collapsed&&hj!=ho.line){g3(i,0)}cA(i,new eR(hl,hj==ho.line?ho.ch:null,hj==hp.line?hp.ch:null));++hj});if(hl.collapsed){hq.iter(ho.line,hp.line+1,function(i){if(gg(hq,i)){g3(i,0)}})}if(hl.clearOnEnter){ch(hl,"beforeCursorEnter",function(){return hl.clear()})}if(hl.readOnly){gl();if(hq.history.done.length||hq.history.undone.length){hq.clearHistory()}}if(hl.collapsed){hl.id=++bf;hl.atomic=true}if(hn){if(hi){hn.curOp.updateMaxLine=true}if(hl.collapsed){ap(hn,ho.line,hp.line+1)}else{if(hl.className||hl.title||hl.startStyle||hl.endStyle||hl.css){for(var hk=ho.line;hk<=hp.line;hk++){W(hn,hk,"text")}}}if(hl.atomic){fa(hn.doc)}am(hn,"markerAdded",hn,hl)}return hl}var y=function(hk,hj){var hl=this;this.markers=hk;this.primary=hj;for(var hi=0;hi<hk.length;++hi){hk[hi].parent=hl}};y.prototype.clear=function(){var hj=this;if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var hi=0;hi<this.markers.length;++hi){hj.markers[hi].clear()}am(this,"clear")};y.prototype.find=function(hi,i){return this.primary.find(hi,i)};bR(y);function S(hl,ho,hn,i,hj){i=aX(i);i.shared=false;var hm=[fk(hl,ho,hn,i,hj)],hi=hm[0];var hk=i.widgetNode;eE(hl,function(hq){if(hk){i.widgetNode=hk.cloneNode(true)}hm.push(fk(hq,gy(hq,ho),gy(hq,hn),i,hj));for(var hp=0;hp<hq.linked.length;++hp){if(hq.linked[hp].isParent){return}}hi=gt(hm)});return new y(hm,hi)}function fw(i){return i.findMarks(ac(i.first,0),i.clipPos(ac(i.lastLine())),function(hi){return hi.parent})}function d8(hn,ho){for(var hl=0;hl<ho.length;hl++){var hj=ho[hl],hp=hj.find();var hi=hn.clipPos(hp.from),hm=hn.clipPos(hp.to);if(cC(hi,hm)){var hk=fk(hn,hi,hm,hj.primary,hj.primary.type);hj.markers.push(hk);hk.parent=hj}}}function eY(hk){var hi=function(hn){var hl=hk[hn],hp=[hl.primary.doc];eE(hl.primary.doc,function(i){return hp.push(i)});for(var hm=0;hm<hl.markers.length;hm++){var ho=hl.markers[hm];if(dN(hp,ho.doc)==-1){ho.parent=null;hl.markers.splice(hm--,1)}}};for(var hj=0;hj<hk.length;hj++){hi(hj)}}var cQ=0;var aB=function(hl,hk,i,hj,hi){if(!(this instanceof aB)){return new aB(hl,hk,i,hj,hi)}if(i==null){i=0}gi.call(this,[new fJ([new g2("",null)])]);this.first=i;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.modeFrontier=this.highlightFrontier=i;var hm=ac(i,0);this.sel=fz(hm);this.history=new gL(null);this.id=++cQ;this.modeOption=hk;this.lineSep=hj;this.direction=(hi=="rtl")?"rtl":"ltr";this.extend=false;if(typeof hl=="string"){hl=this.splitLines(hl)}gj(this,{from:hm,to:hm,text:hl});ce(this,fz(hm),ah)};aB.prototype=cI(gi.prototype,{constructor:aB,iter:function(hj,hi,i){if(i){this.iterN(hj-this.first,hi-hj,i)}else{this.iterN(this.first,this.first+this.size,hj)}},insert:function(hj,hk){var hi=0;for(var hl=0;hl<hk.length;++hl){hi+=hk[hl].height}this.insertInner(hj-this.first,hk,hi)},remove:function(i,hi){this.removeInner(i-this.first,hi)},getValue:function(hi){var i=bd(this,this.first,this.first+this.size);if(hi===false){return i}return i.join(hi||this.lineSeparator())},setValue:c3(function(hi){var hj=ac(this.first,0),i=this.first+this.size-1;br(this,{from:hj,to:ac(i,fZ(this,i).text.length),text:this.splitLines(hi),origin:"setValue",full:true},true);if(this.cm){ft(this.cm,0,0)}ce(this,fz(hj),ah)}),replaceRange:function(hi,hk,hj,i){hk=gy(this,hk);hj=hj?gy(this,hj):hk;bc(this,hi,hk,hj,i)},getRange:function(hk,hj,hi){var i=g0(this,gy(this,hk),gy(this,hj));if(hi===false){return i}return i.join(hi||this.lineSeparator())},getLine:function(hi){var i=this.getLineHandle(hi);return i&&i.text},getLineHandle:function(i){if(cu(this,i)){return fZ(this,i)}},getLineNumber:function(i){return b6(i)},getLineHandleVisualStart:function(i){if(typeof i=="number"){i=fZ(this,i)}return z(i)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(i){return gy(this,i)},getCursor:function(hj){var i=this.sel.primary(),hi;if(hj==null||hj=="head"){hi=i.head}else{if(hj=="anchor"){hi=i.anchor}else{if(hj=="end"||hj=="to"||hj===false){hi=i.to()}else{hi=i.from()}}}return hi},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:c3(function(i,hj,hi){J(this,gy(this,typeof i=="number"?ac(i,hj||0):i),null,hi)}),setSelection:c3(function(hi,hj,i){J(this,gy(this,hi),gy(this,hj||hi),i)}),extendSelection:c3(function(hj,i,hi){gQ(this,gy(this,hj),i&&gy(this,i),hi)}),extendSelections:c3(function(hi,i){aD(this,ew(this,hi),i)}),extendSelectionsBy:c3(function(hj,i){var hi=cd(this.sel.ranges,hj);aD(this,ew(this,hi),i)}),setSelections:c3(function(hi,hm,hk){var hn=this;if(!hi.length){return}var hj=[];for(var hl=0;hl<hi.length;hl++){hj[hl]=new es(gy(hn,hi[hl].anchor),gy(hn,hi[hl].head))}if(hm==null){hm=Math.min(hi.length-1,this.sel.primIndex)}ce(this,cV(hj,hm),hk)}),addSelection:c3(function(hj,hk,hi){var i=this.sel.ranges.slice(0);i.push(new es(gy(this,hj),gy(this,hk||hj)));ce(this,cV(i,i.length-1),hi)}),getSelection:function(hm){var hn=this;var hj=this.sel.ranges,hi;for(var hk=0;hk<hj.length;hk++){var hl=g0(hn,hj[hk].from(),hj[hk].to());hi=hi?hi.concat(hl):hl}if(hm===false){return hi}else{return hi.join(hm||this.lineSeparator())}},getSelections:function(hm){var hn=this;var hl=[],hi=this.sel.ranges;for(var hj=0;hj<hi.length;hj++){var hk=g0(hn,hi[hj].from(),hi[hj].to());if(hm!==false){hk=hk.join(hm||hn.lineSeparator())}hl[hj]=hk}return hl},replaceSelection:function(hk,hm,hi){var hl=[];for(var hj=0;hj<this.sel.ranges.length;hj++){hl[hj]=hk}this.replaceSelections(hl,hm,hi||"+input")},replaceSelections:c3(function(hj,hp,hr){var hn=this;var hq=[],hl=this.sel;for(var hm=0;hm<hl.ranges.length;hm++){var ho=hl.ranges[hm];hq[hm]={from:ho.from(),to:ho.to(),text:hn.splitLines(hj[hm]),origin:hr}}var hi=hp&&hp!="end"&&an(this,hq,hp);for(var hk=hq.length-1;hk>=0;hk--){br(hn,hq[hk])}if(hi){fS(this,hi)}else{if(this.cm){gs(this.cm)}}}),undo:c3(function(){ct(this,"undo")}),redo:c3(function(){ct(this,"redo")}),undoSelection:c3(function(){ct(this,"undo",true)}),redoSelection:c3(function(){ct(this,"redo",true)}),setExtending:function(i){this.extend=i},getExtending:function(){return this.extend},historySize:function(){var hl=this.history,hi=0,hk=0;for(var hj=0;hj<hl.done.length;hj++){if(!hl.done[hj].ranges){++hi}}for(var hm=0;hm<hl.undone.length;hm++){if(!hl.undone[hm].ranges){++hk}}return{undo:hi,redo:hk}},clearHistory:function(){this.history=new gL(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(i){if(i){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(i){return this.history.generation==(i||this.cleanGeneration)},getHistory:function(){return{done:b8(this.history.done),undone:b8(this.history.undone)}},setHistory:function(hi){var i=this.history=new gL(this.history.maxGeneration);i.done=b8(hi.done.slice(0),null,true);i.undone=b8(hi.undone.slice(0),null,true)},setGutterMarker:c3(function(i,hi,hj){return fc(this,i,"gutter",function(hk){var hl=hk.gutterMarkers||(hk.gutterMarkers={});hl[hi]=hj;if(!hj&&fD(hl)){hk.gutterMarkers=null}return true})}),clearGutter:c3(function(i){var hi=this;this.iter(function(hj){if(hj.gutterMarkers&&hj.gutterMarkers[i]){fc(hi,hj,"gutter",function(){hj.gutterMarkers[i]=null;if(fD(hj.gutterMarkers)){hj.gutterMarkers=null}return true})}})}),lineInfo:function(i){var hi;if(typeof i=="number"){if(!cu(this,i)){return null}hi=i;i=fZ(this,i);if(!i){return null}}else{hi=b6(i);if(hi==null){return null}}return{line:hi,handle:i,text:i.text,gutterMarkers:i.gutterMarkers,textClass:i.textClass,bgClass:i.bgClass,wrapClass:i.wrapClass,widgets:i.widgets}},addLineClass:c3(function(hj,hi,i){return fc(this,hj,hi=="gutter"?"gutter":"class",function(hk){var hl=hi=="text"?"textClass":hi=="background"?"bgClass":hi=="gutter"?"gutterClass":"wrapClass";if(!hk[hl]){hk[hl]=i}else{if(Y(i).test(hk[hl])){return false}else{hk[hl]+=" "+i}}return true})}),removeLineClass:c3(function(hj,hi,i){return fc(this,hj,hi=="gutter"?"gutter":"class",function(hl){var ho=hi=="text"?"textClass":hi=="background"?"bgClass":hi=="gutter"?"gutterClass":"wrapClass";var hn=hl[ho];if(!hn){return false}else{if(i==null){hl[ho]=null}else{var hm=hn.match(Y(i));if(!hm){return false}var hk=hm.index+hm[0].length;hl[ho]=hn.slice(0,hm.index)+(!hm.index||hk==hn.length?"":" ")+hn.slice(hk)||null}}return true})}),addLineWidget:c3(function(hj,hi,i){return bY(this,hj,hi,i)}),removeLineWidget:function(i){i.clear()},markText:function(hj,hi,i){return fk(this,gy(this,hj),gy(this,hi),i,i&&i.type||"range")},setBookmark:function(hj,i){var hi={replacedWith:i&&(i.nodeType==null?i.widget:i),insertLeft:i&&i.insertLeft,clearWhenEmpty:false,shared:i&&i.shared,handleMouseEvents:i&&i.handleMouseEvents};hj=gy(this,hj);return fk(this,hj,hj,hi,"bookmark")},findMarksAt:function(hm){hm=gy(this,hm);var hl=[],hj=fZ(this,hm.line).markedSpans;if(hj){for(var hi=0;hi<hj.length;++hi){var hk=hj[hi];if((hk.from==null||hk.from<=hm.ch)&&(hk.to==null||hk.to>=hm.ch)){hl.push(hk.marker.parent||hk.marker)}}}return hl},findMarks:function(hl,hk,i){hl=gy(this,hl);hk=gy(this,hk);var hi=[],hj=hl.line;this.iter(hl.line,hk.line+1,function(hm){var ho=hm.markedSpans;if(ho){for(var hn=0;hn<ho.length;hn++){var hp=ho[hn];if(!(hp.to!=null&&hj==hl.line&&hl.ch>=hp.to||hp.from==null&&hj!=hl.line||hp.from!=null&&hj==hk.line&&hp.from>=hk.ch)&&(!i||i(hp.marker))){hi.push(hp.marker.parent||hp.marker)}}}++hj});return hi},getAllMarks:function(){var i=[];this.iter(function(hj){var hi=hj.markedSpans;if(hi){for(var hk=0;hk<hi.length;++hk){if(hi[hk].from!=null){i.push(hi[hk].marker)}}}});return i},posFromIndex:function(hj){var i,hk=this.first,hi=this.lineSeparator().length;this.iter(function(hl){var hm=hl.text.length+hi;if(hm>hj){i=hj;return true}hj-=hm;++hk});return gy(this,ac(hk,i))},indexFromPos:function(hj){hj=gy(this,hj);var i=hj.ch;if(hj.line<this.first||hj.ch<0){return 0}var hi=this.lineSeparator().length;this.iter(this.first,hj.line,function(hk){i+=hk.text.length+hi});return i},copy:function(i){var hi=new aB(bd(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);hi.scrollTop=this.scrollTop;hi.scrollLeft=this.scrollLeft;hi.sel=this.sel;hi.extend=false;if(i){hi.history.undoDepth=this.history.undoDepth;hi.setHistory(this.getHistory())}return hi},linkedDoc:function(i){if(!i){i={}}var hk=this.first,hj=this.first+this.size;if(i.from!=null&&i.from>hk){hk=i.from}if(i.to!=null&&i.to<hj){hj=i.to}var hi=new aB(bd(this,hk,hj),i.mode||this.modeOption,hk,this.lineSep,this.direction);if(i.sharedHist){hi.history=this.history}(this.linked||(this.linked=[])).push({doc:hi,sharedHist:i.sharedHist});hi.linked=[{doc:this,isParent:true,sharedHist:i.sharedHist}];d8(hi,fw(this));return hi},unlinkDoc:function(hj){var hm=this;if(hj instanceof K){hj=hj.doc}if(this.linked){for(var hk=0;hk<this.linked.length;++hk){var hl=hm.linked[hk];if(hl.doc!=hj){continue}hm.linked.splice(hk,1);hj.unlinkDoc(hm);eY(fw(hm));break}}if(hj.history==this.history){var hi=[hj.id];eE(hj,function(i){return hi.push(i.id)},true);hj.history=new gL(null);hj.history.done=b8(this.history.done,hi);hj.history.undone=b8(this.history.undone,hi)}},iterLinkedDocs:function(i){eE(this,i)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(i){if(this.lineSep){return i.split(this.lineSep)}return gI(i)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:c3(function(i){if(i!="rtl"){i="ltr"}if(i==this.direction){return}this.direction=i;this.iter(function(hi){return hi.order=null});if(this.cm){ev(this.cm)}})});aB.prototype.eachLine=aB.prototype.iter;var ao=0;function bv(hq){var hs=this;dF(hs);if(a2(hs,hq)||bm(hs.display,hq)){return}c5(hq);if(ed){ao=+new Date}var hr=cM(hs,hq,true),hj=hq.dataTransfer.files;if(!hr||hs.isReadOnly()){return}if(hj&&hj.length&&window.FileReader&&window.File){var hm=hj.length,ht=Array(hm),hk=0;var ho=function(hw,hv){if(hs.options.allowDropFileTypes&&dN(hs.options.allowDropFileTypes,hw.type)==-1){return}var hu=new FileReader;hu.onload=ds(hs,function(){var i=hu.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(i)){i=""}ht[hv]=i;if(++hk==hm){hr=gy(hs.doc,hr);var hx={from:hr,to:hr,text:hs.doc.splitLines(ht.join(hs.doc.lineSeparator())),origin:"paste"};br(hs.doc,hx);fS(hs.doc,fz(hr,dn(hx)))}});hu.readAsText(hw)};for(var hp=0;hp<hm;++hp){ho(hj[hp],hp)}}else{if(hs.state.draggingText&&hs.doc.sel.contains(hr)>-1){hs.state.draggingText(hq);setTimeout(function(){return hs.display.input.focus()},20);return}try{var hi=hq.dataTransfer.getData("Text");if(hi){var hn;if(hs.state.draggingText&&!hs.state.draggingText.copy){hn=hs.listSelections()}eZ(hs.doc,fz(hr,hr));if(hn){for(var hl=0;hl<hn.length;++hl){bc(hs.doc,"",hn[hl].anchor,hn[hl].head,"drag")}}hs.replaceSelection(hi,"around","paste");hs.display.input.focus()}}catch(hq){}}}function U(i,hj){if(ed&&(!i.state.draggingText||+new Date-ao<100)){e1(hj);return}if(a2(i,hj)||bm(i.display,hj)){return}hj.dataTransfer.setData("Text",i.getSelection());hj.dataTransfer.effectAllowed="copyMove";if(hj.dataTransfer.setDragImage&&!aK){var hi=gX("img",null,null,"position: fixed; left: 0; top: 0;");hi.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(ez){hi.width=hi.height=1;i.display.wrapper.appendChild(hi);hi._top=hi.offsetTop}hj.dataTransfer.setDragImage(hi,0,0);if(ez){hi.parentNode.removeChild(hi)}}}function hf(i,hi){var hk=cM(i,hi);if(!hk){return}var hj=document.createDocumentFragment();C(i,hk,hj);if(!i.display.dragCursor){i.display.dragCursor=gX("div",null,"CodeMirror-cursors CodeMirror-dragcursors");i.display.lineSpace.insertBefore(i.display.dragCursor,i.display.cursorDiv)}cc(i.display.dragCursor,hj)}function dF(i){if(i.display.dragCursor){i.display.lineSpace.removeChild(i.display.dragCursor);i.display.dragCursor=null}}function aI(hl){if(!document.getElementsByClassName){return}var hk=document.getElementsByClassName("CodeMirror");for(var hj=0;hj<hk.length;hj++){var hi=hk[hj].CodeMirror;if(hi){hl(hi)}}}var c2=false;function bu(){if(c2){return}gr();c2=true}function gr(){var i;ch(window,"resize",function(){if(i==null){i=setTimeout(function(){i=null;aI(a4)},100)}});ch(window,"blur",function(){return aI(a6)})}function a4(i){var hi=i.display;if(hi.lastWrapHeight==hi.wrapper.clientHeight&&hi.lastWrapWidth==hi.wrapper.clientWidth){return}hi.cachedCharWidth=hi.cachedTextHeight=hi.cachedPaddingH=null;hi.scrollbarsClipped=false;i.setSize()}var f0={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};for(var gh=0;gh<10;gh++){f0[gh+48]=f0[gh+96]=String(gh)}for(var gK=65;gK<=90;gK++){f0[gK]=String.fromCharCode(gK)}for(var gJ=1;gJ<=12;gJ++){f0[gJ+111]=f0[gJ+63235]="F"+gJ}var fV={};fV.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};fV.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};fV.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"};fV.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};fV["default"]=cs?fV.macDefault:fV.pcDefault;function dY(hj){var hp=hj.split(/-(?!$)/);hj=hp[hp.length-1];var ho,hn,hi,hm;for(var hl=0;hl<hp.length-1;hl++){var hk=hp[hl];if(/^(cmd|meta|m)$/i.test(hk)){hm=true}else{if(/^a(lt)?$/i.test(hk)){ho=true}else{if(/^(c|ctrl|control)$/i.test(hk)){hn=true}else{if(/^s(hift)?$/i.test(hk)){hi=true}else{throw new Error("Unrecognized modifier name: "+hk)}}}}}if(ho){hj="Alt-"+hj}if(hn){hj="Ctrl-"+hj}if(hm){hj="Cmd-"+hj}if(hi){hj="Shift-"+hj}return hj}function c6(hp){var hj={};for(var ho in hp){if(hp.hasOwnProperty(ho)){var hq=hp[ho];if(/^(name|fallthrough|(de|at)tach)$/.test(ho)){continue}if(hq=="..."){delete hp[ho];continue}var hr=cd(ho.split(" "),dY);for(var hn=0;hn<hr.length;hn++){var hl=(void 0),hk=(void 0);if(hn==hr.length-1){hk=hr.join(" ");hl=hq}else{hk=hr.slice(0,hn+1).join(" ");hl="..."}var hm=hj[hk];if(!hm){hj[hk]=hl}else{if(hm!=hl){throw new Error("Inconsistent bindings for "+hk)}}}delete hp[ho]}}for(var hi in hj){hp[hi]=hj[hi]}return hp}function k(hl,ho,hn,hk){ho=gP(ho);var hm=ho.call?ho.call(hl,hk):ho[hl];if(hm===false){return"nothing"}if(hm==="..."){return"multi"}if(hm!=null&&hn(hm)){return"handled"}if(ho.fallthrough){if(Object.prototype.toString.call(ho.fallthrough)!="[object Array]"){return k(hl,ho.fallthrough,hn,hk)}for(var hj=0;hj<ho.fallthrough.length;hj++){var hi=k(hl,ho.fallthrough[hj],hn,hk);if(hi){return hi}}}}function fe(hi){var i=typeof hi=="string"?hi:f0[hi.keyCode];return i=="Ctrl"||i=="Alt"||i=="Shift"||i=="Mod"}function gS(i,hi,hk){var hj=i;if(hi.altKey&&hj!="Alt"){i="Alt-"+i}if((ca?hi.metaKey:hi.ctrlKey)&&hj!="Ctrl"){i="Ctrl-"+i}if((ca?hi.ctrlKey:hi.metaKey)&&hj!="Cmd"){i="Cmd-"+i}if(!hk&&hi.shiftKey&&hj!="Shift"){i="Shift-"+i}return i}function ga(hi,hj){if(ez&&hi.keyCode==34&&hi["char"]){return false}var i=f0[hi.keyCode];if(i==null||hi.altGraphKey){return false}return gS(i,hi,hj)}function gP(i){return typeof i=="string"?fV[i]:i}function fH(hi,ho){var hj=hi.doc.sel.ranges,hm=[];for(var hl=0;hl<hj.length;hl++){var hk=ho(hj[hl]);while(hm.length&&cC(hk.from,gt(hm).to)<=0){var hn=hm.pop();if(cC(hn.from,hk.from)<0){hk.from=hn.from;break}}hm.push(hk)}dd(hi,function(){for(var hp=hm.length-1;hp>=0;hp--){bc(hi.doc,"",hm[hp].from,hm[hp].to,"+delete")}gs(hi)})}var fh={selectAll:au,singleSelection:function(i){return i.setSelection(i.getCursor("anchor"),i.getCursor("head"),ah)},killLine:function(i){return fH(i,function(hj){if(hj.empty()){var hi=fZ(i.doc,hj.head.line).text.length;if(hj.head.ch==hi&&hj.head.line<i.lastLine()){return{from:hj.head,to:ac(hj.head.line+1,0)}}else{return{from:hj.head,to:ac(hj.head.line,hi)}}}else{return{from:hj.from(),to:hj.to()}}})},deleteLine:function(i){return fH(i,function(hi){return({from:ac(hi.from().line,0),to:gy(i.doc,ac(hi.to().line+1,0))})})},delLineLeft:function(i){return fH(i,function(hi){return({from:ac(hi.from().line,0),to:hi.from()})})},delWrappedLineLeft:function(i){return fH(i,function(hi){var hk=i.charCoords(hi.head,"div").top+5;var hj=i.coordsChar({left:0,top:hk},"div");return{from:hj,to:hi.from()}})},delWrappedLineRight:function(i){return fH(i,function(hi){var hk=i.charCoords(hi.head,"div").top+5;var hj=i.coordsChar({left:i.display.lineDiv.offsetWidth+100,top:hk},"div");return{from:hi.from(),to:hj}})},undo:function(i){return i.undo()},redo:function(i){return i.redo()},undoSelection:function(i){return i.undoSelection()},redoSelection:function(i){return i.redoSelection()},goDocStart:function(i){return i.extendSelection(ac(i.firstLine(),0))},goDocEnd:function(i){return i.extendSelection(ac(i.lastLine()))},goLineStart:function(i){return i.extendSelectionsBy(function(hi){return bK(i,hi.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(i){return i.extendSelectionsBy(function(hi){return eb(i,hi.head)},{origin:"+move",bias:1})},goLineEnd:function(i){return i.extendSelectionsBy(function(hi){return ej(i,hi.head.line)},{origin:"+move",bias:-1})},goLineRight:function(i){return i.extendSelectionsBy(function(hi){var hj=i.charCoords(hi.head,"div").top+5;return i.coordsChar({left:i.display.lineDiv.offsetWidth+100,top:hj},"div")},dm)},goLineLeft:function(i){return i.extendSelectionsBy(function(hi){var hj=i.charCoords(hi.head,"div").top+5;return i.coordsChar({left:0,top:hj},"div")},dm)},goLineLeftSmart:function(i){return i.extendSelectionsBy(function(hi){var hj=i.charCoords(hi.head,"div").top+5;var hk=i.coordsChar({left:0,top:hj},"div");if(hk.ch<i.getLine(hk.line).search(/\S/)){return eb(i,hi.head)}return hk},dm)},goLineUp:function(i){return i.moveV(-1,"line")},goLineDown:function(i){return i.moveV(1,"line")},goPageUp:function(i){return i.moveV(-1,"page")},goPageDown:function(i){return i.moveV(1,"page")},goCharLeft:function(i){return i.moveH(-1,"char")},goCharRight:function(i){return i.moveH(1,"char")},goColumnLeft:function(i){return i.moveH(-1,"column")},goColumnRight:function(i){return i.moveH(1,"column")},goWordLeft:function(i){return i.moveH(-1,"word")},goGroupRight:function(i){return i.moveH(1,"group")},goGroupLeft:function(i){return i.moveH(-1,"group")},goWordRight:function(i){return i.moveH(1,"word")},delCharBefore:function(i){return i.deleteH(-1,"char")},delCharAfter:function(i){return i.deleteH(1,"char")},delWordBefore:function(i){return i.deleteH(-1,"word")},delWordAfter:function(i){return i.deleteH(1,"word")},delGroupBefore:function(i){return i.deleteH(-1,"group")},delGroupAfter:function(i){return i.deleteH(1,"group")},indentAuto:function(i){return i.indentSelection("smart")},indentMore:function(i){return i.indentSelection("add")},indentLess:function(i){return i.indentSelection("subtract")},insertTab:function(i){return i.replaceSelection("\t")},insertSoftTab:function(hi){var hk=[],hj=hi.listSelections(),hn=hi.options.tabSize;for(var hm=0;hm<hj.length;hm++){var ho=hj[hm].from();var hl=cb(hi.getLine(ho.line),ho.ch,hn);hk.push(cO(hn-hl%hn))}hi.replaceSelections(hk)},defaultTab:function(i){if(i.somethingSelected()){i.indentSelection("add")}else{i.execCommand("insertTab")}},transposeChars:function(i){return dd(i,function(){var hk=i.listSelections(),hj=[];for(var hl=0;hl<hk.length;hl++){if(!hk[hl].empty()){continue}var hn=hk[hl].head,hi=fZ(i.doc,hn.line).text;if(hi){if(hn.ch==hi.length){hn=new ac(hn.line,hn.ch-1)}if(hn.ch>0){hn=new ac(hn.line,hn.ch+1);i.replaceRange(hi.charAt(hn.ch-1)+hi.charAt(hn.ch-2),ac(hn.line,hn.ch-2),hn,"+transpose")}else{if(hn.line>i.doc.first){var hm=fZ(i.doc,hn.line-1).text;if(hm){hn=new ac(hn.line,1);i.replaceRange(hi.charAt(0)+i.doc.lineSeparator()+hm.charAt(hm.length-1),ac(hn.line-1,hm.length-1),hn,"+transpose")}}}}hj.push(new es(hn,hn))}i.setSelections(hj)})},newlineAndIndent:function(i){return dd(i,function(){var hi=i.listSelections();for(var hj=hi.length-1;hj>=0;hj--){i.replaceRange(i.doc.lineSeparator(),hi[hj].anchor,hi[hj].head,"+input")}hi=i.listSelections();for(var hk=0;hk<hi.length;hk++){i.indentLine(hi[hk].from().line,null,true)}gs(i)})},openLine:function(i){return i.replaceSelection("\n","start")},toggleOverwrite:function(i){return i.toggleOverwrite()}};function bK(i,hj){var hi=fZ(i.doc,hj);var hk=z(hi);if(hk!=hi){hj=b6(hk)}return fd(true,i,hk,hj,1)}function ej(i,hj){var hi=fZ(i.doc,hj);var hk=cH(hi);if(hk!=hi){hj=b6(hk)}return fd(true,i,hi,hj,-1)}function eb(hi,hn){var hm=bK(hi,hn.line);var hj=fZ(hi.doc,hm.line);var i=a(hj,hi.doc.direction);if(!i||i[0].level==0){var hl=Math.max(0,hj.text.search(/\S/));var hk=hn.line==hm.line&&hn.ch<=hl&&hn.ch;return ac(hm.line,hk?0:hl,hm.sticky)}return hm}function gH(hi,hl,i){if(typeof hl=="string"){hl=fh[hl];if(!hl){return false}}hi.display.input.ensurePolled();var hk=hi.display.shift,hj=false;try{if(hi.isReadOnly()){hi.state.suppressEdits=true}if(i){hi.display.shift=false}hj=hl(hi)!=cx}finally{hi.display.shift=hk;hi.state.suppressEdits=false}return hj}function eF(hj,hk,hm){for(var hl=0;hl<hj.state.keyMaps.length;hl++){var hi=k(hk,hj.state.keyMaps[hl],hm,hj);if(hi){return hi}}return(hj.options.extraKeys&&k(hk,hj.options.extraKeys,hm,hj))||k(hk,hj.options.keyMap,hm,hj)}var ef=new hh;function bo(hi,hk,hm,hl){var hj=hi.state.keySeq;if(hj){if(fe(hk)){return"handled"}ef.set(50,function(){if(hi.state.keySeq==hj){hi.state.keySeq=null;hi.display.input.reset()}});hk=hj+" "+hk}var i=eF(hi,hk,hl);if(i=="multi"){hi.state.keySeq=hk}if(i=="handled"){am(hi,"keyHandled",hi,hk,hm)}if(i=="handled"||i=="multi"){c5(hm);q(hi)}if(hj&&!i&&/\'$/.test(hk)){c5(hm);return true}return !!i}function f2(i,hj){var hi=ga(hj,true);if(!hi){return false}if(hj.shiftKey&&!i.state.keySeq){return bo(i,"Shift-"+hi,hj,function(hk){return gH(i,hk,true)})||bo(i,hi,hj,function(hk){if(typeof hk=="string"?/^go[A-Z]/.test(hk):hk.motion){return gH(i,hk)}})}else{return bo(i,hi,hj,function(hk){return gH(i,hk)})}}function eQ(i,hj,hi){return bo(i,"'"+hi+"'",hj,function(hk){return gH(i,hk,true)})}var dT=null;function r(hk){var i=this;i.curOp.focus=eh();if(a2(i,hk)){return}if(ed&&m<11&&hk.keyCode==27){hk.returnValue=false}var hi=hk.keyCode;i.display.shift=hi==16||hk.shiftKey;var hj=f2(i,hk);if(ez){dT=hj?hi:null;if(!hj&&hi==88&&!dE&&(cs?hk.metaKey:hk.ctrlKey)){i.replaceSelection("",null,"cut")}}if(hi==18&&!/\bCodeMirror-crosshair\b/.test(i.display.lineDiv.className)){aA(i)}}function aA(hi){var hj=hi.display.lineDiv;gn(hj,"CodeMirror-crosshair");function i(hk){if(hk.keyCode==18||!hk.altKey){h(hj,"CodeMirror-crosshair");eN(document,"keyup",i);eN(document,"mouseover",i)}}ch(document,"keyup",i);ch(document,"mouseover",i)}function bs(i){if(i.keyCode==16){this.doc.sel.shift=false}a2(this,i)}function cW(hl){var i=this;if(bm(i.display,hl)||a2(i,hl)||hl.ctrlKey&&!hl.altKey||cs&&hl.metaKey){return}var hk=hl.keyCode,hi=hl.charCode;if(ez&&hk==dT){dT=null;c5(hl);return}if((ez&&(!hl.which||hl.which<10))&&f2(i,hl)){return}var hj=String.fromCharCode(hi==null?hk:hi);if(hj=="\x08"){return}if(eQ(i,hl,hj)){return}i.display.input.onKeyPress(hl)}var dx=400;var dR=function(hi,hj,i){this.time=hi;this.pos=hj;this.button=i};dR.prototype.compare=function(hi,hj,i){return this.time+dx>hi&&cC(hj,this.pos)==0&&i==this.button};var dS;var dI;function I(hj,hi){var i=+new Date;if(dI&&dI.compare(i,hj,hi)){dS=dI=null;return"triple"}else{if(dS&&dS.compare(i,hj,hi)){dI=new dR(i,hj,hi);dS=null;return"double"}else{dS=new dR(i,hj,hi);dI=null;return"single"}}}function e6(hl){var i=this,hk=i.display;if(a2(i,hl)||hk.activeTouch&&hk.input.supportsTouch()){return}hk.input.ensurePolled();hk.shift=hl.shiftKey;if(bm(hk,hl)){if(!dr){hk.scroller.draggable=false;setTimeout(function(){return hk.scroller.draggable=true},100)}return}if(n(i,hl)){return}var hm=cM(i,hl),hi=gD(hl),hj=hm?I(hm,hi):"single";window.focus();if(hi==1&&i.state.selectingText){i.state.selectingText(hl)}if(hm&&db(i,hi,hm,hj,hl)){return}if(hi==1){if(hm){aE(i,hm,hj,hl)}else{if(Q(hl)==hk.scroller){c5(hl)}}}else{if(hi==2){if(hm){gQ(i.doc,hm)}setTimeout(function(){return hk.input.focus()},20)}else{if(hi==3){if(g7){aF(i,hl)}else{at(i)}}}}}function db(i,hj,hm,hl,hk){var hi="Click";if(hl=="double"){hi="Double"+hi}else{if(hl=="triple"){hi="Triple"+hi}}hi=(hj==1?"Left":hj==2?"Middle":"Right")+hi;return bo(i,gS(hi,hk),hk,function(ho){if(typeof ho=="string"){ho=fh[ho]}if(!ho){return false}var hn=false;try{if(i.isReadOnly()){i.state.suppressEdits=true}hn=ho(i,hm)!=cx}finally{i.state.suppressEdits=false}return hn})}function b1(i,hm,hk){var hi=i.getOption("configureMouse");var hl=hi?hi(i,hm,hk):{};if(hl.unit==null){var hj=gx?hk.shiftKey&&hk.metaKey:hk.altKey;hl.unit=hj?"rectangle":hm=="single"?"char":hm=="double"?"word":"line"}if(hl.extend==null||i.doc.extend){hl.extend=i.doc.extend||hk.shiftKey}if(hl.addNew==null){hl.addNew=cs?hk.metaKey:hk.ctrlKey}if(hl.moveOnDrag==null){hl.moveOnDrag=!(cs?hk.altKey:hk.ctrlKey)}return hl}function aE(i,hn,hm,hk){if(ed){setTimeout(cU(t,i),0)}else{i.curOp.focus=eh()}var hj=b1(i,hm,hk);var hl=i.doc.sel,hi;if(i.options.dragDrop&&fs&&!i.isReadOnly()&&hm=="single"&&(hi=hl.contains(hn))>-1&&(cC((hi=hl.ranges[hi]).from(),hn)<0||hn.xRel>0)&&(cC(hi.to(),hn)>0||hn.xRel<0)){be(i,hk,hn,hj)}else{o(i,hk,hn,hj)}}function be(ho,i,hl,hi){var hk=ho.display,hm=false;var hj=ds(ho,function(hq){if(dr){hk.scroller.draggable=false}ho.state.draggingText=false;eN(document,"mouseup",hj);eN(document,"mousemove",hp);eN(hk.scroller,"dragstart",hn);eN(hk.scroller,"drop",hj);if(!hm){c5(hq);if(!hi.addNew){gQ(ho.doc,hl,null,null,hi.extend)}if(dr||ed&&m==9){setTimeout(function(){document.body.focus();hk.input.focus()},20)}else{hk.input.focus()}}});var hp=function(hq){hm=hm||Math.abs(i.clientX-hq.clientX)+Math.abs(i.clientY-hq.clientY)>=10};var hn=function(){return hm=true};if(dr){hk.scroller.draggable=true}ho.state.draggingText=hj;hj.copy=!hi.moveOnDrag;if(hk.scroller.dragDrop){hk.scroller.dragDrop()}ch(document,"mouseup",hj);ch(document,"mousemove",hp);ch(hk.scroller,"dragstart",hn);ch(hk.scroller,"drop",hj);at(ho);setTimeout(function(){return hk.input.focus()},20)}function en(hi,hk,hj){if(hj=="char"){return new es(hk,hk)}if(hj=="word"){return hi.findWordAt(hk)}if(hj=="line"){return new es(ac(hk.line,0),gy(hi.doc,ac(hk.line+1,0)))}var i=hj(hi,hk);return new es(i.from,i.to)}function o(hk,hw,hj,ho){var hv=hk.display,hz=hk.doc;c5(hw);var hi,hy,hl=hz.sel,i=hl.ranges;if(ho.addNew&&!ho.extend){hy=hz.sel.contains(hj);if(hy>-1){hi=i[hy]}else{hi=new es(hj,hj)}}else{hi=hz.sel.primary();hy=hz.sel.primIndex}if(ho.unit=="rectangle"){if(!ho.addNew){hi=new es(hj,hj)}hj=cM(hk,hw,true,true);hy=-1}else{var hp=en(hk,hj,ho.unit);if(ho.extend){hi=ge(hi,hp.anchor,hp.head,ho.extend)}else{hi=hp}}if(!ho.addNew){hy=0;ce(hz,new gW([hi],0),R);hl=hz.sel}else{if(hy==-1){hy=i.length;ce(hz,cV(i.concat([hi]),hy),{scroll:false,origin:"*mouse"})}else{if(i.length>1&&i[hy].empty()&&ho.unit=="char"&&!ho.extend){ce(hz,cV(i.slice(0,hy).concat(i.slice(hy+1)),0),{scroll:false,origin:"*mouse"});hl=hz.sel}else{e(hz,hy,hi,R)}}}var hu=hj;function ht(hL){if(cC(hu,hL)==0){return}hu=hL;if(ho.unit=="rectangle"){var hC=[],hI=hk.options.tabSize;var hB=cb(fZ(hz,hj.line).text,hj.ch,hI);var hO=cb(fZ(hz,hL.line).text,hL.ch,hI);var hD=Math.min(hB,hO),hM=Math.max(hB,hO);for(var hP=Math.min(hj.line,hL.line),hF=Math.min(hk.lastLine(),Math.max(hj.line,hL.line));hP<=hF;hP++){var hN=fZ(hz,hP).text,hE=e0(hN,hD,hI);if(hD==hM){hC.push(new es(ac(hP,hE),ac(hP,hE)))}else{if(hN.length>hE){hC.push(new es(ac(hP,hE),ac(hP,e0(hN,hM,hI))))}}}if(!hC.length){hC.push(new es(hj,hj))}ce(hz,cV(hl.ranges.slice(0,hy).concat(hC),hy),{origin:"*mouse",scroll:false});hk.scrollIntoView(hL)}else{var hJ=hi;var hH=en(hk,hL,ho.unit);var hG=hJ.anchor,hK;if(cC(hH.anchor,hG)>0){hK=hH.head;hG=az(hJ.from(),hH.anchor)}else{hK=hH.anchor;hG=bP(hJ.to(),hH.head)}var hA=hl.ranges.slice(0);hA[hy]=new es(gy(hz,hG),hK);ce(hz,cV(hA,hy),R)}}var hr=hv.wrapper.getBoundingClientRect();var hm=0;function hx(hC){var hA=++hm;var hE=cM(hk,hC,true,ho.unit=="rectangle");if(!hE){return}if(cC(hE,hu)!=0){hk.curOp.focus=eh();ht(hE);var hD=cr(hv,hz);if(hE.line>=hD.to||hE.line<hD.from){setTimeout(ds(hk,function(){if(hm==hA){hx(hC)}}),150)}}else{var hB=hC.clientY<hr.top?-20:hC.clientY>hr.bottom?20:0;if(hB){setTimeout(ds(hk,function(){if(hm!=hA){return}hv.scroller.scrollTop+=hB;hx(hC)}),50)}}}function hq(hA){hk.state.selectingText=false;hm=Infinity;c5(hA);hv.input.focus();eN(document,"mousemove",hs);eN(document,"mouseup",hn);hz.history.lastSelOrigin=null}var hs=ds(hk,function(hA){if(!gD(hA)){hq(hA)}else{hx(hA)}});var hn=ds(hk,hq);hk.state.selectingText=hn;ch(document,"mousemove",hs);ch(document,"mouseup",hn)}function hg(hs,ho,hq,hr){var hj,hi;try{hj=ho.clientX;hi=ho.clientY}catch(ho){return false}if(hj>=Math.floor(hs.display.gutters.getBoundingClientRect().right)){return false}if(hr){c5(ho)}var hp=hs.display;var hn=hp.lineDiv.getBoundingClientRect();if(hi>hn.bottom||!f4(hs,hq)){return b4(ho)}hi-=hn.top-hp.viewOffset;for(var hl=0;hl<hs.options.gutters.length;++hl){var hm=hp.gutters.childNodes[hl];if(hm&&hm.getBoundingClientRect().right>=hj){var ht=bZ(hs.doc,hi);var hk=hs.options.gutters[hl];aM(hs,hq,hs,ht,hk,ho);return b4(ho)}}}function n(i,hi){return hg(i,hi,"gutterClick",true)}function aF(i,hi){if(bm(i.display,hi)||dL(i,hi)){return}if(a2(i,hi,"contextmenu")){return}i.display.input.onContextMenu(hi)}function dL(i,hi){if(!f4(i,"gutterContextMenu")){return false}return hg(i,hi,"gutterContextMenu",false)}function de(i){i.display.wrapper.className=i.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+i.options.theme.replace(/(^|\s)\s*/g," cm-s-");ar(i)}var cy={toString:function(){return"CodeMirror.Init"}};var fM={};var bq={};function fm(i){var hj=i.optionHandlers;function hi(hk,hn,hm,hl){i.defaults[hk]=hn;if(hm){hj[hk]=hl?function(ho,hq,hp){if(hp!=cy){hm(ho,hq,hp)}}:hm}}i.defineOption=hi;i.Init=cy;hi("value","",function(hk,hl){return hk.setValue(hl)},true);hi("mode",null,function(hk,hl){hk.doc.modeOption=hl;bI(hk)},true);hi("indentUnit",2,bI,true);hi("indentWithTabs",false);hi("smartIndent",true);hi("tabSize",4,function(hk){eV(hk);ar(hk);ap(hk)},true);hi("lineSeparator",null,function(hk,hn){hk.doc.lineSep=hn;if(!hn){return}var hm=[],ho=hk.doc.first;hk.doc.iter(function(hp){for(var hr=0;;){var hq=hp.text.indexOf(hn,hr);if(hq==-1){break}hr=hq+hn.length;hm.push(ac(ho,hq))}ho++});for(var hl=hm.length-1;hl>=0;hl--){bc(hk.doc,hn,hm[hl],ac(hm[hl].line,hm[hl].ch+hn.length))}});hi("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(hk,hm,hl){hk.state.specialChars=new RegExp(hm.source+(hm.test("\t")?"":"|\t"),"g");if(hl!=cy){hk.refresh()}});hi("specialCharPlaceholder",fY,function(hk){return hk.refresh()},true);hi("electricChars",true);hi("inputStyle",eO?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},true);hi("spellcheck",false,function(hk,hl){return hk.getInputField().spellcheck=hl},true);hi("rtlMoveVisually",!aZ);hi("wholeLineUpdateBefore",true);hi("theme","default",function(hk){de(hk);d1(hk)},true);hi("keyMap","default",function(hk,ho,hl){var hm=gP(ho);var hn=hl!=cy&&gP(hl);if(hn&&hn.detach){hn.detach(hk,hm)}if(hm.attach){hm.attach(hk,hn||null)}});hi("extraKeys",null);hi("configureMouse",null);hi("lineWrapping",false,fl,true);hi("gutters",[],function(hk){cB(hk.options);d1(hk)},true);hi("fixedGutter",true,function(hk,hl){hk.display.gutters.style.left=hl?et(hk.display)+"px":"0";hk.refresh()},true);hi("coverGutterNextToScrollbar",false,function(hk){return fI(hk)},true);hi("scrollbarStyle","native",function(hk){aL(hk);fI(hk);hk.display.scrollbars.setScrollTop(hk.doc.scrollTop);hk.display.scrollbars.setScrollLeft(hk.doc.scrollLeft)},true);hi("lineNumbers",false,function(hk){cB(hk.options);d1(hk)},true);hi("firstLineNumber",1,d1,true);hi("lineNumberFormatter",function(hk){return hk},d1,true);hi("showCursorWhenSelecting",false,bU,true);hi("resetSelectionOnContextMenu",true);hi("lineWiseCopyCut",true);hi("pasteLinesPerSelection",true);hi("readOnly",false,function(hk,hl){if(hl=="nocursor"){a6(hk);hk.display.input.blur()}hk.display.input.readOnlyChanged(hl)});hi("disableInput",false,function(hk,hl){if(!hl){hk.display.input.reset()}},true);hi("dragDrop",true,gU);hi("allowDropFileTypes",null);hi("cursorBlinkRate",530);hi("cursorScrollMargin",0);hi("cursorHeight",1,bU,true);hi("singleCursorHeightPerLine",true,bU,true);hi("workTime",100);hi("workDelay",100);hi("flattenSpans",true,eV,true);hi("addModeClass",false,eV,true);hi("pollInterval",100);hi("undoDepth",200,function(hk,hl){return hk.doc.history.undoDepth=hl});hi("historyEventDelay",1250);hi("viewportMargin",10,function(hk){return hk.refresh()},true);hi("maxHighlightLength",10000,eV,true);hi("moveInputWithCursor",true,function(hk,hl){if(!hl){hk.display.input.resetPosition()}});hi("tabindex",null,function(hk,hl){return hk.display.input.getField().tabIndex=hl||""});hi("autofocus",null);hi("direction","ltr",function(hk,hl){return hk.doc.setDirection(hl)},true)}function d1(i){eK(i);ap(i);fj(i)}function gU(hi,hl,hj){var hm=hj&&hj!=cy;if(!hl!=!hm){var hk=hi.display.dragFunctions;var i=hl?ch:eN;i(hi.display.scroller,"dragstart",hk.start);i(hi.display.scroller,"dragenter",hk.enter);i(hi.display.scroller,"dragover",hk.over);i(hi.display.scroller,"dragleave",hk.leave);i(hi.display.scroller,"drop",hk.drop)}}function fl(i){if(i.options.lineWrapping){gn(i.display.wrapper,"CodeMirror-wrap");i.display.sizer.style.minWidth="";i.display.sizerWidth=null}else{h(i.display.wrapper,"CodeMirror-wrap");f(i)}af(i);ap(i);ar(i);setTimeout(function(){return fI(i)},100)}function K(hi,hk){var hp=this;if(!(this instanceof K)){return new K(hi,hk)}this.options=hk=hk?aX(hk):{};aX(fM,hk,false);cB(hk);var ho=hk.value;if(typeof ho=="string"){ho=new aB(ho,hk.mode,null,hk.lineSeparator,hk.direction)}this.doc=ho;var hj=new K.inputStyles[hk.inputStyle](this);var hn=this.display=new fo(hi,ho,hj);hn.wrapper.CodeMirror=this;eK(this);de(this);if(hk.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}aL(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,selectingText:false,draggingText:false,highlight:new hh(),keySeq:null,specialChars:null};if(hk.autofocus&&!eO){hn.input.focus()}if(ed&&m<11){setTimeout(function(){return hp.display.input.reset(true)},20)}gG(this);bu();c9(this);this.curOp.forceUpdate=true;eJ(this,ho);if((hk.autofocus&&!eO)||this.hasFocus()){setTimeout(cU(c0,this),20)}else{a6(this)}for(var hm in bq){if(bq.hasOwnProperty(hm)){bq[hm](hp,hk[hm],cy)}}eC(this);if(hk.finishInit){hk.finishInit(this)}for(var hl=0;hl<bj.length;++hl){bj[hl](hp)}av(this);if(dr&&hk.lineWrapping&&getComputedStyle(hn.lineDiv).textRendering=="optimizelegibility"){hn.lineDiv.style.textRendering="auto"}}K.defaults=fM;K.optionHandlers=bq;function gG(hi){var hm=hi.display;ch(hm.scroller,"mousedown",ds(hi,e6));if(ed&&m<11){ch(hm.scroller,"dblclick",ds(hi,function(hq){if(a2(hi,hq)){return}var hr=cM(hi,hq);if(!hr||n(hi,hq)||bm(hi.display,hq)){return}c5(hq);var hp=hi.findWordAt(hr);gQ(hi.doc,hp.anchor,hp.head)}))}else{ch(hm.scroller,"dblclick",function(hp){return a2(hi,hp)||c5(hp)})}if(!g7){ch(hm.scroller,"contextmenu",function(hp){return aF(hi,hp)})}var ho,i={end:0};function hn(){if(hm.activeTouch){ho=setTimeout(function(){return hm.activeTouch=null},1000);i=hm.activeTouch;i.end=+new Date}}function hk(hp){if(hp.touches.length!=1){return false}var hq=hp.touches[0];return hq.radiusX<=1&&hq.radiusY<=1}function hj(hs,hp){if(hp.left==null){return true}var hr=hp.left-hs.left,hq=hp.top-hs.top;return hr*hr+hq*hq>20*20}ch(hm.scroller,"touchstart",function(hq){if(!a2(hi,hq)&&!hk(hq)){hm.input.ensurePolled();clearTimeout(ho);var hp=+new Date;hm.activeTouch={start:hp,moved:false,prev:hp-i.end<=300?i:null};if(hq.touches.length==1){hm.activeTouch.left=hq.touches[0].pageX;hm.activeTouch.top=hq.touches[0].pageY}}});ch(hm.scroller,"touchmove",function(){if(hm.activeTouch){hm.activeTouch.moved=true}});ch(hm.scroller,"touchend",function(hq){var hs=hm.activeTouch;if(hs&&!bm(hm,hq)&&hs.left!=null&&!hs.moved&&new Date-hs.start<300){var hr=hi.coordsChar(hm.activeTouch,"page"),hp;if(!hs.prev||hj(hs,hs.prev)){hp=new es(hr,hr)}else{if(!hs.prev.prev||hj(hs,hs.prev.prev)){hp=hi.findWordAt(hr)}else{hp=new es(ac(hr.line,0),gy(hi.doc,ac(hr.line+1,0)))}}hi.setSelection(hp.anchor,hp.head);hi.focus();c5(hq)}hn()});ch(hm.scroller,"touchcancel",hn);ch(hm.scroller,"scroll",function(){if(hm.scroller.clientHeight){B(hi,hm.scroller.scrollTop);bW(hi,hm.scroller.scrollLeft,true);aM(hi,"scroll",hi)}});ch(hm.scroller,"mousewheel",function(hp){return c(hi,hp)});ch(hm.scroller,"DOMMouseScroll",function(hp){return c(hi,hp)});ch(hm.wrapper,"scroll",function(){return hm.wrapper.scrollTop=hm.wrapper.scrollLeft=0});hm.dragFunctions={enter:function(hp){if(!a2(hi,hp)){e1(hp)}},over:function(hp){if(!a2(hi,hp)){hf(hi,hp);e1(hp)}},start:function(hp){return U(hi,hp)},drop:ds(hi,bv),leave:function(hp){if(!a2(hi,hp)){dF(hi)}}};var hl=hm.input.getField();ch(hl,"keyup",function(hp){return bs.call(hi,hp)});ch(hl,"keydown",ds(hi,r));ch(hl,"keypress",ds(hi,cW));ch(hl,"focus",function(hp){return c0(hi,hp)});ch(hl,"blur",function(hp){return a6(hi,hp)})}var bj=[];K.defineInitHook=function(i){return bj.push(i)};function ak(hx,hm,hw,hk){var hv=hx.doc,hj;if(hw==null){hw="add"}if(hw=="smart"){if(!hv.mode.indent){hw="prev"}else{hj=fG(hx,hm).state}}var hq=hx.options.tabSize;var hy=fZ(hv,hm),hp=cb(hy.text,null,hq);if(hy.stateAfter){hy.stateAfter=null}var hi=hy.text.match(/^\s*/)[0],ht;if(!hk&&!/\S/.test(hy.text)){ht=0;hw="not"}else{if(hw=="smart"){ht=hv.mode.indent(hj,hy.text.slice(hi.length),hy.text);if(ht==cx||ht>150){if(!hk){return}hw="prev"}}}if(hw=="prev"){if(hm>hv.first){ht=cb(fZ(hv,hm-1).text,null,hq)}else{ht=0}}else{if(hw=="add"){ht=hp+hx.options.indentUnit}else{if(hw=="subtract"){ht=hp-hx.options.indentUnit}else{if(typeof hw=="number"){ht=hp+hw}}}}ht=Math.max(0,ht);var hu="",hs=0;if(hx.options.indentWithTabs){for(var hn=Math.floor(ht/hq);hn;--hn){hs+=hq;hu+="\t"}}if(hs<ht){hu+=cO(ht-hs)}if(hu!=hi){bc(hv,hu,ac(hm,0),ac(hm,hi.length),"+input");hy.stateAfter=null;return true}else{for(var hl=0;hl<hv.sel.ranges.length;hl++){var ho=hv.sel.ranges[hl];if(ho.head.line==hm&&ho.head.ch<hi.length){var hr=ac(hm,hi.length);e(hv,hl,new es(hr,hr));break}}}}var bx=null;function dy(i){bx=i}function gR(hx,hn,hl,hk,hw){var hv=hx.doc;hx.display.shift=false;if(!hk){hk=hv.sel}var hm=hx.state.pasteIncoming||hw=="paste";var hq=gI(hn),hi=null;if(hm&&hk.ranges.length>1){if(bx&&bx.text.join("\n")==hn){if(hk.ranges.length%bx.text.length==0){hi=[];for(var ho=0;ho<bx.text.length;ho++){hi.push(hv.splitLines(bx.text[ho]))}}}else{if(hq.length==hk.ranges.length&&hx.options.pasteLinesPerSelection){hi=cd(hq,function(i){return[i]})}}}var hr;for(var hj=hk.ranges.length-1;hj>=0;hj--){var hp=hk.ranges[hj];var hu=hp.from(),ht=hp.to();if(hp.empty()){if(hl&&hl>0){hu=ac(hu.line,hu.ch-hl)}else{if(hx.state.overwrite&&!hm){ht=ac(ht.line,Math.min(fZ(hv,ht.line).text.length,ht.ch+gt(hq).length))}else{if(bx&&bx.lineWise&&bx.text.join("\n")==hn){hu=ht=ac(hu.line,0)}}}}hr=hx.curOp.updateInput;var hs={from:hu,to:ht,text:hi?hi[hj%hi.length]:hq,origin:hw||(hm?"paste":hx.state.cutIncoming?"cut":"+input")};br(hx.doc,hs);am(hx,"inputRead",hx,hs)}if(hn&&!hm){gO(hx,hn)}gs(hx);hx.curOp.updateInput=hr;hx.curOp.typing=true;hx.state.pasteIncoming=hx.state.cutIncoming=false}function bl(hj,i){var hi=hj.clipboardData&&hj.clipboardData.getData("Text");if(hi){hj.preventDefault();if(!i.isReadOnly()&&!i.options.disableInput){dd(i,function(){return gR(i,hi,0,null,"paste")})}return true}}function gO(hi,hm){if(!hi.options.electricChars||!hi.options.smartIndent){return}var hn=hi.doc.sel;for(var hl=hn.ranges.length-1;hl>=0;hl--){var hj=hn.ranges[hl];if(hj.head.ch>100||(hl&&hn.ranges[hl-1].head.line==hj.head.line)){continue}var ho=hi.getModeAt(hj.head);var hp=false;if(ho.electricChars){for(var hk=0;hk<ho.electricChars.length;hk++){if(hm.indexOf(ho.electricChars.charAt(hk))>-1){hp=ak(hi,hj.head.line,"smart");break}}}else{if(ho.electricInput){if(ho.electricInput.test(fZ(hi.doc,hj.head.line).text.slice(0,hj.head.ch))){hp=ak(hi,hj.head.line,"smart")}}}if(hp){am(hi,"electricInput",hi,hj.head.line)}}}function dM(hi){var hn=[],hk=[];for(var hl=0;hl<hi.doc.sel.ranges.length;hl++){var hj=hi.doc.sel.ranges[hl].head.line;var hm={anchor:ac(hj,0),head:ac(hj+1,0)};hk.push(hm);hn.push(hi.getRange(hm.anchor,hm.head))}return{text:hn,ranges:hk}}function gE(hi,i){hi.setAttribute("autocorrect","off");hi.setAttribute("autocapitalize","off");hi.setAttribute("spellcheck",!!i)}function a8(){var i=gX("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none");var hi=gX("div",[i],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(dr){i.style.width="1000px"}else{i.setAttribute("wrap","off")}if(fL){i.style.border="1px solid black"}gE(i);return hi}function ei(i){var hi=i.optionHandlers;var hj=i.helpers={};i.prototype={constructor:i,focus:function(){window.focus();this.display.input.focus()},setOption:function(hm,hn){var hl=this.options,hk=hl[hm];if(hl[hm]==hn&&hm!="mode"){return}hl[hm]=hn;if(hi.hasOwnProperty(hm)){ds(this,hi[hm])(this,hn,hk)}aM(this,"optionChange",this,hm)},getOption:function(hk){return this.options[hk]},getDoc:function(){return this.doc},addKeyMap:function(hl,hk){this.state.keyMaps[hk?"push":"unshift"](gP(hl))},removeKeyMap:function(hl){var hm=this.state.keyMaps;for(var hk=0;hk<hm.length;++hk){if(hm[hk]==hl||hm[hk].name==hl){hm.splice(hk,1);return true}}},addOverlay:dC(function(hk,hl){var hm=hk.token?hk:i.getMode(this.options,hk);if(hm.startState){throw new Error("Overlays may not be stateful.")}cv(this.state.overlays,{mode:hm,modeSpec:hk,opaque:hl&&hl.opaque,priority:(hl&&hl.priority)||0},function(hn){return hn.priority});this.state.modeGen++;ap(this)}),removeOverlay:dC(function(hk){var ho=this;var hm=this.state.overlays;for(var hl=0;hl<hm.length;++hl){var hn=hm[hl].modeSpec;if(hn==hk||typeof hk=="string"&&hn.name==hk){hm.splice(hl,1);ho.state.modeGen++;ap(ho);return}}}),indentLine:dC(function(hm,hk,hl){if(typeof hk!="string"&&typeof hk!="number"){if(hk==null){hk=this.options.smartIndent?"smart":"prev"}else{hk=hk?"add":"subtract"}}if(cu(this.doc,hm)){ak(this,hm,hk,hl)}}),indentSelection:dC(function(hu){var hq=this;var hk=this.doc.sel.ranges,hn=-1;for(var hp=0;hp<hk.length;hp++){var hr=hk[hp];if(!hr.empty()){var hs=hr.from(),ht=hr.to();var hl=Math.max(hn,hs.line);hn=Math.min(hq.lastLine(),ht.line-(ht.ch?0:1))+1;for(var ho=hl;ho<hn;++ho){ak(hq,ho,hu)}var hm=hq.doc.sel.ranges;if(hs.ch==0&&hk.length==hm.length&&hm[hp].from().ch>0){e(hq.doc,hp,new es(hs,hm[hp].to()),ah)}}else{if(hr.head.line>hn){ak(hq,hr.head.line,hu,true);hn=hr.head.line;if(hp==hq.doc.sel.primIndex){gs(hq)}}}}}),getTokenAt:function(hl,hk){return cP(this,hl,hk)},getLineTokens:function(hl,hk){return cP(this,ac(hl),hk,true)},getTokenTypeAt:function(hr){hr=gy(this.doc,hr);var hn=dA(this,fZ(this.doc,hr.line));var hp=0,hq=(hn.length-1)/2,hm=hr.ch;var hl;if(hm==0){hl=hn[2]}else{for(;;){var hk=(hp+hq)>>1;if((hk?hn[hk*2-1]:0)>=hm){hq=hk}else{if(hn[hk*2+1]<hm){hp=hk+1}else{hl=hn[hk*2+2];break}}}}var ho=hl?hl.indexOf("overlay "):-1;return ho<0?hl:ho==0?null:hl.slice(0,ho-1)},getModeAt:function(hl){var hk=this.doc.mode;if(!hk.innerMode){return hk}return i.innerMode(hk,this.getTokenAt(hl).state).mode},getHelper:function(hl,hk){return this.getHelpers(hl,hk)[0]},getHelpers:function(hr,hq){var ho=this;var ht=[];if(!hj.hasOwnProperty(hq)){return ht}var hm=hj[hq],hp=this.getModeAt(hr);if(typeof hp[hq]=="string"){if(hm[hp[hq]]){ht.push(hm[hp[hq]])}}else{if(hp[hq]){for(var hn=0;hn<hp[hq].length;hn++){var hl=hm[hp[hq][hn]];if(hl){ht.push(hl)}}}else{if(hp.helperType&&hm[hp.helperType]){ht.push(hm[hp.helperType])}else{if(hm[hp.name]){ht.push(hm[hp.name])}}}}for(var hk=0;hk<hm._global.length;hk++){var hs=hm._global[hk];if(hs.pred(hp,ho)&&dN(ht,hs.val)==-1){ht.push(hs.val)}}return ht},getStateAfter:function(hl,hk){var hm=this.doc;hl=dw(hm,hl==null?hm.first+hm.size-1:hl);return fG(this,hl+1,hk).state},cursorCoords:function(hn,hl){var hm,hk=this.doc.sel.primary();if(hn==null){hm=hk.head}else{if(typeof hn=="object"){hm=gy(this.doc,hn)}else{hm=hn?hk.from():hk.to()}}return ep(this,hm,hl||"page")},charCoords:function(hl,hk){return da(this,gy(this.doc,hl),hk||"page")},coordsChar:function(hk,hl){hk=hd(this,hk,hl||"page");return gF(this,hk.left,hk.top)},lineAtHeight:function(hk,hl){hk=hd(this,{top:hk,left:0},hl||"page").top;return bZ(this.doc,hk+this.display.viewOffset)},heightAtLine:function(hl,hp,ho){var hk=false,hm;if(typeof hl=="number"){var hn=this.doc.first+this.doc.size-1;if(hl<this.doc.first){hl=this.doc.first}else{if(hl>hn){hl=hn;hk=true}}hm=fZ(this.doc,hl)}else{hm=hl}return fy(this,hm,{top:0,left:0},hp||"page",ho||hk).top+(hk?this.doc.height-b5(hm):0)},defaultTextHeight:function(){return a9(this.display)},defaultCharWidth:function(){return d6(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(hp,hm,hr,hn,ht){var ho=this.display;hp=ep(this,gy(this.doc,hp));var hq=hp.bottom,hl=hp.left;hm.style.position="absolute";hm.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(hm);ho.sizer.appendChild(hm);if(hn=="over"){hq=hp.top}else{if(hn=="above"||hn=="near"){var hk=Math.max(ho.wrapper.clientHeight,this.doc.height),hs=Math.max(ho.sizer.clientWidth,ho.lineSpace.clientWidth);if((hn=="above"||hp.bottom+hm.offsetHeight>hk)&&hp.top>hm.offsetHeight){hq=hp.top-hm.offsetHeight}else{if(hp.bottom+hm.offsetHeight<=hk){hq=hp.bottom}}if(hl+hm.offsetWidth>hs){hl=hs-hm.offsetWidth}}}hm.style.top=hq+"px";hm.style.left=hm.style.right="";if(ht=="right"){hl=ho.sizer.clientWidth-hm.offsetWidth;hm.style.right="0px"}else{if(ht=="left"){hl=0}else{if(ht=="middle"){hl=(ho.sizer.clientWidth-hm.offsetWidth)/2}}hm.style.left=hl+"px"}if(hr){H(this,{left:hl,top:hq,right:hl+hm.offsetWidth,bottom:hq+hm.offsetHeight})}},triggerOnKeyDown:dC(r),triggerOnKeyPress:dC(cW),triggerOnKeyUp:bs,triggerOnMouseDown:dC(e6),execCommand:function(hk){if(fh.hasOwnProperty(hk)){return fh[hk].call(null,this)}},triggerElectric:dC(function(hk){gO(this,hk)}),findPosH:function(hr,hn,ho,hl){var hq=this;var hk=1;if(hn<0){hk=-1;hn=-hn}var hp=gy(this.doc,hr);for(var hm=0;hm<hn;++hm){hp=bN(hq.doc,hp,hk,ho,hl);if(hp.hitSide){break}}return hp},moveH:dC(function(hk,hl){var hm=this;this.extendSelectionsBy(function(hn){if(hm.display.shift||hm.doc.extend||hn.empty()){return bN(hm.doc,hn.head,hk,hl,hm.options.rtlMoveVisually)}else{return hk<0?hn.from():hn.to()}},dm)}),deleteH:dC(function(hk,hl){var hm=this.doc.sel,hn=this.doc;if(hm.somethingSelected()){hn.replaceSelection("",null,"+delete")}else{fH(this,function(hp){var ho=bN(hn,hp.head,hk,hl,false);return hk<0?{from:ho,to:hp.head}:{from:hp.head,to:ho}})}}),findPosV:function(hq,hn,hr,ht){var hm=this;var hk=1,hp=ht;if(hn<0){hk=-1;hn=-hn}var hs=gy(this.doc,hq);for(var hl=0;hl<hn;++hl){var ho=ep(hm,hs,"div");if(hp==null){hp=ho.left}else{ho.left=hp}hs=bH(hm,ho,hk,hr);if(hs.hitSide){break}}return hs},moveV:dC(function(hk,hm){var hq=this;var ho=this.doc,hn=[];var hp=!this.display.shift&&!ho.extend&&ho.sel.somethingSelected();ho.extendSelectionsBy(function(hr){if(hp){return hk<0?hr.from():hr.to()}var ht=ep(hq,hr.head,"div");if(hr.goalColumn!=null){ht.left=hr.goalColumn}hn.push(ht.left);var hs=bH(hq,ht,hk,hm);if(hm=="page"&&hr==ho.sel.primary()){c7(hq,da(hq,hs,"div").top-ht.top)}return hs},dm);if(hn.length){for(var hl=0;hl<ho.sel.ranges.length;hl++){ho.sel.ranges[hl].goalColumn=hn[hl]}}}),findWordAt:function(hr){var hp=this.doc,hn=fZ(hp,hr.line).text;var hq=hr.ch,hm=hr.ch;if(hn){var ho=this.getHelper(hr,"wordChars");if((hr.sticky=="before"||hm==hn.length)&&hq){--hq}else{++hm}var hl=hn.charAt(hq);var hk=cZ(hl,ho)?function(hs){return cZ(hs,ho)}:/\s/.test(hl)?function(hs){return/\s/.test(hs)}:function(hs){return(!/\s/.test(hs)&&!cZ(hs))};while(hq>0&&hk(hn.charAt(hq-1))){--hq}while(hm<hn.length&&hk(hn.charAt(hm))){++hm}}return new es(ac(hr.line,hq),ac(hr.line,hm))},toggleOverwrite:function(hk){if(hk!=null&&hk==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){gn(this.display.cursorDiv,"CodeMirror-overwrite")}else{h(this.display.cursorDiv,"CodeMirror-overwrite")}aM(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==eh()},isReadOnly:function(){return !!(this.options.readOnly||this.doc.cantEdit)},scrollTo:dC(function(hk,hl){ft(this,hk,hl)}),getScrollInfo:function(){var hk=this.display.scroller;return{left:hk.scrollLeft,top:hk.scrollTop,height:hk.scrollHeight-dj(this)-this.display.barHeight,width:hk.scrollWidth-dj(this)-this.display.barWidth,clientHeight:dl(this),clientWidth:dQ(this)}},scrollIntoView:dC(function(hk,hl){if(hk==null){hk={from:this.doc.sel.primary().head,to:null};if(hl==null){hl=this.options.cursorScrollMargin}}else{if(typeof hk=="number"){hk={from:ac(hk,0),to:null}}else{if(hk.from==null){hk={from:hk,to:null}}}}if(!hk.to){hk.to=hk.from}hk.margin=hl||0;if(hk.from.line!=null){cz(this,hk)}else{b9(this,hk.from,hk.to,hk.margin)}}),setSize:dC(function(hm,hk){var ho=this;var hl=function(hp){return typeof hp=="number"||/^\d+$/.test(String(hp))?hp+"px":hp};if(hm!=null){this.display.wrapper.style.width=hl(hm)}if(hk!=null){this.display.wrapper.style.height=hl(hk)}if(this.options.lineWrapping){aY(this)}var hn=this.display.viewFrom;this.doc.iter(hn,this.display.viewTo,function(hp){if(hp.widgets){for(var hq=0;hq<hp.widgets.length;hq++){if(hp.widgets[hq].noHScroll){W(ho,hn,"widget");break}}}++hn});this.curOp.forceUpdate=true;aM(this,"refresh",this)}),operation:function(hk){return dd(this,hk)},refresh:dC(function(){var hk=this.display.cachedTextHeight;ap(this);this.curOp.forceUpdate=true;ar(this);ft(this,this.doc.scrollLeft,this.doc.scrollTop);dv(this);if(hk==null||Math.abs(hk-a9(this.display))>0.5){af(this)}aM(this,"refresh",this)}),swapDoc:dC(function(hl){var hk=this.doc;hk.cm=null;eJ(this,hl);ar(this);this.display.input.reset();ft(this,hl.scrollLeft,hl.scrollTop);this.curOp.forceScroll=true;am(this,"swapDoc",this,hk);return hk}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};bR(i);i.registerHelper=function(hl,hk,hm){if(!hj.hasOwnProperty(hl)){hj[hl]=i[hl]={_global:[]}}hj[hl][hk]=hm};i.registerGlobalHelper=function(hm,hl,hk,hn){i.registerHelper(hm,hl,hn);hj[hm]._global.push({pred:hk,val:hn})}}function bN(ht,hs,hk,hu,hi){var hl=hs;var hp=hk;var ho=fZ(ht,hs.line);function i(){var hy=hs.line+hk;if(hy<ht.first||hy>=ht.first+ht.size){return false}hs=new ac(hy,hs.ch,hs.sticky);return ho=fZ(ht,hy)}function hm(hz){var hy;if(hi){hy=v(ht.cm,ho,hs,hk)}else{hy=aq(ho,hs,hk)}if(hy==null){if(!hz&&i()){hs=fd(hi,ht.cm,ho,hs.line,hk)}else{return false}}else{hs=hy}return true}if(hu=="char"){hm()}else{if(hu=="column"){hm(true)}else{if(hu=="word"||hu=="group"){var hr=null,hw=hu=="group";var hj=ht.cm&&ht.cm.getHelper(hs,"wordChars");for(var hn=true;;hn=false){if(hk<0&&!hm(!hn)){break}var hv=ho.text.charAt(hs.ch)||"\n";var hq=cZ(hv,hj)?"w":hw&&hv=="\n"?"n":!hw||/\s/.test(hv)?null:"p";if(hw&&!hn&&!hq){hq="s"}if(hr&&hr!=hq){if(hk<0){hk=1;hm();hs.sticky="after"}break}if(hq){hr=hq}if(hk>0&&!hm(!hn)){break}}}}}var hx=cf(ht,hs,hl,hp,true);if(ad(hl,hx)){hx.hitSide=true}return hx}function bH(hq,hl,hi,hp){var ho=hq.doc,hn=hl.left,hm;if(hp=="page"){var hk=Math.min(hq.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);var i=Math.max(hk-0.5*a9(hq.display),3);hm=(hi>0?hl.bottom:hl.top)+hi*i}else{if(hp=="line"){hm=hi>0?hl.bottom+3:hl.top-3}}var hj;for(;;){hj=gF(hq,hn,hm);if(!hj.outside){break}if(hi<0?hm<=0:hm>=ho.height){hj.hitSide=true;break}hm+=hi*5}return hj}var dZ=function(i){this.cm=i;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new hh();this.composing=null;this.gracePeriod=false;this.readDOMTimeout=null};dZ.prototype.init=function(hk){var hm=this;var hj=this,i=hj.cm;var hl=hj.div=hk.lineDiv;gE(hl,i.options.spellcheck);ch(hl,"paste",function(hn){if(a2(i,hn)||bl(hn,i)){return}if(m<=11){setTimeout(ds(i,function(){return hm.updateFromDOM()}),20)}});ch(hl,"compositionstart",function(hn){hm.composing={data:hn.data,done:false}});ch(hl,"compositionupdate",function(hn){if(!hm.composing){hm.composing={data:hn.data,done:false}}});ch(hl,"compositionend",function(hn){if(hm.composing){if(hn.data!=hm.composing.data){hm.readFromDOMSoon()}hm.composing.done=true}});ch(hl,"touchstart",function(){return hj.forceCompositionEnd()});ch(hl,"input",function(){if(!hm.composing){hm.readFromDOMSoon()}});function hi(hr){if(a2(i,hr)){return}if(i.somethingSelected()){dy({lineWise:false,text:i.getSelections()});if(hr.type=="cut"){i.replaceSelection("",null,"cut")}}else{if(!i.options.lineWiseCopyCut){return}else{var ho=dM(i);dy({lineWise:true,text:ho.text});if(hr.type=="cut"){i.operation(function(){i.setSelections(ho.ranges,0,ah);i.replaceSelection("",null,"cut")})}}}if(hr.clipboardData){hr.clipboardData.clearData();var hq=bx.text.join("\n");hr.clipboardData.setData("Text",hq);if(hr.clipboardData.getData("Text")==hq){hr.preventDefault();return}}var hp=a8(),hs=hp.firstChild;i.display.lineSpace.insertBefore(hp,i.display.lineSpace.firstChild);hs.value=bx.text.join("\n");var hn=document.activeElement;ee(hs);setTimeout(function(){i.display.lineSpace.removeChild(hp);hn.focus();if(hn==hl){hj.showPrimarySelection()}},50)}ch(hl,"copy",hi);ch(hl,"cut",hi)};dZ.prototype.prepareSelection=function(){var i=gw(this.cm,false);i.focus=this.cm.state.focused;return i};dZ.prototype.showSelection=function(hi,i){if(!hi||!this.cm.display.view.length){return}if(hi.focus||i){this.showPrimarySelection()}this.showMultipleSelections(hi)};dZ.prototype.showPrimarySelection=function(){var hl=window.getSelection(),hv=this.cm,ho=hv.doc.sel.primary();var ht=ho.from(),hu=ho.to();if(hv.display.viewTo==hv.display.viewFrom||ht.line>=hv.display.viewTo||hu.line<hv.display.viewFrom){hl.removeAllRanges();return}var hm=aG(hv,hl.anchorNode,hl.anchorOffset);var hq=aG(hv,hl.focusNode,hl.focusOffset);if(hm&&!hm.bad&&hq&&!hq.bad&&cC(az(hm,hq),ht)==0&&cC(bP(hm,hq),hu)==0){return}var hs=hv.display.view;var hk=(ht.line>=hv.display.viewFrom&&cY(hv,ht))||{node:hs[0].measure.map[2],offset:0};var hp=hu.line<hv.display.viewTo&&cY(hv,hu);if(!hp){var hj=hs[hs.length-1].measure;var hi=hj.maps?hj.maps[hj.maps.length-1]:hj.map;hp={node:hi[hi.length-1],offset:hi[hi.length-2]-hi[hi.length-3]}}if(!hk||!hp){hl.removeAllRanges();return}var hn=hl.rangeCount&&hl.getRangeAt(0),i;try{i=cK(hk.node,hk.offset,hp.offset,hp.node)}catch(hr){}if(i){if(!cN&&hv.state.focused){hl.collapse(hk.node,hk.offset);if(!i.collapsed){hl.removeAllRanges();hl.addRange(i)}}else{hl.removeAllRanges();hl.addRange(i)}if(hn&&hl.anchorNode==null){hl.addRange(hn)}else{if(cN){this.startGracePeriod()}}}this.rememberSelection()};dZ.prototype.startGracePeriod=function(){var i=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){i.gracePeriod=false;if(i.selectionChanged()){i.cm.operation(function(){return i.cm.curOp.selectionChanged=true})}},20)};dZ.prototype.showMultipleSelections=function(i){cc(this.cm.display.cursorDiv,i.cursors);cc(this.cm.display.selectionDiv,i.selection)};dZ.prototype.rememberSelection=function(){var i=window.getSelection();this.lastAnchorNode=i.anchorNode;this.lastAnchorOffset=i.anchorOffset;this.lastFocusNode=i.focusNode;this.lastFocusOffset=i.focusOffset};dZ.prototype.selectionInEditor=function(){var hi=window.getSelection();if(!hi.rangeCount){return false}var i=hi.getRangeAt(0).commonAncestorContainer;return g8(this.div,i)};dZ.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"){if(!this.selectionInEditor()){this.showSelection(this.prepareSelection(),true)}this.div.focus()}};dZ.prototype.blur=function(){this.div.blur()};dZ.prototype.getField=function(){return this.div};dZ.prototype.supportsTouch=function(){return true};dZ.prototype.receivedFocus=function(){var i=this;if(this.selectionInEditor()){this.pollSelection()}else{dd(this.cm,function(){return i.cm.curOp.selectionChanged=true})}function hi(){if(i.cm.state.focused){i.pollSelection();i.polling.set(i.cm.options.pollInterval,hi)}}this.polling.set(this.cm.options.pollInterval,hi)};dZ.prototype.selectionChanged=function(){var i=window.getSelection();return i.anchorNode!=this.lastAnchorNode||i.anchorOffset!=this.lastAnchorOffset||i.focusNode!=this.lastFocusNode||i.focusOffset!=this.lastFocusOffset};dZ.prototype.pollSelection=function(){if(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged()){return}var hk=window.getSelection(),i=this.cm;if(aW&&dH&&this.cm.options.gutters.length&&gZ(hk.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs});this.blur();this.focus();return}if(this.composing){return}this.rememberSelection();var hi=aG(i,hk.anchorNode,hk.anchorOffset);var hj=aG(i,hk.focusNode,hk.focusOffset);if(hi&&hj){dd(i,function(){ce(i.doc,fz(hi,hj),ah);if(hi.bad||hj.bad){i.curOp.selectionChanged=true}})}};dZ.prototype.pollContent=function(){if(this.readDOMTimeout!=null){clearTimeout(this.readDOMTimeout);this.readDOMTimeout=null}var hr=this.cm,hB=hr.display,hz=hr.doc.sel.primary();var hA=hz.from(),hl=hz.to();if(hA.ch==0&&hA.line>hr.firstLine()){hA=ac(hA.line-1,fZ(hr.doc,hA.line-1).length)}if(hl.ch==fZ(hr.doc,hl.line).text.length&&hl.line<hr.lastLine()){hl=ac(hl.line+1,0)}if(hA.line<hB.viewFrom||hl.line>hB.viewTo-1){return false}var ho,hm,hq;if(hA.line==hB.viewFrom||(ho=dW(hr,hA.line))==0){hm=b6(hB.view[0].line);hq=hB.view[0].node}else{hm=b6(hB.view[ho].line);hq=hB.view[ho-1].node.nextSibling}var hy=dW(hr,hl.line);var ht,hw;if(hy==hB.view.length-1){ht=hB.viewTo-1;hw=hB.lineDiv.lastChild}else{ht=b6(hB.view[hy+1].line)-1;hw=hB.view[hy+1].node.previousSibling}if(!hq){return false}var hC=hr.doc.splitLines(gT(hr,hq,hw,hm,ht));var hv=g0(hr.doc,ac(hm,0),ac(ht,fZ(hr.doc,ht).text.length));while(hC.length>1&&hv.length>1){if(gt(hC)==gt(hv)){hC.pop();hv.pop();ht--}else{if(hC[0]==hv[0]){hC.shift();hv.shift();hm++}else{break}}}var hx=0,hj=0;var hs=hC[0],hi=hv[0],i=Math.min(hs.length,hi.length);while(hx<i&&hs.charCodeAt(hx)==hi.charCodeAt(hx)){++hx}var hp=gt(hC),hD=gt(hv);var hk=Math.min(hp.length-(hC.length==1?hx:0),hD.length-(hv.length==1?hx:0));while(hj<hk&&hp.charCodeAt(hp.length-hj-1)==hD.charCodeAt(hD.length-hj-1)){++hj}if(hC.length==1&&hv.length==1&&hm==hA.line){while(hx&&hx>hA.ch&&hp.charCodeAt(hp.length-hj-1)==hD.charCodeAt(hD.length-hj-1)){hx--;hj++}}hC[hC.length-1]=hp.slice(0,hp.length-hj).replace(/^\u200b+/,"");hC[0]=hC[0].slice(hx).replace(/\u200b+$/,"");var hn=ac(hm,hx);var hu=ac(ht,hv.length?gt(hv).length-hj:0);if(hC.length>1||hC[0]||cC(hn,hu)){bc(hr.doc,hC,hn,hu,"+input");return true}};dZ.prototype.ensurePolled=function(){this.forceCompositionEnd()};dZ.prototype.reset=function(){this.forceCompositionEnd()};dZ.prototype.forceCompositionEnd=function(){if(!this.composing){return}clearTimeout(this.readDOMTimeout);this.composing=null;this.updateFromDOM();this.div.blur();this.div.focus()};dZ.prototype.readFromDOMSoon=function(){var i=this;if(this.readDOMTimeout!=null){return}this.readDOMTimeout=setTimeout(function(){i.readDOMTimeout=null;if(i.composing){if(i.composing.done){i.composing=null}else{return}}i.updateFromDOM()},80)};dZ.prototype.updateFromDOM=function(){var i=this;if(this.cm.isReadOnly()||!this.pollContent()){dd(this.cm,function(){return ap(i.cm)})}};dZ.prototype.setUneditable=function(i){i.contentEditable="false"};dZ.prototype.onKeyPress=function(i){if(i.charCode==0){return}i.preventDefault();if(!this.cm.isReadOnly()){ds(this.cm,gR)(this.cm,String.fromCharCode(i.charCode==null?i.keyCode:i.charCode),0)}};dZ.prototype.readOnlyChanged=function(i){this.div.contentEditable=String(i!="nocursor")};dZ.prototype.onContextMenu=function(){};dZ.prototype.resetPosition=function(){};dZ.prototype.needsContentAttribute=true;function cY(hn,hl){var hm=fW(hn,hl.line);if(!hm||hm.hidden){return null}var hp=fZ(hn.doc,hl.line);var hi=cS(hm,hp,hl.line);var hj=a(hp,hn.doc.direction),hk="left";if(hj){var i=aQ(hj,hl.ch);hk=i%2?"right":"left"}var ho=aT(hi.map,hl.ch,hk);ho.offset=ho.collapse=="right"?ho.end:ho.start;return ho}function gZ(hi){for(var i=hi;i;i=i.parentNode){if(/CodeMirror-gutter-wrapper/.test(i.className)){return true}}return false}function e2(hi,i){if(i){hi.bad=true}return hi}function gT(hp,hn,ho,hk,hi){var hr="",hj=false,i=hp.doc.lineSeparator();function hl(ht){return function(hu){return hu.id==ht}}function hs(){if(hj){hr+=i;hj=false}}function hq(ht){if(ht){hs();hr+=ht}}function hm(hy){if(hy.nodeType==1){var hv=hy.getAttribute("cm-text");if(hv!=null){hq(hv||hy.textContent.replace(/\u200b/g,""));return}var hx=hy.getAttribute("cm-marker"),hu;if(hx){var hz=hp.findMarks(ac(hk,0),ac(hi+1,0),hl(+hx));if(hz.length&&(hu=hz[0].find())){hq(g0(hp.doc,hu.from,hu.to).join(i))}return}if(hy.getAttribute("contenteditable")=="false"){return}var ht=/^(pre|div|p)$/i.test(hy.nodeName);if(ht){hs()}for(var hw=0;hw<hy.childNodes.length;hw++){hm(hy.childNodes[hw])}if(ht){hj=true}}else{if(hy.nodeType==3){hq(hy.nodeValue)}}}for(;;){hm(hn);if(hn==ho){break}hn=hn.nextSibling}return hr}function aG(hi,hl,hn){var hm;if(hl==hi.display.lineDiv){hm=hi.display.lineDiv.childNodes[hn];if(!hm){return e2(hi.clipPos(ac(hi.display.viewTo-1)),true)}hl=null;hn=0}else{for(hm=hl;;hm=hm.parentNode){if(!hm||hm==hi.display.lineDiv){return null}if(hm.parentNode&&hm.parentNode==hi.display.lineDiv){break}}}for(var hk=0;hk<hi.display.view.length;hk++){var hj=hi.display.view[hk];if(hj.node==hm){return ai(hj,hl,hn)}}}function ai(hq,hm,ho){var hj=hq.text.firstChild,hl=false;if(!hm||!g8(hj,hm)){return e2(ac(b6(hq.line),0),true)}if(hm==hj){hl=true;hm=hj.childNodes[ho];ho=0;if(!hm){var hw=hq.rest?gt(hq.rest):hq.line;return e2(ac(b6(hw),hw.text.length),hl)}}var hn=hm.nodeType==3?hm:null,hu=hm;if(!hn&&hm.childNodes.length==1&&hm.firstChild.nodeType==3){hn=hm.firstChild;if(ho){ho=hn.nodeValue.length}}while(hu.parentNode!=hj){hu=hu.parentNode}var hi=hq.measure,hs=hi.maps;function hp(hz,hE,hB){for(var hD=-1;hD<(hs?hs.length:0);hD++){var hy=hD<0?hi.map:hs[hD];for(var hC=0;hC<hy.length;hC+=3){var hA=hy[hC+2];if(hA==hz||hA==hE){var hF=b6(hD<0?hq.line:hq.rest[hD]);var hx=hy[hC]+hB;if(hB<0||hA!=hz){hx=hy[hC+(hB?1:0)]}return ac(hF,hx)}}}}var hv=hp(hn,hu,ho);if(hv){return e2(hv,hl)}for(var i=hu.nextSibling,hr=hn?hn.nodeValue.length-ho:0;i;i=i.nextSibling){hv=hp(i,i.firstChild,0);if(hv){return e2(ac(hv.line,hv.ch-hr),hl)}else{hr+=i.textContent.length}}for(var ht=hu.previousSibling,hk=ho;ht;ht=ht.previousSibling){hv=hp(ht,ht.firstChild,-1);if(hv){return e2(ac(hv.line,hv.ch+hk),hl)}else{hk+=ht.textContent.length}}}var ae=function(i){this.cm=i;this.prevInput="";this.pollingFast=false;this.polling=new hh();this.inaccurateSelection=false;this.hasSelection=false;this.composing=null};ae.prototype.init=function(hj){var hn=this;var hi=this,i=this.cm;var hm=this.wrapper=a8();var hk=this.textarea=hm.firstChild;hj.wrapper.insertBefore(hm,hj.wrapper.firstChild);if(fL){hk.style.width="0px"}ch(hk,"input",function(){if(ed&&m>=9&&hn.hasSelection){hn.hasSelection=null}hi.poll()});ch(hk,"paste",function(ho){if(a2(i,ho)||bl(ho,i)){return}i.state.pasteIncoming=true;hi.fastPoll()});function hl(hp){if(a2(i,hp)){return}if(i.somethingSelected()){dy({lineWise:false,text:i.getSelections()});if(hi.inaccurateSelection){hi.prevInput="";hi.inaccurateSelection=false;hk.value=bx.text.join("\n");ee(hk)}}else{if(!i.options.lineWiseCopyCut){return}else{var ho=dM(i);dy({lineWise:true,text:ho.text});if(hp.type=="cut"){i.setSelections(ho.ranges,null,ah)}else{hi.prevInput="";hk.value=ho.text.join("\n");ee(hk)}}}if(hp.type=="cut"){i.state.cutIncoming=true}}ch(hk,"cut",hl);ch(hk,"copy",hl);ch(hj.scroller,"paste",function(ho){if(bm(hj,ho)||a2(i,ho)){return}i.state.pasteIncoming=true;hi.focus()});ch(hj.lineSpace,"selectstart",function(ho){if(!bm(hj,ho)){c5(ho)}});ch(hk,"compositionstart",function(){var ho=i.getCursor("from");if(hi.composing){hi.composing.range.clear()}hi.composing={start:ho,range:i.markText(ho,i.getCursor("to"),{className:"CodeMirror-composing"})}});ch(hk,"compositionend",function(){if(hi.composing){hi.poll();hi.composing.range.clear();hi.composing=null}})};ae.prototype.prepareSelection=function(){var hi=this.cm,hm=hi.display,hl=hi.doc;var i=gw(hi);if(hi.options.moveInputWithCursor){var hn=ep(hi,hl.sel.primary().head,"div");var hj=hm.wrapper.getBoundingClientRect(),hk=hm.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(hm.wrapper.clientHeight-10,hn.top+hk.top-hj.top));i.teLeft=Math.max(0,Math.min(hm.wrapper.clientWidth-10,hn.left+hk.left-hj.left))}return i};ae.prototype.showSelection=function(hj){var i=this.cm,hi=i.display;cc(hi.cursorDiv,hj.cursors);cc(hi.selectionDiv,hj.selection);if(hj.teTop!=null){this.wrapper.style.top=hj.teTop+"px";this.wrapper.style.left=hj.teLeft+"px"}};ae.prototype.reset=function(hl){if(this.contextMenuPending||this.composing){return}var hi,hk,i=this.cm,hn=i.doc;if(i.somethingSelected()){this.prevInput="";var hj=hn.sel.primary();hi=dE&&(hj.to().line-hj.from().line>100||(hk=i.getSelection()).length>1000);var hm=hi?"-":hk||i.getSelection();this.textarea.value=hm;if(i.state.focused){ee(this.textarea)}if(ed&&m>=9){this.hasSelection=hm}}else{if(!hl){this.prevInput=this.textarea.value="";if(ed&&m>=9){this.hasSelection=null}}}this.inaccurateSelection=hi};ae.prototype.getField=function(){return this.textarea};ae.prototype.supportsTouch=function(){return false};ae.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!eO||eh()!=this.textarea)){try{this.textarea.focus()}catch(i){}}};ae.prototype.blur=function(){this.textarea.blur()};ae.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0};ae.prototype.receivedFocus=function(){this.slowPoll()};ae.prototype.slowPoll=function(){var i=this;if(this.pollingFast){return}this.polling.set(this.cm.options.pollInterval,function(){i.poll();if(i.cm.state.focused){i.slowPoll()}})};ae.prototype.fastPoll=function(){var hi=false,i=this;i.pollingFast=true;function hj(){var hk=i.poll();if(!hk&&!hi){hi=true;i.polling.set(60,hj)}else{i.pollingFast=false;i.slowPoll()}}i.polling.set(20,hj)};ae.prototype.poll=function(){var ho=this;var i=this.cm,hj=this.textarea,hk=this.prevInput;if(this.contextMenuPending||!i.state.focused||(bJ(hj)&&!hk&&!this.composing)||i.isReadOnly()||i.options.disableInput||i.state.keySeq){return false}var hm=hj.value;if(hm==hk&&!i.somethingSelected()){return false}if(ed&&m>=9&&this.hasSelection===hm||cs&&/[\uf700-\uf7ff]/.test(hm)){i.display.input.reset();return false}if(i.doc.sel==i.display.selForContextMenu){var hl=hm.charCodeAt(0);if(hl==8203&&!hk){hk="\u200b"}if(hl==8666){this.reset();return this.cm.execCommand("undo")}}var hn=0,hi=Math.min(hk.length,hm.length);while(hn<hi&&hk.charCodeAt(hn)==hm.charCodeAt(hn)){++hn}dd(i,function(){gR(i,hm.slice(hn),hk.length-hn,null,ho.composing?"*compose":null);if(hm.length>1000||hm.indexOf("\n")>-1){hj.value=ho.prevInput=""}else{ho.prevInput=hm}if(ho.composing){ho.composing.range.clear();ho.composing.range=i.markText(ho.composing.start,i.getCursor("to"),{className:"CodeMirror-composing"})}});return true};ae.prototype.ensurePolled=function(){if(this.pollingFast&&this.poll()){this.pollingFast=false}};ae.prototype.onKeyPress=function(){if(ed&&m>=9){this.hasSelection=null}this.fastPoll()};ae.prototype.onContextMenu=function(hm){var hr=this,hs=hr.cm,ho=hs.display,hi=hr.textarea;var hq=cM(hs,hm),i=ho.scroller.scrollTop;if(!hq||ez){return}var hl=hs.options.resetSelectionOnContextMenu;if(hl&&hs.doc.sel.contains(hq)==-1){ds(hs,ce)(hs.doc,fz(hq),ah)}var hn=hi.style.cssText,hv=hr.wrapper.style.cssText;hr.wrapper.style.cssText="position: absolute";var hu=hr.wrapper.getBoundingClientRect();hi.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(hm.clientY-hu.top-5)+"px; left: "+(hm.clientX-hu.left-5)+"px;\n      z-index: 1000; background: "+(ed?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";var ht;if(dr){ht=window.scrollY}ho.input.focus();if(dr){window.scrollTo(null,ht)}ho.input.reset();if(!hs.somethingSelected()){hi.value=hr.prevInput=" "}hr.contextMenuPending=true;ho.selForContextMenu=hs.doc.sel;clearTimeout(ho.detectingSelectAll);function hk(){if(hi.selectionStart!=null){var hw=hs.somethingSelected();var hx="\u200b"+(hw?hi.value:"");hi.value="\u21da";hi.value=hx;hr.prevInput=hw?"":"\u200b";hi.selectionStart=1;hi.selectionEnd=hx.length;ho.selForContextMenu=hs.doc.sel}}function hp(){hr.contextMenuPending=false;hr.wrapper.style.cssText=hv;hi.style.cssText=hn;if(ed&&m<9){ho.scrollbars.setScrollTop(ho.scroller.scrollTop=i)}if(hi.selectionStart!=null){if(!ed||(ed&&m<9)){hk()}var hw=0,hx=function(){if(ho.selForContextMenu==hs.doc.sel&&hi.selectionStart==0&&hi.selectionEnd>0&&hr.prevInput=="\u200b"){ds(hs,au)(hs)}else{if(hw++<10){ho.detectingSelectAll=setTimeout(hx,500)}else{ho.selForContextMenu=null;ho.input.reset()}}};ho.detectingSelectAll=setTimeout(hx,200)}}if(ed&&m>=9){hk()}if(g7){e1(hm);var hj=function(){eN(window,"mouseup",hj);setTimeout(hp,20)};ch(window,"mouseup",hj)}else{setTimeout(hp,50)}};ae.prototype.readOnlyChanged=function(i){if(!i){this.reset()}this.textarea.disabled=i=="nocursor"};ae.prototype.setUneditable=function(){};ae.prototype.needsContentAttribute=false;function gu(ho,hp){hp=hp?aX(hp):{};hp.value=ho.value;if(!hp.tabindex&&ho.tabIndex){hp.tabindex=ho.tabIndex}if(!hp.placeholder&&ho.placeholder){hp.placeholder=ho.placeholder}if(hp.autofocus==null){var i=eh();hp.autofocus=i==ho||ho.getAttribute("autofocus")!=null&&i==document.body}function hl(){ho.value=hn.getValue()}var hm;if(ho.form){ch(ho.form,"submit",hl);if(!hp.leaveSubmitMethodAlone){var hi=ho.form;hm=hi.submit;try{var hk=hi.submit=function(){hl();hi.submit=hm;hi.submit();hi.submit=hk}}catch(hj){}}}hp.finishInit=function(hq){hq.save=hl;hq.getTextArea=function(){return ho};hq.toTextArea=function(){hq.toTextArea=isNaN;hl();ho.parentNode.removeChild(hq.getWrapperElement());ho.style.display="";if(ho.form){eN(ho.form,"submit",hl);if(typeof ho.form.submit=="function"){ho.form.submit=hm}}}};ho.style.display="none";var hn=K(function(hq){return ho.parentNode.insertBefore(hq,ho.nextSibling)},hp);return hn}function gz(i){i.off=eN;i.on=ch;i.wheelEventPixels=aH;i.Doc=aB;i.splitLines=gI;i.countColumn=cb;i.findColumn=e0;i.isWordChar=gq;i.Pass=cx;i.signal=aM;i.Line=g2;i.changeEnd=dn;i.scrollbarModel=by;i.Pos=ac;i.cmpPos=cC;i.modes=dX;i.mimeModes=a3;i.resolveMode=g9;i.getMode=gm;i.modeExtensions=dU;i.extendMode=fi;i.copyState=co;i.startState=cl;i.innerMode=g5;i.commands=fh;i.keyMap=fV;i.keyName=ga;i.isModifierKey=fe;i.lookupKey=k;i.normalizeKeyMap=c6;i.StringStream=fC;i.SharedTextMarker=y;i.TextMarker=V;i.LineWidget=d5;i.e_preventDefault=c5;i.e_stopPropagation=dV;i.e_stop=e1;i.addClass=gn;i.contains=g8;i.rmClass=h;i.keyNames=f0}fm(K);ei(K);var d="iter insert remove copy getEditor constructor".split(" ");for(var b3 in aB.prototype){if(aB.prototype.hasOwnProperty(b3)&&dN(d,b3)<0){K.prototype[b3]=(function(i){return function(){return i.apply(this.doc,arguments)}})(aB.prototype[b3])}}bR(aB);K.inputStyles={textarea:ae,contenteditable:dZ};K.defineMode=function(i){if(!K.defaults.mode&&i!="null"){K.defaults.mode=i}e5.apply(this,arguments)};K.defineMIME=bC;K.defineMode("null",function(){return({token:function(i){return i.skipToEnd()}})});K.defineMIME("text/plain","null");K.defineExtension=function(i,hi){K.prototype[i]=hi};K.defineDocExtension=function(i,hi){aB.prototype[i]=hi};K.fromTextArea=gu;gz(K);K.version="5.27.2";return K})));