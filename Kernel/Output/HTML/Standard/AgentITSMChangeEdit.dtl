# --
# AgentITSMChangeEdit.dtl - provides HTML form for AgentITSMChangeEdit
# Copyright (C) 2003-2009 OTRS AG, http://otrs.com/
# --
# $Id: AgentITSMChangeEdit.dtl,v 1.16 2009-10-29 17:34:54 reb Exp $
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file COPYING for license information (AGPL). If you
# did not receive this file, see http://www.gnu.org/licenses/agpl.txt.
# --

<script language="JavaScript" type="text/javascript">
<!--

function submit_compose() {
    if (document.compose.ChangeTitle.value == "") {
        alert('$JSText{"A change must have a title!"}');
        document.compose.ChangeTitle.focus();

        return false;
    }

    /* check the realize time */
    var StartYear   = document.compose.RealizeTimeYear.value;
    var StartMonth  = document.compose.RealizeTimeMonth.value;
    var StartDay    = document.compose.RealizeTimeDay.value;
    var StartHour   = document.compose.RealizeTimeHour.value;
    var StartMinute = document.compose.RealizeTimeMinute.value;
    if (
        0
        || isNaN(StartYear)
        || isNaN(StartMonth)
        || isNaN(StartDay)
        || isNaN(StartHour)
        || isNaN(StartMinute)
        || ( StartYear   < 999 || StartYear   > 10000 )
        || ( StartMonth  < 1   || StartMonth  > 12 )
        || ( StartDay    < 1   || StartDay    > 31 )
        || ( StartHour   < 0   || StartHour   > 23 )
        || ( StartMinute < 0   || StartMinute > 59 )
        )
    {
        alert('$JSText{"The realize time is invalid!"}');

        return false;
    }

    return true;
}
//-->
</script>

<table border="0" width="100%" cellspacing="0" cellpadding="3">
    <tr>
        <td class="mainhead">
            <div title="$Env{"Box0"}$Text{"Edit"} $Text{"Change#"}: $Data{"ChangeNumber"} $Env{"Box1"}">
                $Env{"Box0"}$Text{"Edit"} $Text{"Change#"}: $Data{"ChangeNumber"} $Env{"Box1"}
            </div>
        </td>
    </tr>
    <tr>
        <td class="menu">
            <a href="$Env{"Baselink"}$Env{"LastScreenView"}" onmouseover="window.status='$JSText{"Back"}'; return true;" onmouseout="window.status='';" class="menuitem">$Text{"Back"}</a>
        </td>
    </tr>

    <tr>
        <td class="mainbody">
            <br>
            <form action="$Env{"CGIHandle"}" method="post" enctype="multipart/form-data" name="compose">
                <input type="hidden" name="Action"    value="$Env{"Action"}">
                <input type="hidden" name="Subaction" value="Save">
                <input type="hidden" name="ChangeID"  value="$QData{"ChangeID"}">
                <table border="0" width="800" align="center" cellspacing="0" cellpadding="4">
                    <tr>
                        <td class="contenthead">$Text{"Change"}</td>
                    </tr>
                    <tr class="contentbody">
                        <td>
                            <table border="0">
                                <tr>
                                    <td class="contentkey">
                                        $Text{"Title"}:
                                        <font color="red" title="$Text{"Required"}">*</font>
                                    </td>
                                    <td class="contentvalue">
                                        <input type="text" name="ChangeTitle" value="$QData{"ChangeTitle"}" size="70" maxsize="250">
<!-- dtl:block:InvalidTitle -->
                                        <br />
                                        <font color="red" size="-2">$Text{"Input invalid"}</font>
<!-- dtl:block:InvalidTitle -->
                                    </td>
                                </tr>
                                <tr>
                                    <td class="contentkey">
                                        $Text{"Description"}:
                                    </td>
                                    <td class="contentvalue">
                                        <div>
<!-- dtl:block:RichText -->
$Include{"RichTextEditorITSM"}
<!-- dtl:block:RichText -->
<!-- TODO: set own ITSM config -->
<!-- ITSM::Frontend::TextArea -->
                                            <textarea id="RichText1" name="Description" rows="15" cols="$Config{"ITSM::Frontend::TextArea"}" wrap="$Env{"BrowserWrap"}">$Data{"Description"}</textarea>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="contentkey">
                                        $Text{"Justification"}:
                                    </td>
                                    <td class="contentvalue">
                                        <div>
                                            <textarea id="RichText2" name="Justification" rows="15" cols="$Config{"ITSM::Frontend::TextArea"}" wrap="$Env{"BrowserWrap"}">$Data{"Justification"}</textarea>
                                        </div>
                                    </td>
                                </tr>
<!-- dtl:block:RealizeTime -->
                                <tr>
                                    <td class="contentkey">
                                        $Text{"Realize time"}:
                                    </td>
                                    <td class="contentvalue">
                                        $Data{"RealizeTimeString"}
<!-- dtl:block:InvalidRealizeTime -->
                                        <br />
                                        <font color="red" size="-2">$Text{"Input invalid"}</font>
<!-- dtl:block:InvalidRealizeTime -->
                                    </td>
                                </tr>
<!-- dtl:block:RealizeTime -->
                                <tr>
                                    <td class="contentkey">
                                        $Text{"Attachment"}:
                                    </td>
                                    <td class="contentvalue">
                                        <table width="100%">
<!-- dtl:block:AttachmentRow -->
                                            <tr>
                                                <td>$Data{"AttachmentName"}</td>
                                                <td>$Data{"AttachmentSize"}</td>
<!-- TODO: set correct name for Delete button with unique name -->
                                                <td><input class="button" type="submit" name="DeleteAttachmentxxx" value="$Text{"Delete"}"></td>
                                            </tr>
<!-- dtl:block:AttachmentRow -->
                                            <tr>
                                                <td colspan="2"><input type="file" name="AttachmentNew"></td>
                                                <td width="100%"><input type="submit" class="button" name="SaveAttachment" value="$Text{"Attach"}"></td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="contentfooter">
                            <input class="button" id="submitEditChange" accesskey="g" type="submit" name="EditChange" value="$Text{"Save"}" onclick="return submit_compose();"/>
                        </td>
                    </tr>
                </table>
            </form>
            <br>
        </td>
    </tr>
</table>
