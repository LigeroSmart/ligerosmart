# --
# AgentITSMWorkOrderReport.dtl - provides HTML form for AgentITSMWorkOrderReport
# Copyright (C) 2003-2010 OTRS AG, http://otrs.com/
# --
# $Id: AgentITSMWorkOrderReport.dtl,v 1.31 2010-04-27 20:45:04 ub Exp $
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file COPYING for license information (AGPL). If you
# did not receive this file, see http://www.gnu.org/licenses/agpl.txt.
# --

<script type="text/javascript" src="$Config{"Frontend::JavaScriptPath"}itsm-changemanagement.js"></script>
<script language="JavaScript" type="text/javascript">
<!--

function submit_compose() {

<!-- dtl:block:ActualTimeSpanJS -->

    // check the actual start time
    if ( document.compose.ActualStartTimeUsed.checked && !CheckTime( 'ActualStartTime' ) ) {
        alert('$JSText{"The actual start time is invalid!"}');

        return false;
    }

    // check the actual end time
    if ( document.compose.ActualEndTimeUsed.checked && !CheckTime( 'ActualEndTime' ) ) {
        alert('$JSText{"The actual end time is invalid!"}');

        return false;
    }

    if ( document.compose.ActualEndTimeUsed.checked && !document.compose.ActualStartTimeUsed.checked ) {
        alert('$JSText{"The actual start time must be set, when the actual end time is set!"}');

        return false;
    }

    // check whether the planned start time is before the planned end time
    if ( document.compose.ActualEndTimeUsed.checked && document.compose.ActualEndTimeUsed.checked ) {
        var StartAfterEndMsg = '$JSText{"The actual start time must be before the actual end time!"}';
        if ( !CheckStartBeforeEnd( 'ActualStartTime', 'ActualEndTime', StartAfterEndMsg ) ) {
            return false;
        }
    }

<!-- dtl:block:ActualTimeSpanJS -->

    return true;
}
//-->
</script>

<table border="0" width="100%" cellspacing="0" cellpadding="3">
    <tr>
        <td class="mainhead">
            <div title="$Env{"Box0"} $Text{"Edit"} $Text{"Report"} $Text{"of"} $Config{"ITSMWorkOrder::Hook"}: $QData{"ChangeNumber"}-$QData{"WorkOrderNumber"} $Env{"Box1"} $QData{"WorkOrderTitle"}">
                $Env{"Box0"} $Text{"Edit"} $Text{"Report"} $Text{"of"} $Config{"ITSMWorkOrder::Hook"}: $QData{"ChangeNumber"}-$QData{"WorkOrderNumber"} $Env{"Box1"} $QData{"WorkOrderTitle","70"}
            </div>
        </td>
    </tr>
    <tr>
        <td class="menu">
            <a href="$Env{"Baselink"}$Env{"LastWorkOrderView"}" onmouseover="window.status='$JSText{"Back"}'; return true;" onmouseout="window.status='';" class="menuitem">$Text{"Back"}</a>
        </td>
    </tr>

    <tr>
        <td class="mainbody">
            <br>
            <form action="$Env{"CGIHandle"}" method="post" name="compose">
                <input type="hidden" name="Action"    value="$Env{"Action"}">
                <input type="hidden" name="Subaction" value="Save">
                <input type="hidden" name="WorkOrderID" value="$QData{"WorkOrderID"}">
                <table border="0" width="800" align="center" cellspacing="0" cellpadding="4">
                    <tr>
                        <td class="contenthead">$Text{"Report"}</td>
                    </tr>
                    <tr class="contentbody">
                        <td>
                            <table border="0" width="100%" cellspacing="0" cellpadding="3">
                                <colgroup>
                                    <col width="130">
                                    <col>
                                </colgroup>
                                <tr>
                                    <td class="contentkey">$Text{"Report"}:</td>

                                    <td class="contentvalue">
                                        <div>
<!-- dtl:block:RichText -->
$Include{"RichTextEditorITSM"}
<!-- dtl:block:RichText -->
                                            <textarea id="RichText1" name="Report" rows="15" cols="$Config{"ITSM::Frontend::TextArea"}" wrap="$Env{"BrowserWrap"}">$Data{"Report"}</textarea>
                                        </div>
                                    </td>
                                </tr>
<!-- dtl:block:State -->
                                <tr>
                                    <td width="25%" class="contentkey">$Text{"State"}:</td>
                                    <td width="75%" class="contentvalue">$Data{"StateSelect"}</td>
                                </tr>
<!-- dtl:block:State -->
<!-- dtl:block:ActualStartTime -->
                                <tr>
                                    <td class="contentkey">
                                        $Text{"ActualStartTime"}:
                                    </td>
                                    <td class="contentvalue">
                                        $Data{"ActualStartTimeSelectionString"}
<!-- dtl:block:InvalidActualStartTime -->
                                        <br />
                                        <font color="red" size="-2">$Text{"Input invalid"}</font>
<!-- dtl:block:InvalidActualStartTime -->
                                    </td>
                                </tr>
<!-- dtl:block:ActualStartTime -->
<!-- dtl:block:ActualEndTime -->
                                <tr>
                                    <td class="contentkey">
                                        $Text{"ActualEndTime"}:
                                    </td>
                                    <td class="contentvalue">
                                        $Data{"ActualEndTimeSelectionString"}
<!-- dtl:block:InvalidActualEndTime -->
                                        <br />
                                        <font color="red" size="-2">$Text{"Input invalid"}</font>
<!-- dtl:block:InvalidActualEndTime -->
                                    </td>
                                </tr>
<!-- dtl:block:ActualEndTime -->
<!-- dtl:block:ShowAccountedTime -->
                                <tr>
                                    <td class="contentkey">$Text{"AccountedTime"}:</td>

                                    <td class="contentvalue">
                                        <div>
                                            <input type="text" name="AccountedTime" value="$QData{"AccountedTime"}" size="11" maxlength="11">
<!-- dtl:block:InvalidAccountedTime -->
                                            <br />
                                            <font color="red" size="-2">$Text{"Input invalid"}</font>
<!-- dtl:block:InvalidAccountedTime -->
                                        </div>
                                    </td>
                                </tr>
<!-- dtl:block:ShowAccountedTime -->
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="contentfooter">
                            <input class="button" id="submitWorkOrderReport" accesskey="g" type="submit" name="WorkOrderReport" value="$Text{"Save"}" onclick="return submit_compose();">
                        </td>
                    </tr>
                </table>
            </form>
            <br>
        </td>
    </tr>
</table>
